
<!doctype html>
<html lang="ca" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://cipfpbatoi.github.io/dwes2526/07webs_hibrides.html">
      
      
        <link rel="prev" href="06Nodejs.html">
      
      
      
        
      
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>7.- Webs hibrides - Desenvolupament web en entorn de Servidor</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-X6D0LR7TC8"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-X6D0LR7TC8",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-X6D0LR7TC8",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#webs-hibrides" class="md-skip">
          Salta el contingut
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Capçalera">
    <a href="index.html" title="Desenvolupament web en entorn de Servidor" class="md-header__button md-logo" aria-label="Desenvolupament web en entorn de Servidor" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Desenvolupament web en entorn de Servidor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              7.- Webs hibrides
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Canviar a mode nit"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Canviar a mode nit" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Canviar a mode dia"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Canviar a mode dia" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Cerca">
        
        <button type="reset" class="md-search__icon md-icon" title="Neteja" aria-label="Neteja" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicialitzant cerca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegació" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Desenvolupament web en entorn de Servidor" class="md-nav__button md-logo" aria-label="Desenvolupament web en entorn de Servidor" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    Desenvolupament web en entorn de Servidor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inicio
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="01arquitecturas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.- Arquitectures Web
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="02php.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.- Programació web amb PHP
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="03MVC_Laravel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3.- Arquitectura MVC amb Laravel
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="04dades_Laravel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4.- Accés segur i estructurat a bases de dades amb Laravel
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="05seguretat_Laravel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5.- Aplicacions segures i reactives en Laravel
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="06Rest_Laravel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6a.- Desenvolupament d'APIs REST amb Laravel
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="06Nodejs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6b.- Desenvolupament d'APIs REST amb Node.js
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    7.- Webs hibrides
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="07webs_hibrides.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    7.- Webs hibrides
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Taula de continguts">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Taula de continguts
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#caracteristiques-de-les-webs-hibrides" class="md-nav__link">
    <span class="md-ellipsis">
      
        Característiques de les webs híbrides
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilitzacio-de-repositoris-dinformacio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Utilització de repositoris d'informació
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autenticacio-amb-google" class="md-nav__link">
    <span class="md-ellipsis">
      
        Autenticació amb Google
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Autenticació amb Google">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuracio-de-lautenticacio-amb-google-en-laravel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuració de l'Autenticació amb Google en Laravel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#difusio-desdeveniments-en-temps-real-amb-websockets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Difusió d'Esdeveniments en Temps Real amb WebSockets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Difusió d&#39;Esdeveniments en Temps Real amb WebSockets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#funcionament" class="md-nav__link">
    <span class="md-ellipsis">
      
        Funcionament
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drivers-de-difusio-suportats" class="md-nav__link">
    <span class="md-ellipsis">
      
        Drivers de Difusió Suportats
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guia-rapida-que-fa-cada-peca" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guia ràpida (què fa cada peça)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementacio-basica-en-el-servidor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementació Bàsica en el servidor
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<style>
    img { margin: 20px 0; border-radius: 8px; }

    .alert { color: #BD1550; }
    .warning { color: #E97F02; }
    .success { color: #8A9B0F; }

    .center { text-align: center; }
    .right { text-align: right; }

    .img-small { max-width: 200px; margin: auto; }
    .img-medium { max-width: 400px; margin: auto; }
    .img-large { max-width: 800px; margin: auto; }

    .leyenda {
        font-size: small;
        margin: 10px 0;
    }
</style>

<h1 id="webs-hibrides">Webs híbrides<a class="headerlink" href="#webs-hibrides" title="Permanent link">&para;</a></h1>
<blockquote>
<p>Duració estimada: 8 sessions</p>
</blockquote>
<h2 id="caracteristiques-de-les-webs-hibrides">Característiques de les webs híbrides<a class="headerlink" href="#caracteristiques-de-les-webs-hibrides" title="Permanent link">&para;</a></h2>
<p>Les aplicacions web híbrides, també conegudes com a "mashups", són una combinació de dades i/o funcionalitats provinents de diverses fonts per a crear un nou tipus d'aplicació o servei.
Les seues característiques principals són:</p>
<ul>
<li><strong>Integració de Dades de Diversos Orígens</strong>: Les aplicacions web híbrides aprofiten dades i funcionalitats de múltiples fonts, com ara serveis web, APIs, i altres recursos en línia. Això permet combinar i reutilitzar recursos existents de manera creativa per a desenvolupar aplicacions més complexes i funcionals.</li>
<li><strong>Ús de Serveis Web i APIs</strong>: Moltes d'aquestes aplicacions utilitzen dades accessibles a través de serveis web. En este tema prioritzarem APIs gratuïtes o d'accés obert (open data), amb respostes en JSON o XML, per a poder integrar-les sense costos per a l'alumnat.</li>
<li><strong>Sindicació Web (RSS/Atom)</strong>: Algunes aplicacions web híbrides fan ús de protocols de sindicació web, com RSS o Atom, per accedir a continguts actualitzats de manera regular. Aquests protocols simplifiquen el procés de compartir i distribuir continguts web.</li>
<li><strong>Dades Internes</strong>: A més de les fonts externes, les aplicacions web híbrides poden incloure dades internes generades i gestionades per l'entitat propietària de l'aplicació, com podrien ser les dades corporatives o de negoci.</li>
<li><strong>Web Scraping</strong>: Encara que és menys comú, algunes aplicacions utilitzen tècniques d'enginyeria inversa, com el web scraping, per extreure dades des de llocs web. Això pot ser útil per obtenir informació com els preus dels productes en les botigues en línia.</li>
</ul>
<p>Aquesta actualització reflecteix l'evolució constant en el camp del desenvolupament web i la integració de tecnologies, destacant la importància de les fonts diverses de dades i la capacitat de combinar-les de forma innovadora en el disseny d'aplicacions web híbrides​​.</p>
<h2 id="utilitzacio-de-repositoris-dinformacio">Utilització de repositoris d'informació<a class="headerlink" href="#utilitzacio-de-repositoris-dinformacio" title="Permanent link">&para;</a></h2>
<p>Per a poder reutilitzar codi i informació cal que tingem en conte les següents consideracions:</p>
<ul>
<li><strong>Integració de Serveis Web de Tercers</strong>: En el desenvolupament d'aplicacions web híbrides, és comú utilitzar serveis proporcionats per tercers. Aquests serveis poden oferir funcionalitats específiques que enriquiran l'aplicació sense necessitat de desenvolupar-les des de zero. Un exemple podria ser l'ús d'OpenStreetMap per mostrar la ubicació geogràfica de les franquícies d'una empresa en un mapa.</li>
<li><strong>Desenvolupament d'Aplicacions Pràctiques</strong>: En aquest context, es posa l'accent en el desenvolupament d'aplicacions que faciliten processos específics, com podria ser la gestió d'enviaments en una botiga en línia. Aquest tipus d'aplicació pot millorar significativament l'experiència dels usuaris i l'eficiència de les operacions de l'empresa.</li>
<li><strong>Reconeixement de Necessitats i Oportunitats</strong>: És important identificar funcionalitats que poden ser útils per als usuaris, fins i tot quan aquests no les han sol·licitat explícitament. Aquesta anticipació de necessitats pot ser un factor clau en el desenvolupament d'aplicacions web híbrides exitoses.</li>
<li><strong>Condicions i Límits en l'Ús de Serveis de Tercers</strong>: Quan s'utilitzen serveis de tercers, cal tenir en compte les condicions i límits que aquests imposen. Això inclou restriccions d'ús, límits de sol·licituds, entre d'altres aspectes legals i tècnics.</li>
<li><strong>Adquisició d'Experiència en Desenvolupament Web</strong>: El desenvolupament d'aquestes aplicacions també serveix com una oportunitat per adquirir experiència pràctica en l'àmbit del desenvolupament web, millorant així les habilitats tècniques dels desenvolupadors.</li>
</ul>
<p>Per exemple podriem desenvolupar:</p>
<ul>
<li><strong>Mapa amb OpenStreetMap</strong>: Imaginem que estàs desenvolupant una aplicació web per a una cadena de restaurants. Pots mostrar la ubicació de tots els restaurants en un mapa interactiu amb OpenStreetMap i Leaflet (sense necessitat de clau de pagament). Els usuaris poden buscar el restaurant més proper i veure informació bàsica.</li>
<li><strong>Gestió d'Enviaments amb APIs de Logística</strong>: Per una botiga en línia, pots integrar APIs de serveis de missatgeria com UPS, FedEx o DHL. Això permet als usuaris fer seguiment dels seus enviaments en temps real, calcular costos d'enviament, i gestionar devolucions de manera eficient.</li>
<li><strong>Integració de Passarel·les de Pagament</strong>: En una aplicació d'e-commerce, l'ús de passarel·les de pagament com Stripe, PayPal, o Square és essencial. Això no només ofereix una solució de pagament segura als usuaris, sinó que també simplifica la gestió financera de la botiga.</li>
<li><strong>Ús de APIs de Xarxes Socials</strong>: Podries integrar APIs de xarxes socials com Facebook, Twitter, o Instagram per permetre als usuaris compartir productes o experiències directament des de la teva aplicació. Això pot augmentar la visibilitat i l'engagement del teu negoci.</li>
<li><strong>Serveis Meteorològics Integrats</strong>: Per a una aplicació d'activitats a l'aire lliure, com una app de senderisme, integrar dades meteorològiques en temps real amb APIs gratuïtes com Open-Meteo pot ser molt útil. Els usuaris podrien planificar les seves activitats basant-se en les condicions meteorològiques actuals i les previsions.</li>
<li><strong>Recollida d'Opinions amb Dades Obertes</strong>: En una aplicació per a hotels o restaurants, pots partir de dades obertes (open data municipal o autonòmic) o construir el teu propi sistema de ressenyes dins l'aplicació.</li>
</ul>
<p>En este tema evitarem APIs de pagament. Els exemples de passarel·les de pagament o logística són referències conceptuals, però les pràctiques es faran amb dades obertes i serveis gratuïts.</p>
<h2 id="autenticacio-amb-google">Autenticació amb Google<a class="headerlink" href="#autenticacio-amb-google" title="Permanent link">&para;</a></h2>
<h3 id="configuracio-de-lautenticacio-amb-google-en-laravel">Configuració de l'Autenticació amb Google en Laravel<a class="headerlink" href="#configuracio-de-lautenticacio-amb-google-en-laravel" title="Permanent link">&para;</a></h3>
<h4 id="1-installar-laravel-socialite"><strong>1. Instal·lar Laravel Socialite</strong><a class="headerlink" href="#1-installar-laravel-socialite" title="Permanent link">&para;</a></h4>
<p>Laravel <strong>Socialite</strong> és la biblioteca oficial per gestionar l'autenticació amb proveïdors socials.</p>
<h4 id="11-installa-socialite"><strong>1.1. Instal·la Socialite</strong><a class="headerlink" href="#11-installa-socialite" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer<span class="w"> </span>require<span class="w"> </span>laravel/socialite
<span class="linenos" data-linenos="2 "></span>php<span class="w"> </span>artisan<span class="w"> </span>vendor:publish<span class="w"> </span>--provider<span class="o">=</span><span class="s2">&quot;Laravel\Socialite\SocialiteServiceProvider&quot;</span>
</code></pre></div>
<h4 id="2-configura-google-api"><strong>2. Configura Google API</strong><a class="headerlink" href="#2-configura-google-api" title="Permanent link">&para;</a></h4>
<ol>
<li>Accedeix a la <a href="https://console.developers.google.com/">Consola de Desenvolupadors de Google</a>.</li>
<li>Crea un nou projecte o selecciona un projecte existent.</li>
<li>Activa "Google Identity Services" (o l'API de People si cal).</li>
<li>
<p>Crea una credencial d'OAuth 2.0 i configura:</p>
<ul>
<li><strong>Tipus d'aplicació</strong>: Aplicació web.</li>
<li><strong>URI de redirecció autoritzat</strong>:
  <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>http://localhost/auth/google/callback
</code></pre></div></li>
</ul>
</li>
<li>
<p>Copia el <strong>Client ID</strong> i el <strong>Client Secret</strong>.</p>
</li>
</ol>
<h4 id="3-configura-les-variables-dentorn"><strong>3. Configura les Variables d'Entorn</strong><a class="headerlink" href="#3-configura-les-variables-dentorn" title="Permanent link">&para;</a></h4>
<p>Afegeix les credencials al fitxer <code>.env</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>GOOGLE_CLIENT_ID=your-client-id
<span class="linenos" data-linenos="2 "></span>GOOGLE_CLIENT_SECRET=your-client-secret
<span class="linenos" data-linenos="3 "></span>GOOGLE_REDIRECT=http://localhost/auth/google/callback
</code></pre></div>
<p>Afegeix la configuració de Google al fitxer <code>config/services.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&#39;google&#39; =&gt; [</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    &#39;client_id&#39; =&gt; env(&#39;GOOGLE_CLIENT_ID&#39;),</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &#39;client_secret&#39; =&gt; env(&#39;GOOGLE_CLIENT_SECRET&#39;),</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    &#39;redirect&#39; =&gt; env(&#39;GOOGLE_REDIRECT&#39;),</span>
<span class="linenos" data-linenos="5 "></span><span class="x">],</span>
</code></pre></div>
<h4 id="4-configura-les-rutes"><strong>4. Configura les Rutes</strong><a class="headerlink" href="#4-configura-les-rutes" title="Permanent link">&para;</a></h4>
<p>Defineix les rutes necessàries al fitxer <code>routes/web.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">use App\Http\Controllers\AuthController;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="x">Route::get(&#39;/auth/google/redirect&#39;, [AuthController::class, &#39;redirectToGoogle&#39;])-&gt;name(&#39;google.redirect&#39;);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">Route::get(&#39;/auth/google/callback&#39;, [AuthController::class, &#39;handleGoogleCallback&#39;])-&gt;name(&#39;google.callback&#39;);</span>
</code></pre></div>
<h4 id="5-crea-el-controlador"><strong>5. Crea el Controlador</strong><a class="headerlink" href="#5-crea-el-controlador" title="Permanent link">&para;</a></h4>
<p>Crea un controlador per gestionar l'autenticació amb Google amb els seguents mètodes:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Http\Controllers;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Laravel\Socialite\Facades\Socialite;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Illuminate\Support\Facades\Auth;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">use App\Models\User;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">class AuthController extends Controller</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    public function redirectToGoogle()</span>
<span class="linenos" data-linenos="10 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="11 "></span><span class="x">        return Socialite::driver(&#39;google&#39;)-&gt;redirect();</span>
<span class="linenos" data-linenos="12 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="x">    public function handleGoogleCallback()</span>
<span class="linenos" data-linenos="15 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="16 "></span><span class="x">        $googleUser = Socialite::driver(&#39;google&#39;)-&gt;stateless()-&gt;user();</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="x">        // Cerca l&#39;usuari o crea&#39;l si no existeix</span>
<span class="linenos" data-linenos="19 "></span><span class="x">        $user = User::firstOrCreate(</span>
<span class="linenos" data-linenos="20 "></span><span class="x">            [&#39;email&#39; =&gt; $googleUser-&gt;getEmail()],</span>
<span class="linenos" data-linenos="21 "></span><span class="x">            [</span>
<span class="linenos" data-linenos="22 "></span><span class="x">                &#39;name&#39; =&gt; $googleUser-&gt;getName(),</span>
<span class="linenos" data-linenos="23 "></span><span class="x">                &#39;google_id&#39; =&gt; $googleUser-&gt;getId(),</span>
<span class="linenos" data-linenos="24 "></span><span class="x">                &#39;avatar&#39; =&gt; $googleUser-&gt;getAvatar(),</span>
<span class="linenos" data-linenos="25 "></span><span class="x">                &#39;password&#39; =&gt; bcrypt(str()-&gt;random(24)), // Contrassenya aleatòria</span>
<span class="linenos" data-linenos="26 "></span><span class="x">            ]</span>
<span class="linenos" data-linenos="27 "></span><span class="x">        );</span>
<span class="linenos" data-linenos="28 "></span>
<span class="linenos" data-linenos="29 "></span><span class="x">        // Inicia sessió amb l&#39;usuari</span>
<span class="linenos" data-linenos="30 "></span><span class="x">        Auth::login($user);</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="x">        return redirect(&#39;/home&#39;); // Redirigeix a la pàgina principal</span>
<span class="linenos" data-linenos="33 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="34 "></span><span class="x">}</span>
</code></pre></div>
<h4 id="6-modifica-el-model-user-i-la-migracio"><strong>6. Modifica el Model <code>User</code> i la migració</strong><a class="headerlink" href="#6-modifica-el-model-user-i-la-migracio" title="Permanent link">&para;</a></h4>
<p>Afig els camps <code>google_id</code> i <code>avatar</code> al model i a la taula <code>users</code>.</p>
<p>Comanda per crear la migració:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>./vendor/bin/sail<span class="w"> </span>artisan<span class="w"> </span>make:migration<span class="w"> </span>add_google_fields_to_users_table<span class="w"> </span>--table<span class="o">=</span>users
</code></pre></div>
<p>Exemple de migració:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">use Illuminate\Database\Migrations\Migration;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">use Illuminate\Database\Schema\Blueprint;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Illuminate\Support\Facades\Schema;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">return new class extends Migration</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    public function up(): void</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    {</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        Schema::table(&#39;users&#39;, function (Blueprint $table) {</span>
<span class="linenos" data-linenos="10 "></span><span class="x">            $table-&gt;string(&#39;google_id&#39;)-&gt;nullable()-&gt;unique()-&gt;after(&#39;email&#39;);</span>
<span class="linenos" data-linenos="11 "></span><span class="x">            $table-&gt;string(&#39;avatar&#39;)-&gt;nullable()-&gt;after(&#39;google_id&#39;);</span>
<span class="linenos" data-linenos="12 "></span><span class="x">        });</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">    public function down(): void</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="17 "></span><span class="x">        Schema::table(&#39;users&#39;, function (Blueprint $table) {</span>
<span class="linenos" data-linenos="18 "></span><span class="x">            $table-&gt;dropUnique([&#39;google_id&#39;]);</span>
<span class="linenos" data-linenos="19 "></span><span class="x">            $table-&gt;dropColumn([&#39;google_id&#39;, &#39;avatar&#39;]);</span>
<span class="linenos" data-linenos="20 "></span><span class="x">        });</span>
<span class="linenos" data-linenos="21 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="22 "></span><span class="x">};</span>
</code></pre></div>
<p>Executa migracions:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>./vendor/bin/sail<span class="w"> </span>artisan<span class="w"> </span>migrate
</code></pre></div>
<h4 id="7-vistes-minimes-opcional"><strong>7. Vistes mínimes (opcional)</strong><a class="headerlink" href="#7-vistes-minimes-opcional" title="Permanent link">&para;</a></h4>
<p>Si vols mostrar un resultat explícit d'autenticació, crea:
- <code>resources/views/auth/success.blade.php</code>
- <code>resources/views/auth/error.blade.php</code></p>
<p>Exemple ràpid:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">{{-- resources/views/auth/success.blade.php --}}</span>
<span class="linenos" data-linenos="2 "></span><span class="x">&lt;h1&gt;Login correcte&lt;/h1&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">{{-- resources/views/auth/error.blade.php --}}</span>
<span class="linenos" data-linenos="2 "></span><span class="x">&lt;h1&gt;Error d&#39;autenticació&lt;/h1&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="x">&lt;p&gt;{{ $error ?? &#39;No s\\&#39;ha pogut iniciar sessió amb Google.&#39; }}&lt;/p&gt;</span>
</code></pre></div>
<p>I en la vista de login, enllaç al redirect:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ route(&#39;google.redirect&#39;) }}&quot;</span><span class="p">&gt;</span>Inicia sessió amb Google<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<blockquote>
<p>Amb el controlador de l'exemple (<code>return redirect('/home')</code>) aquestes vistes no són necessàries.
Només usa <code>success/error</code> si canvies el callback per a retornar vistes en lloc de redirigir.</p>
</blockquote>
<h4 id="8-prova-lautenticacio"><strong>8. Prova l'Autenticació</strong><a class="headerlink" href="#8-prova-lautenticacio" title="Permanent link">&para;</a></h4>
<ul>
<li>Accedeix a l'URL: <code>http://localhost/auth/google/redirect</code></li>
<li>Segueix el procés d'autenticació amb Google.</li>
</ul>
<h2 id="difusio-desdeveniments-en-temps-real-amb-websockets">Difusió d'Esdeveniments en Temps Real amb WebSockets<a class="headerlink" href="#difusio-desdeveniments-en-temps-real-amb-websockets" title="Permanent link">&para;</a></h2>
<p>Els <strong>WebSockets</strong> permeten implementar interfícies d'usuari que s'actualitzen en temps real de manera eficient. A diferència del <em>polling</em> constant, els WebSockets envien dades del servidor al client només quan hi ha canvis, millorant el rendiment i l'experiència d'usuari.</p>
<h3 id="funcionament">Funcionament<a class="headerlink" href="#funcionament" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Canals</strong>: Els clients es connecten a canals amb noms específics al frontend.</li>
<li><strong>Esdeveniments</strong>: L'aplicació Laravel envia esdeveniments a aquests canals des del backend. Els esdeveniments poden incloure dades que el frontend utilitza per actualitzar la interfície.</li>
</ul>
<h3 id="drivers-de-difusio-suportats">Drivers de Difusió Suportats<a class="headerlink" href="#drivers-de-difusio-suportats" title="Permanent link">&para;</a></h3>
<p>Laravel proporciona diverses opcions per gestionar WebSockets. En este tema prioritzarem opcions gratuïtes i autogestionades:</p>
<ol>
<li><strong>Laravel Reverb</strong>: Solució autogestionada i integrada amb Laravel (recomanada per a no dependre de serveis de pagament).</li>
<li><strong>Pusher Channels</strong>: Servei gestionat per a WebSockets (no gratuït en la majoria de casos).</li>
<li><strong>Ably</strong>: Plataforma avançada per a comunicacions en temps real (amb límits gratuïts, però de pagament en producció).</li>
</ol>
<h3 id="guia-rapida-que-fa-cada-peca">Guia ràpida (què fa cada peça)<a class="headerlink" href="#guia-rapida-que-fa-cada-peca" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Event Laravel</strong>: representa un fet del servidor (p. ex. s'ha actualitzat un resultat).</li>
<li><strong>Queue (<code>queue:work</code>)</strong>: processa feines en segon pla. Amb <code>ShouldBroadcast</code>, l'enviament del broadcast passa per la cua.</li>
<li><strong>Reverb / Pusher / Ably</strong>: servei WebSocket que fa el <em>push</em> en temps real als navegadors.</li>
<li><strong>Scheduler</strong>: serveix per executar tasques periòdiques (cada minut, cada hora...). No és necessari per a este exemple.</li>
</ul>
<p>En este tema:
1. El controlador guarda el resultat i llança <code>PartitActualitzat</code>.
2. La cua processa el broadcast (si uses <code>ShouldBroadcast</code>).
3. Reverb (o Pusher/Ably) envia l'event als clients connectats.
4. Livewire l'escolta i refresca la classificació.</p>
<blockquote>
<p>Si el navegador és remot i vols temps real, sí que necessites Reverb/Pusher/Ably.<br />
Si no uses WebSockets, l'alternativa és polling o recàrrega manual.</p>
</blockquote>
<h3 id="implementacio-basica-en-el-servidor">Implementació Bàsica en el servidor<a class="headerlink" href="#implementacio-basica-en-el-servidor" title="Permanent link">&para;</a></h3>
<p>Laravel facilita la difusió d'esdeveniments (<em>event broadcasting</em>) gràcies a un driver de difusió que envia els esdeveniments al client mitjançant Laravel Echo (una biblioteca JavaScript).</p>
<h4 id="configuracio">Configuració<a class="headerlink" href="#configuracio" title="Permanent link">&para;</a></h4>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="w">  </span>./vendor/bin/sail<span class="w"> </span>artisan<span class="w"> </span>install:broadcasting
</code></pre></div>
Em preguntarà si vull instal·lar Reverb (sí) i la part de client (sí). Aquesta ordre ja instal·la Reverb i Laravel Echo, així que no cal repetir la instal·lació després.         </p>
<p>Aquesta ordre:</p>
<ul>
<li>Crearà el fitxer <code>config/broadcasting.php</code>.</li>
<li>Crearà el fitxer <code>routes/channels.php</code>, on pots registrar rutes d'autorització i callbacks per als canals de difusió.</li>
</ul>
<h4 id="configuracio-basica-amb-laravel-reverb-gratuit-i-autogestionat">Configuració Bàsica amb Laravel Reverb (gratuït i autogestionat)<a class="headerlink" href="#configuracio-basica-amb-laravel-reverb-gratuit-i-autogestionat" title="Permanent link">&para;</a></h4>
<p>Reverb permet fer WebSockets sense dependre de serveis externs:</p>
<ol>
<li>Configura les variables al <code>.env</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>BROADCAST_CONNECTION=reverb
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>REVERB_APP_ID=your-app-id
<span class="linenos" data-linenos=" 4 "></span>REVERB_APP_KEY=your-app-key
<span class="linenos" data-linenos=" 5 "></span>REVERB_APP_SECRET=your-app-secret
<span class="linenos" data-linenos=" 6 "></span>REVERB_HOST=localhost
<span class="linenos" data-linenos=" 7 "></span>REVERB_PORT=8081
<span class="linenos" data-linenos=" 8 "></span>REVERB_SCHEME=http
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>VITE_REVERB_APP_KEY=your-app-key
<span class="linenos" data-linenos="11 "></span>VITE_REVERB_HOST=localhost
<span class="linenos" data-linenos="12 "></span>VITE_REVERB_PORT=8081
<span class="linenos" data-linenos="13 "></span>VITE_REVERB_SCHEME=http
</code></pre></div>
<ol start="2">
<li>Configura el driver de difusió en <code>config/broadcasting.php</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&#39;reverb&#39; =&gt; [</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    &#39;driver&#39; =&gt; &#39;reverb&#39;,</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &#39;key&#39; =&gt; env(&#39;REVERB_APP_KEY&#39;),</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    &#39;secret&#39; =&gt; env(&#39;REVERB_APP_SECRET&#39;),</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    &#39;app_id&#39; =&gt; env(&#39;REVERB_APP_ID&#39;),</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    &#39;host&#39; =&gt; env(&#39;REVERB_HOST&#39;),</span>
<span class="linenos" data-linenos="7 "></span><span class="x">    &#39;port&#39; =&gt; env(&#39;REVERB_PORT&#39;),</span>
<span class="linenos" data-linenos="8 "></span><span class="x">    &#39;scheme&#39; =&gt; env(&#39;REVERB_SCHEME&#39;),</span>
<span class="linenos" data-linenos="9 "></span><span class="x">],</span>
</code></pre></div>
<ol start="3">
<li>Configuració de Laravel Echo</li>
</ol>
<p>(Si has fet <code>./vendor/bin/sail artisan install:broadcasting</code>, ja està instal·lat.)</p>
<p><strong>On posar el JS?</strong><br />
En Laravel, el codi d’Echo va a <code>resources/js/bootstrap.js</code> (o <code>resources/js/app.js</code> si preferixes).<br />
Després assegura’t que Vite carrega el fitxer a <code>resources/views/layouts/app.blade.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">@vite([&#39;resources/css/app.css&#39;, &#39;resources/js/app.js&#39;])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1">// resources/js/app.js (o bootstrap.js)</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">import</span><span class="w"> </span><span class="nx">Echo</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;laravel-echo&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">import</span><span class="w"> </span><span class="nx">Pusher</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;pusher-js&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="nb">window</span><span class="p">.</span><span class="nx">Pusher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Pusher</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="nb">window</span><span class="p">.</span><span class="nx">Echo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Echo</span><span class="p">({</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="nx">broadcaster</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;reverb&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_APP_KEY</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="nx">wsHost</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_HOST</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="nx">wsPort</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_PORT</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="nx">wssPort</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_PORT</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="nx">forceTLS</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_SCHEME</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;https&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="nx">enabledTransports</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;ws&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;wss&#39;</span><span class="p">],</span>
<span class="linenos" data-linenos="14 "></span><span class="p">});</span>
</code></pre></div>
<p>al front-end, pots afegir el següent codi per comprovar la connexió amb el servidor de WebSockets (opcional):</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">Echo</span><span class="p">.</span><span class="nx">channel</span><span class="p">(</span><span class="s1">&#39;channel-name&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="s1">&#39;EventName&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="p">});</span>
</code></pre></div>
5. <strong>Creació de Canals</strong></p>
<p>Defineix canals en routes/channels.php. Per exemple, un canal privat:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Broadcast::channel(&#39;channel-name&#39;, function ($user) {</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    return true; // Autorització</span>
<span class="linenos" data-linenos="3 "></span><span class="x">});</span>
</code></pre></div>
<ol start="6">
<li><strong>Disparar Esdeveniments en Temps Real</strong></li>
</ol>
<p>Crea esdeveniments que implementen ShouldBroadcast i defineix en quin canal s'han d'emetre.</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">class EventName implements ShouldBroadcast</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    public function broadcastOn()</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="5 "></span><span class="x">        return new Channel(&#39;channel-name&#39;);</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="7 "></span><span class="x">}</span>
</code></pre></div>
7. <strong>Configuració de la Cua</strong></p>
<ul>
<li>Tots els esdeveniments de difusió s'envien a través de treballs en cua (queued jobs).</li>
<li>És necessari configurar i executar un treballador de cua per evitar que la resposta de l'aplicació es veja afectada durant la difusió dels esdeveniments:</li>
<li>Açò <strong>no</strong> és el Scheduler: el Scheduler només cal per tasques periòdiques.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="w">  </span>./vendor/bin/sail<span class="w"> </span>artisan<span class="w"> </span>queue:work
</code></pre></div>
<h1 id="exemple-final-classificacio-futbol-femeni-reverb-livewire">Exemple final: classificació Futbol-femeni (Reverb + Livewire)<a class="headerlink" href="#exemple-final-classificacio-futbol-femeni-reverb-livewire" title="Permanent link">&para;</a></h1>
<h2 id="objectiu">Objectiu<a class="headerlink" href="#objectiu" title="Permanent link">&para;</a></h2>
<p>Actualitzar la classificació quan es modifica un resultat, sense polling.</p>
<h2 id="fitxers-a-modificar-minim">Fitxers a modificar (mínim)<a class="headerlink" href="#fitxers-a-modificar-minim" title="Permanent link">&para;</a></h2>
<ol>
<li><code>.env</code></li>
<li><code>docker-compose.yml</code> (exposar port <code>8081</code>)</li>
<li><code>app/Events/PartitActualitzat.php</code></li>
<li><code>app/Http/Controllers/PartitController.php</code> (o el controlador que actualitza resultats)</li>
<li><code>routes/web.php</code> (ruta update)</li>
<li><code>app/Livewire/ClassificacioTaula.php</code></li>
<li><code>resources/js/bootstrap.js</code> (configuració base d'Echo, normalment ja ve amb <code>install:broadcasting</code>)</li>
</ol>
<h2 id="resum-del-flux">Resum del flux<a class="headerlink" href="#resum-del-flux" title="Permanent link">&para;</a></h2>
<ol>
<li>Es guarda el partit.</li>
<li>S’emet <code>PartitActualitzat</code>.</li>
<li>Reverb publica al canal <code>classificacio</code> amb nom d’event <code>partit.resultat</code>.</li>
<li>Livewire rep l’event directament amb <code>#[On('echo:classificacio,partit.resultat')]</code>.</li>
<li>Livewire re-renderitza la taula.</li>
</ol>
<h2 id="configuracio-primer">Configuració (primer)<a class="headerlink" href="#configuracio-primer" title="Permanent link">&para;</a></h2>
<h3 id="1-env">1) <code>.env</code><a class="headerlink" href="#1-env" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>BROADCAST_CONNECTION=reverb
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>REVERB_APP_ID=your-app-id
<span class="linenos" data-linenos=" 4 "></span>REVERB_APP_KEY=your-app-key
<span class="linenos" data-linenos=" 5 "></span>REVERB_APP_SECRET=your-app-secret
<span class="linenos" data-linenos=" 6 "></span>REVERB_HOST=localhost
<span class="linenos" data-linenos=" 7 "></span>REVERB_PORT=8081
<span class="linenos" data-linenos=" 8 "></span>REVERB_SCHEME=http
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>VITE_REVERB_APP_KEY=your-app-key
<span class="linenos" data-linenos="11 "></span>VITE_REVERB_HOST=localhost
<span class="linenos" data-linenos="12 "></span>VITE_REVERB_PORT=8081
<span class="linenos" data-linenos="13 "></span>VITE_REVERB_SCHEME=http
</code></pre></div>
<h3 id="2-docker-composeyml">2) <code>docker-compose.yml</code><a class="headerlink" href="#2-docker-composeyml" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">services</span><span class="p">:</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="nt">laravel.test</span><span class="p">:</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="linenos" data-linenos="4 "></span><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:80&quot;</span>
<span class="linenos" data-linenos="5 "></span><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;5173:5173&quot;</span>
<span class="linenos" data-linenos="6 "></span><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8081:8081&quot;</span>
</code></pre></div>
<blockquote>
<p>Si ja tens altres ports, deixa'ls i afegeix només <code>8081:8081</code>.</p>
</blockquote>
<h3 id="3-routeschannelsphp-en-este-exemple-no-cal">3) <code>routes/channels.php</code> (en este exemple, no cal)<a class="headerlink" href="#3-routeschannelsphp-en-este-exemple-no-cal" title="Permanent link">&para;</a></h3>
<p>Com que usem <code>new Channel('classificacio')</code> (canal públic), no fa falta registrar res en <code>routes/channels.php</code>.</p>
<p><code>routes/channels.php</code> només és necessari si canvies a <code>PrivateChannel</code> o <code>PresenceChannel</code> i has d'autoritzar accés.</p>
<h3 id="4-packagejson">4) <code>package.json</code><a class="headerlink" href="#4-packagejson" title="Permanent link">&para;</a></h3>
<p>Assegurar (o actualitzar) Alpine:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">&quot;alpinejs&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^3.14.0&quot;</span>
</code></pre></div></p>
<h2 id="codi-despres">Codi (després)<a class="headerlink" href="#codi-despres" title="Permanent link">&para;</a></h2>
<h3 id="5-appeventspartitactualitzatphp">5) <code>app/Events/PartitActualitzat.php</code><a class="headerlink" href="#5-appeventspartitactualitzatphp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Events;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Illuminate\Broadcasting\Channel;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Illuminate\Broadcasting\InteractsWithSockets;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">use Illuminate\Contracts\Broadcasting\ShouldBroadcast;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">use Illuminate\Foundation\Events\Dispatchable;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">use Illuminate\Queue\SerializesModels;</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">class PartitActualitzat implements ShouldBroadcast</span>
<span class="linenos" data-linenos="10 "></span><span class="x">{</span>
<span class="linenos" data-linenos="11 "></span><span class="x">    use Dispatchable, InteractsWithSockets, SerializesModels;</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="x">    public function __construct(public int $partitId) {}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">    public function broadcastOn()</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="17 "></span><span class="x">        return new Channel(&#39;classificacio&#39;);</span>
<span class="linenos" data-linenos="18 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="x">    public function broadcastAs()</span>
<span class="linenos" data-linenos="21 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="22 "></span><span class="x">        return &#39;partit.resultat&#39;;</span>
<span class="linenos" data-linenos="23 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="24 "></span><span class="x">}</span>
</code></pre></div>
<h3 id="6-disparar-levent-des-del-controlador">6) Disparar l’event des del controlador<a class="headerlink" href="#6-disparar-levent-des-del-controlador" title="Permanent link">&para;</a></h3>
<p>Exemple en <code>app/Http/Controllers/PartitController.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">use App\Events\PartitActualitzat;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">use App\Models\Partit;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Illuminate\Http\Request;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">public function update(Request $request, Partit $partit)</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    $dades = $request-&gt;validate([</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">        &#39;gols_local&#39; =&gt; [&#39;required&#39;, &#39;integer&#39;, &#39;min:0&#39;],</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        &#39;gols_visitant&#39; =&gt; [&#39;required&#39;, &#39;integer&#39;, &#39;min:0&#39;],</span>
<span class="linenos" data-linenos="10 "></span><span class="x">    ]);</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="x">    $partit-&gt;update($dades);</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    PartitActualitzat::dispatch($partit-&gt;id);</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">    return back()-&gt;with(&#39;status&#39;, &#39;Resultat actualitzat&#39;);</span>
<span class="linenos" data-linenos="16 "></span><span class="x">}</span>
</code></pre></div>
<p>Ruta en <code>routes/web.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">use App\Http\Controllers\PartitController;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="x">Route::patch(&#39;/partits/{partit}&#39;, [PartitController::class, &#39;update&#39;])</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    -&gt;name(&#39;partits.update&#39;);</span>
</code></pre></div>
<p>Si vols que es llance sempre que el model canvie, pots usar el model:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">protected static function booted()</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    static::updated(function ($partit) {</span>
<span class="linenos" data-linenos="4 "></span><span class="x">        PartitActualitzat::dispatch($partit-&gt;id);</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    });</span>
<span class="linenos" data-linenos="6 "></span><span class="x">}</span>
</code></pre></div>
<h3 id="7-resourcesjsappjs-opcional">7) <code>resources/js/app.js</code> (opcional)<a class="headerlink" href="#7-resourcesjsappjs-opcional" title="Permanent link">&para;</a></h3>
<p>No cal codi extra si uses l'atribut <code>#[On('echo:classificacio,partit.resultat')]</code> a Livewire.
Si vols traça en consola, pots afegir:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">window</span><span class="p">.</span><span class="nx">Echo</span><span class="p">.</span><span class="nx">channel</span><span class="p">(</span><span class="s1">&#39;classificacio&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="s1">&#39;.partit.resultat&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Esdeveniment rebut:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="p">});</span>
</code></pre></div>
<p><strong>Configuració mínima obligatòria (sense listeners manuals):</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1">// resources/js/bootstrap.js (o app.js)</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">import</span><span class="w"> </span><span class="nx">Echo</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;laravel-echo&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">import</span><span class="w"> </span><span class="nx">Pusher</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;pusher-js&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="nb">window</span><span class="p">.</span><span class="nx">Pusher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Pusher</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="nb">window</span><span class="p">.</span><span class="nx">Echo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Echo</span><span class="p">({</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="nx">broadcaster</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;reverb&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_APP_KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="nx">wsHost</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_HOST</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="nx">wsPort</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_PORT</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="nx">wssPort</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_PORT</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="nx">forceTLS</span><span class="o">:</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_REVERB_SCHEME</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;https&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="nx">enabledTransports</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;ws&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;wss&#39;</span><span class="p">],</span>
<span class="linenos" data-linenos="15 "></span><span class="p">});</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// resources/views/layouts/app.blade.php</span>
<span class="linenos" data-linenos="2 "></span><span class="x">@vite([&#39;resources/css/app.css&#39;, &#39;resources/js/app.js&#39;])</span>
</code></pre></div>
<p>Sense aquest bloc base, el navegador no es connecta a Reverb i Livewire no rep <code>echo:...</code>.</p>
<h3 id="8-livewire-taula-de-classificacio">8) Livewire (taula de classificació)<a class="headerlink" href="#8-livewire-taula-de-classificacio" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Livewire;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Livewire\Component;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Livewire\Attributes\On;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">class ClassificacioTaula extends Component</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    #[On(&#39;echo:classificacio,partit.resultat&#39;)]</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    #[On(&#39;classificacio-refresh&#39;)]</span>
<span class="linenos" data-linenos="10 "></span><span class="x">    public function refreshFromBroadcast(): void</span>
<span class="linenos" data-linenos="11 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="12 "></span><span class="x">        // Opció 1: si fas la consulta en render(), n&#39;hi ha prou amb refrescar.</span>
<span class="linenos" data-linenos="13 "></span><span class="x">        $this-&gt;dispatch(&#39;$refresh&#39;);</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">        // Opció 2: si tens un mètode específic, crida&#39;l ací.</span>
<span class="linenos" data-linenos="16 "></span><span class="x">        // $this-&gt;calcularClassificacio();</span>
<span class="linenos" data-linenos="17 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="18 "></span><span class="x">}</span>
</code></pre></div>
<h2 id="al-final-sail-cua-reverb-i-assets">Al final (Sail: cua, Reverb i assets)<a class="headerlink" href="#al-final-sail-cua-reverb-i-assets" title="Permanent link">&para;</a></h2>
<blockquote>
<p><strong>Per què cal la cua?</strong> <code>reverb:start</code> només arranca el servidor WebSocket. Els events de broadcast van per la cua (si uses <code>ShouldBroadcast</code>).<br />
Si no vols cua, pots canviar l’event a <code>ShouldBroadcastNow</code>.</p>
<p><strong>Per què <code>npm install</code>?</strong> Si has actualitzat la versió d’<code>alpinejs</code> al <code>package.json</code>, cal reinstal·lar dependències abans del build.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>./vendor/bin/sail<span class="w"> </span>npm<span class="w"> </span>install
<span class="linenos" data-linenos="2 "></span>./vendor/bin/sail<span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build
<span class="linenos" data-linenos="3 "></span>./vendor/bin/sail<span class="w"> </span>artisan<span class="w"> </span>queue:work
<span class="linenos" data-linenos="4 "></span>./vendor/bin/sail<span class="w"> </span>artisan<span class="w"> </span>reverb:start<span class="w"> </span>--host<span class="o">=</span><span class="m">0</span>.0.0.0<span class="w"> </span>--port<span class="o">=</span><span class="m">8081</span>
</code></pre></div>
<h2 id="integracio-amb-ia-gemini-io-chatgpt">Integració amb IA (Gemini i/o ChatGPT)<a class="headerlink" href="#integracio-amb-ia-gemini-io-chatgpt" title="Permanent link">&para;</a></h2>
<p>Ara substituïm l'opció local per serveis externs. <strong>Gemini</strong> (Google) i <strong>ChatGPT via API d'OpenAI</strong> són de pagament, però solen tindre trams gratuïts o crèdits inicials. </p>
<h3 id="configura-lentorn">Configura l'entorn<a class="headerlink" href="#configura-lentorn" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>OPENAI_API_KEY=your-openai-key
<span class="linenos" data-linenos="2 "></span>OPENAI_MODEL=gpt-5.2
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span>GEMINI_API_KEY=your-gemini-key
<span class="linenos" data-linenos="5 "></span>GEMINI_MODEL=gemini-2.5-flash
</code></pre></div>
<p>En <code>config/services.php</code> afegeix:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&#39;openai&#39; =&gt; [</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    &#39;api_key&#39; =&gt; env(&#39;OPENAI_API_KEY&#39;),</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &#39;model&#39; =&gt; env(&#39;OPENAI_MODEL&#39;, &#39;gpt-5.2&#39;),</span>
<span class="linenos" data-linenos="4 "></span><span class="x">],</span>
<span class="linenos" data-linenos="5 "></span><span class="x">&#39;gemini&#39; =&gt; [</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    &#39;api_key&#39; =&gt; env(&#39;GEMINI_API_KEY&#39;),</span>
<span class="linenos" data-linenos="7 "></span><span class="x">    &#39;model&#39; =&gt; env(&#39;GEMINI_MODEL&#39;, &#39;gemini-2.5-flash&#39;),</span>
<span class="linenos" data-linenos="8 "></span><span class="x">],</span>
</code></pre></div>
<blockquote>
<p><strong>Nota</strong>: Canvia el model pel que tingues disponible al teu compte.</p>
</blockquote>
<h3 id="service-per-a-chatgpt-openai">Service per a ChatGPT (OpenAI)<a class="headerlink" href="#service-per-a-chatgpt-openai" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Services;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use GuzzleHttp\Client;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Illuminate\Support\Facades\Log;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">class OpenAIService</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    public static function getResponse(string $question): string|array</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="10 "></span><span class="x">        try {</span>
<span class="linenos" data-linenos="11 "></span><span class="x">            $client = new Client([</span>
<span class="linenos" data-linenos="12 "></span><span class="x">                &#39;base_uri&#39; =&gt; &#39;https://api.openai.com/&#39;,</span>
<span class="linenos" data-linenos="13 "></span><span class="x">                &#39;headers&#39; =&gt; [</span>
<span class="linenos" data-linenos="14 "></span><span class="x">                    &#39;Content-Type&#39; =&gt; &#39;application/json&#39;,</span>
<span class="linenos" data-linenos="15 "></span><span class="x">                    &#39;Authorization&#39; =&gt; &#39;Bearer &#39; . config(&#39;services.openai.api_key&#39;),</span>
<span class="linenos" data-linenos="16 "></span><span class="x">                ],</span>
<span class="linenos" data-linenos="17 "></span><span class="x">            ]);</span>
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span><span class="x">            $response = $client-&gt;post(&#39;v1/chat/completions&#39;, [</span>
<span class="linenos" data-linenos="20 "></span><span class="x">                &#39;json&#39; =&gt; [</span>
<span class="linenos" data-linenos="21 "></span><span class="x">                    &#39;model&#39; =&gt; config(&#39;services.openai.model&#39;),</span>
<span class="linenos" data-linenos="22 "></span><span class="x">                    &#39;messages&#39; =&gt; [</span>
<span class="linenos" data-linenos="23 "></span><span class="x">                        [&#39;role&#39; =&gt; &#39;user&#39;, &#39;content&#39; =&gt; $question],</span>
<span class="linenos" data-linenos="24 "></span><span class="x">                    ],</span>
<span class="linenos" data-linenos="25 "></span><span class="x">                ],</span>
<span class="linenos" data-linenos="26 "></span><span class="x">            ]);</span>
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span><span class="x">            $body = json_decode($response-&gt;getBody()-&gt;getContents(), true);</span>
<span class="linenos" data-linenos="29 "></span><span class="x">            return $body[&#39;choices&#39;][0][&#39;message&#39;][&#39;content&#39;] ?? &#39;&#39;;</span>
<span class="linenos" data-linenos="30 "></span><span class="x">        } catch (\Exception $e) {</span>
<span class="linenos" data-linenos="31 "></span><span class="x">            Log::error(&#39;Error en la resposta d\&#39;OpenAI: &#39; . $e-&gt;getMessage());</span>
<span class="linenos" data-linenos="32 "></span><span class="x">            return [&#39;error&#39; =&gt; &#39;No s\&#39;ha pogut obtenir una resposta.&#39;];</span>
<span class="linenos" data-linenos="33 "></span><span class="x">        }</span>
<span class="linenos" data-linenos="34 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="35 "></span><span class="x">}</span>
</code></pre></div>
<h3 id="service-per-a-gemini-google">Service per a Gemini (Google)<a class="headerlink" href="#service-per-a-gemini-google" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Services;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use GuzzleHttp\Client;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Illuminate\Support\Facades\Log;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">class GeminiService</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    public static function getResponse(string $question): string|array</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="10 "></span><span class="x">        try {</span>
<span class="linenos" data-linenos="11 "></span><span class="x">            $client = new Client([</span>
<span class="linenos" data-linenos="12 "></span><span class="x">                &#39;base_uri&#39; =&gt; &#39;https://generativelanguage.googleapis.com/&#39;,</span>
<span class="linenos" data-linenos="13 "></span><span class="x">                &#39;headers&#39; =&gt; [</span>
<span class="linenos" data-linenos="14 "></span><span class="x">                    &#39;Content-Type&#39; =&gt; &#39;application/json&#39;,</span>
<span class="linenos" data-linenos="15 "></span><span class="x">                ],</span>
<span class="linenos" data-linenos="16 "></span><span class="x">            ]);</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="x">            $model = config(&#39;services.gemini.model&#39;);</span>
<span class="linenos" data-linenos="19 "></span><span class="x">            $response = $client-&gt;post(&quot;v1beta/models/{$model}:generateContent&quot;, [</span>
<span class="linenos" data-linenos="20 "></span><span class="x">                &#39;headers&#39; =&gt; [</span>
<span class="linenos" data-linenos="21 "></span><span class="x">                    &#39;x-goog-api-key&#39; =&gt; config(&#39;services.gemini.api_key&#39;),</span>
<span class="linenos" data-linenos="22 "></span><span class="x">                ],</span>
<span class="linenos" data-linenos="23 "></span><span class="x">                &#39;json&#39; =&gt; [</span>
<span class="linenos" data-linenos="24 "></span><span class="x">                    &#39;contents&#39; =&gt; [</span>
<span class="linenos" data-linenos="25 "></span><span class="x">                        [</span>
<span class="linenos" data-linenos="26 "></span><span class="x">                            &#39;parts&#39; =&gt; [</span>
<span class="linenos" data-linenos="27 "></span><span class="x">                                [&#39;text&#39; =&gt; $question],</span>
<span class="linenos" data-linenos="28 "></span><span class="x">                            ],</span>
<span class="linenos" data-linenos="29 "></span><span class="x">                        ],</span>
<span class="linenos" data-linenos="30 "></span><span class="x">                    ],</span>
<span class="linenos" data-linenos="31 "></span><span class="x">                ],</span>
<span class="linenos" data-linenos="32 "></span><span class="x">            ]);</span>
<span class="linenos" data-linenos="33 "></span>
<span class="linenos" data-linenos="34 "></span><span class="x">            $body = json_decode($response-&gt;getBody()-&gt;getContents(), true);</span>
<span class="linenos" data-linenos="35 "></span><span class="x">            return $body[&#39;candidates&#39;][0][&#39;content&#39;][&#39;parts&#39;][0][&#39;text&#39;] ?? &#39;&#39;;</span>
<span class="linenos" data-linenos="36 "></span><span class="x">        } catch (\Exception $e) {</span>
<span class="linenos" data-linenos="37 "></span><span class="x">            Log::error(&#39;Error en la resposta de Gemini: &#39; . $e-&gt;getMessage());</span>
<span class="linenos" data-linenos="38 "></span><span class="x">            return [&#39;error&#39; =&gt; &#39;No s\&#39;ha pogut obtenir una resposta.&#39;];</span>
<span class="linenos" data-linenos="39 "></span><span class="x">        }</span>
<span class="linenos" data-linenos="40 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="41 "></span><span class="x">}</span>
</code></pre></div>
<h3 id="us-basic">Ús bàsic<a class="headerlink" href="#us-basic" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$descripcio = OpenAIService::getResponse(&#39;Dona una descripció del &#39;.$equip-&gt;nom.&#39; de Futbol Femení&#39;);</span>
<span class="linenos" data-linenos="2 "></span><span class="x">// o bé</span>
<span class="linenos" data-linenos="3 "></span><span class="x">$descripcio = GeminiService::getResponse(&#39;Dona una descripció del &#39;.$equip-&gt;nom.&#39; de Futbol Femení&#39;);</span>
</code></pre></div>
<p>A partir d'ací pots adaptar prompts, controlar costos i afegir memòria o historial de conversa segons necessites.</p>
<h2 id="gestio-de-pagaments">Gestió de pagaments<a class="headerlink" href="#gestio-de-pagaments" title="Permanent link">&para;</a></h2>
<blockquote>
<p><strong>Nota</strong>: Aquesta part és informativa. Les passarel·les de pagament són serveis de pagament i es treballaran només en mode sandbox. Per a pràctiques, usarem <strong>PayPal Sandbox</strong> i <strong>Stripe test mode (targeta)</strong>.</p>
</blockquote>
<p>La primera decisió que hem de pendre es triar la passarel·la de Pagament: Hi ha moltes opcions com Stripe, PayPal, PayU, Braintree, Square, Authorize.Net...
Totes solen tindre entorn de proves(sanbox) on fer transaccions fictícies per a provar el funcionament de la passarel·la de pagament.</p>
<h3 id="paypal">PayPal<a class="headerlink" href="#paypal" title="Permanent link">&para;</a></h3>
<p>Per permetre que un usuari pague amb el seu compte PayPal Sandbox a un compte Business de Sandbox en una aplicació Laravel, hauràs de seguir una sèrie de passos. Aquests passos impliquen la configuració del teu entorn de Sandbox a PayPal i la integració amb la teva aplicació Laravel utilitzant el paquet paypal/rest-api-sdk-php o una altra biblioteca similar. Aquí tens una guia pas a pas:</p>
<ul>
<li>
<p>Configura els Comptes Sandbox: Assegura't que tens dos comptes en PayPal Sandbox: un compte personal (que simula el comprador) i un compte Business (que simula el venedor).</p>
</li>
<li>
<p>Instal·la el Paquet de PayPal en Laravel: Utilitza Composer per instal·lar el paquet <code>paypal/rest-api-sdk-php</code> o una altra biblioteca de PayPal compatible amb Laravel.</p>
</li>
<li>
<p>Configura les Credencials de Sandbox en Laravel: Obté les credencials del teu compte Business de Sandbox (ID de client i secret) i configura-les en el teu projecte Laravel, normalment a través del fitxer .env. i configura el `services.php</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&#39;paypal&#39; =&gt; [</span>
<span class="linenos" data-linenos="2 "></span><span class="x">&#39;client_id&#39; =&gt; env(&#39;PAYPAL_CLIENT_ID&#39;),</span>
<span class="linenos" data-linenos="3 "></span><span class="x">&#39;client_secret&#39; =&gt; env(&#39;PAYPAL_CLIENT_SECRET&#39;),</span>
<span class="linenos" data-linenos="4 "></span><span class="x">],</span>
</code></pre></div>
<ul>
<li>Crea un Context d'API de PayPal: Utilitza les credencials del teu compte Business de Sandbox per crear un objecte ApiContext. Aquest objecte s'utilitzarà per a realitzar crides a l'API de PayPal.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">use PayPal\Rest\ApiContext;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">use PayPal\Auth\OAuthTokenCredential;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">// ...</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">public function createPayment()</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    $apiContext = new ApiContext(new OAuthTokenCredential(</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">            env(&#39;PAYPAL_CLIENT_ID&#39;),     // ClientID</span>
<span class="linenos" data-linenos="10 "></span><span class="x">            env(&#39;PAYPAL_SECRET&#39;)         // ClientSecret</span>
<span class="linenos" data-linenos="11 "></span><span class="x">        )</span>
<span class="linenos" data-linenos="12 "></span><span class="x">    );</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="x">    // Configura el `ApiContext` segons les teves necessitats</span>
<span class="linenos" data-linenos="15 "></span><span class="x">    $apiContext-&gt;setConfig([</span>
<span class="linenos" data-linenos="16 "></span><span class="x">        &#39;mode&#39; =&gt; &#39;sandbox&#39;, // Mode Sandbox per a proves</span>
<span class="linenos" data-linenos="17 "></span><span class="x">        // Altres configuracions...</span>
<span class="linenos" data-linenos="18 "></span><span class="x">    ]);</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="x">    // Aquí va la resta de la teva lògica de pagament...</span>
<span class="linenos" data-linenos="21 "></span><span class="x">}</span>
</code></pre></div>
<ul>
<li>Implementa la Lògica de Pagament:<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>* Desenvolupa la lògica en els teus controladors Laravel per crear sol·licituds de pagament. Això inclou la creació d&#39;objectes de pagament amb detalls com l&#39;import, la moneda, i la descripció.
<span class="linenos" data-linenos="2 "></span>* Redirigeix l&#39;Usuari a PayPal: Quan un usuari iniciï un pagament, redirigeix-lo a la pàgina de pagament de PayPal utilitzant l&#39;URL proporcionada per la biblioteca. L&#39;usuari iniciarà sessió amb el seu compte personal de Sandbox per completar el pagament.
<span class="linenos" data-linenos="3 "></span>* Gestiona la Resposta de PayPal: Després que l&#39;usuari completi el pagament, serà redirigit de tornada a la teva aplicació. Necessitaràs gestionar aquesta resposta per confirmar la transacció.
<span class="linenos" data-linenos="4 "></span>* Prova el Procés de Pagament: Realitza proves utilitzant els teus comptes de Sandbox per assegurar-te que tot funciona com s&#39;espera. Això inclou iniciar un pagament amb el compte personal de Sandbox i rebre el pagament en el compte Business de Sandbox.
<span class="linenos" data-linenos="5 "></span>* Revisa i Depura: Comprova que les transaccions es mostren correctament en els panells de control de Sandbox tant del comprador com del venedor. Depura qualsevol problema que puguis trobar.
</code></pre></div>
</li>
</ul>
<p>Exemple de creació d'un pagament amb el SDK de PayPal:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">use PayPal\Api\Amount;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">use PayPal\Api\Payer;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use PayPal\Api\Payment;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use PayPal\Api\RedirectUrls;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">use PayPal\Api\Transaction;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">use PayPal\Rest\ApiContext;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">use PayPal\Auth\OAuthTokenCredential;</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">class PaymentController extends Controller</span>
<span class="linenos" data-linenos="10 "></span><span class="x">{</span>
<span class="linenos" data-linenos="11 "></span><span class="x">    private $apiContext;</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="x">    public function __construct()</span>
<span class="linenos" data-linenos="14 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="15 "></span><span class="x">        $this-&gt;apiContext = new ApiContext(</span>
<span class="linenos" data-linenos="16 "></span><span class="x">            new OAuthTokenCredential(</span>
<span class="linenos" data-linenos="17 "></span><span class="x">                env(&#39;PAYPAL_SANDBOX_CLIENT_ID&#39;),     // ClientID</span>
<span class="linenos" data-linenos="18 "></span><span class="x">                env(&#39;PAYPAL_SANDBOX_SECRET&#39;)         // ClientSecret</span>
<span class="linenos" data-linenos="19 "></span><span class="x">            )</span>
<span class="linenos" data-linenos="20 "></span><span class="x">        );</span>
<span class="linenos" data-linenos="21 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="x">    public function createPayment()</span>
<span class="linenos" data-linenos="24 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="25 "></span><span class="x">        $payer = new Payer();</span>
<span class="linenos" data-linenos="26 "></span><span class="x">        $payer-&gt;setPaymentMethod(&#39;paypal&#39;);</span>
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span><span class="x">        $amount = new Amount();</span>
<span class="linenos" data-linenos="29 "></span><span class="x">        $amount-&gt;setTotal(&#39;10.00&#39;);  // Defineix l&#39;import del pagament</span>
<span class="linenos" data-linenos="30 "></span><span class="x">        $amount-&gt;setCurrency(&#39;EUR&#39;); // Defineix la moneda</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="x">        $transaction = new Transaction();</span>
<span class="linenos" data-linenos="33 "></span><span class="x">        $transaction-&gt;setAmount($amount);</span>
<span class="linenos" data-linenos="34 "></span><span class="x">        $transaction-&gt;setDescription(&#39;Descripció del pagament&#39;);</span>
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span><span class="x">        $redirectUrls = new RedirectUrls();</span>
<span class="linenos" data-linenos="37 "></span><span class="x">        $redirectUrls-&gt;setReturnUrl(url(&#39;/payment/success&#39;)) // URL de retorn en cas d&#39;èxit</span>
<span class="linenos" data-linenos="38 "></span><span class="x">                     -&gt;setCancelUrl(url(&#39;/payment/cancel&#39;)); // URL de retorn en cas de cancel·lació</span>
<span class="linenos" data-linenos="39 "></span>
<span class="linenos" data-linenos="40 "></span><span class="x">        $payment = new Payment();</span>
<span class="linenos" data-linenos="41 "></span><span class="x">        $payment-&gt;setIntent(&#39;sale&#39;)</span>
<span class="linenos" data-linenos="42 "></span><span class="x">                -&gt;setPayer($payer)</span>
<span class="linenos" data-linenos="43 "></span><span class="x">                -&gt;setTransactions([$transaction])</span>
<span class="linenos" data-linenos="44 "></span><span class="x">                -&gt;setRedirectUrls($redirectUrls);</span>
<span class="linenos" data-linenos="45 "></span>
<span class="linenos" data-linenos="46 "></span><span class="x">        try {</span>
<span class="linenos" data-linenos="47 "></span><span class="x">            $payment-&gt;create($this-&gt;apiContext);</span>
<span class="linenos" data-linenos="48 "></span><span class="x">            return redirect()-&gt;away($payment-&gt;getApprovalLink());</span>
<span class="linenos" data-linenos="49 "></span><span class="x">        } catch (Exception $e) {</span>
<span class="linenos" data-linenos="50 "></span><span class="x">            // Gestiona l&#39;error aquí</span>
<span class="linenos" data-linenos="51 "></span><span class="x">            return back()-&gt;with(&#39;error&#39;, &#39;Hi ha hagut un problema en processar el pagament&#39;);</span>
<span class="linenos" data-linenos="52 "></span><span class="x">        }</span>
<span class="linenos" data-linenos="53 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="54 "></span>
<span class="linenos" data-linenos="55 "></span><span class="x">    public function successPayment(Request $request)</span>
<span class="linenos" data-linenos="56 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="57 "></span><span class="x">        $paymentId = $request-&gt;get(&#39;paymentId&#39;);</span>
<span class="linenos" data-linenos="58 "></span><span class="x">        $payerId = $request-&gt;get(&#39;PayerID&#39;);</span>
<span class="linenos" data-linenos="59 "></span>
<span class="linenos" data-linenos="60 "></span><span class="x">        if (empty($paymentId) || empty($payerId)) {</span>
<span class="linenos" data-linenos="61 "></span><span class="x">            // Redirigeix a una pàgina d&#39;error o mostra un missatge</span>
<span class="linenos" data-linenos="62 "></span><span class="x">            return redirect(&#39;/&#39;)-&gt;with(&#39;error&#39;, &quot;El pagament no s&#39;ha pogut verificar.&quot;);</span>
<span class="linenos" data-linenos="63 "></span><span class="x">        }</span>
<span class="linenos" data-linenos="64 "></span>
<span class="linenos" data-linenos="65 "></span><span class="x">        $payment = Payment::get($paymentId, $this-&gt;apiContext);</span>
<span class="linenos" data-linenos="66 "></span>
<span class="linenos" data-linenos="67 "></span><span class="x">        $execution = new PaymentExecution();</span>
<span class="linenos" data-linenos="68 "></span><span class="x">        $execution-&gt;setPayerId($payerId);</span>
<span class="linenos" data-linenos="69 "></span>
<span class="linenos" data-linenos="70 "></span><span class="x">        try {</span>
<span class="linenos" data-linenos="71 "></span><span class="x">            // Executa el pagament</span>
<span class="linenos" data-linenos="72 "></span><span class="x">            $result = $payment-&gt;execute($execution, $this-&gt;apiContext);</span>
<span class="linenos" data-linenos="73 "></span>
<span class="linenos" data-linenos="74 "></span><span class="x">            // Comprova que el pagament s&#39;ha completat amb èxit</span>
<span class="linenos" data-linenos="75 "></span><span class="x">            if ($result-&gt;getState() == &#39;approved&#39;) {</span>
<span class="linenos" data-linenos="76 "></span><span class="x">                // Aquí pots processar la informació de la transacció, </span>
<span class="linenos" data-linenos="77 "></span><span class="x">                // com ara actualitzar la base de dades, etc.</span>
<span class="linenos" data-linenos="78 "></span><span class="x">                return redirect(&#39;/&#39;)-&gt;with(&#39;success&#39;, &#39;Pagament completat amb èxit.&#39;);</span>
<span class="linenos" data-linenos="79 "></span><span class="x">            }</span>
<span class="linenos" data-linenos="80 "></span><span class="x">        } catch (Exception $e) {</span>
<span class="linenos" data-linenos="81 "></span><span class="x">            // Gestiona els errors aquí</span>
<span class="linenos" data-linenos="82 "></span><span class="x">            return redirect(&#39;/&#39;)-&gt;with(&#39;error&#39;, &#39;Hi ha hagut un problema en processar el teu pagament.&#39;);</span>
<span class="linenos" data-linenos="83 "></span><span class="x">        }</span>
<span class="linenos" data-linenos="84 "></span>
<span class="linenos" data-linenos="85 "></span><span class="x">        return redirect(&#39;/&#39;)-&gt;with(&#39;error&#39;, &quot;El pagament no s&#39;ha pogut completar.&quot;);</span>
<span class="linenos" data-linenos="86 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="87 "></span>
<span class="linenos" data-linenos="88 "></span><span class="x">    // Aquí pots afegir els mètodes per gestionar la cancel·lació  del pagament</span>
<span class="linenos" data-linenos="89 "></span><span class="x">}</span>
</code></pre></div>
Defineix les rutes</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Route::get(&#39;/payment/create&#39;, &#39;PaymentController@createPayment&#39;);</span>
<span class="linenos" data-linenos="2 "></span><span class="x">Route::get(&#39;/payment/success&#39;, &#39;PaymentController@successPayment&#39;);</span>
<span class="linenos" data-linenos="3 "></span><span class="x">Route::get(&#39;/payment/cancel&#39;, &#39;PaymentController@cancelPayment&#39;);</span>
</code></pre></div>
<p>És important seguir aquests passos detalladament i referir-se a la documentació específica de la biblioteca que estàs utilitzant per obtenir instruccions detallades i exemples de codi. La clau està en la correcta configuració i integració de les credencials de PayPal Sandbox i la correcta gestió de les respostes de l'API de PayPal.</p>
<p><strong>Notes Importants</strong>
Aquest exemple és molt bàsic i només per a fins educatius. En un entorn de producció, hauràs de gestionar molts altres aspectes com la verificació de seguretat, el maneig d'errors més detallat, i la integració amb la base de dades.
Assegura't de provar aquest codi en l'entorn de Sandbox de PayPal abans de considerar la seva implementació en producció.
Personalitza els imports del pagament (import, moneda, descripció) segons les necessitats del teu projecte.</p>
<h3 id="stripe-test-mode-amb-targeta">Stripe (test mode amb targeta)<a class="headerlink" href="#stripe-test-mode-amb-targeta" title="Permanent link">&para;</a></h3>
<p>Stripe permet fer proves amb targetes fictícies en <strong>test mode</strong>. És recomanable usar <strong>Stripe Checkout</strong> perquè simplifica el flux.</p>
<ol>
<li>Crea un compte a Stripe i activa el <strong>test mode</strong>.</li>
<li>Obté les claus de test i afegeix-les al <code>.env</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>STRIPE_KEY=pk_test_your_key
<span class="linenos" data-linenos="2 "></span>STRIPE_SECRET=sk_test_your_secret
</code></pre></div>
<ol start="3">
<li>Instal·la el SDK de Stripe:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer<span class="w"> </span>require<span class="w"> </span>stripe/stripe-php
</code></pre></div>
<ol start="4">
<li>Endpoint bàsic per crear una sessió de Checkout:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">use Stripe\Stripe;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">use Stripe\Checkout\Session;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">public function createStripeCheckout()</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    Stripe::setApiKey(env(&#39;STRIPE_SECRET&#39;));</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    $session = Session::create([</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        &#39;mode&#39; =&gt; &#39;payment&#39;,</span>
<span class="linenos" data-linenos="10 "></span><span class="x">        &#39;line_items&#39; =&gt; [[</span>
<span class="linenos" data-linenos="11 "></span><span class="x">            &#39;price_data&#39; =&gt; [</span>
<span class="linenos" data-linenos="12 "></span><span class="x">                &#39;currency&#39; =&gt; &#39;eur&#39;,</span>
<span class="linenos" data-linenos="13 "></span><span class="x">                &#39;product_data&#39; =&gt; [&#39;name&#39; =&gt; &#39;Subscripció Demo&#39;],</span>
<span class="linenos" data-linenos="14 "></span><span class="x">                &#39;unit_amount&#39; =&gt; 1000, // 10,00 €</span>
<span class="linenos" data-linenos="15 "></span><span class="x">            ],</span>
<span class="linenos" data-linenos="16 "></span><span class="x">            &#39;quantity&#39; =&gt; 1,</span>
<span class="linenos" data-linenos="17 "></span><span class="x">        ]],</span>
<span class="linenos" data-linenos="18 "></span><span class="x">        &#39;success_url&#39; =&gt; url(&#39;/stripe/success&#39;),</span>
<span class="linenos" data-linenos="19 "></span><span class="x">        &#39;cancel_url&#39; =&gt; url(&#39;/stripe/cancel&#39;),</span>
<span class="linenos" data-linenos="20 "></span><span class="x">    ]);</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="x">    return redirect()-&gt;away($session-&gt;url);</span>
<span class="linenos" data-linenos="23 "></span><span class="x">}</span>
</code></pre></div>
<ol start="5">
<li>Per a provar, utilitza una targeta de test (p. ex. <code>4242 4242 4242 4242</code> amb qualsevol data futura i CVC).</li>
</ol>
<h2 id="integracio-de-n8n-en-el-desenvolupament-web-mashups">Integració de n8n en el desenvolupament web (mashups)<a class="headerlink" href="#integracio-de-n8n-en-el-desenvolupament-web-mashups" title="Permanent link">&para;</a></h2>
<p>n8n és una eina d'automatització que pot actuar com a <strong>orquestrador de dades</strong> entre serveis gratuïts i la teua app web. Pots fer que n8n agregue dades de diverses APIs obertes i expose un endpoint únic per a la teua aplicació.</p>
<h3 id="patro-recomanat">Patró recomanat<a class="headerlink" href="#patro-recomanat" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>n8n</strong> rep una petició (Webhook).</li>
<li><strong>n8n</strong> consulta una o més APIs gratuïtes (open data, Open-Meteo, OpenStreetMap, etc.).</li>
<li><strong>n8n</strong> normalitza i respon amb JSON.</li>
<li><strong>Laravel</strong> consumeix eixe JSON com si fora una API pròpia.</li>
</ol>
<h3 id="exemple-de-flux-en-n8n">Exemple de flux en n8n<a class="headerlink" href="#exemple-de-flux-en-n8n" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Webhook</strong> (trigger) → <strong>HTTP Request</strong> (API externa) → <strong>Set</strong> (netejar camps) → <strong>Respond to Webhook</strong>.</li>
</ul>
<h3 id="mini-exemple-n8n-openstreetmap-nominatim">Mini-exemple n8n + OpenStreetMap (Nominatim)<a class="headerlink" href="#mini-exemple-n8n-openstreetmap-nominatim" title="Permanent link">&para;</a></h3>
<p>Objectiu: rebre un nom de lloc i tornar coordenades bàsiques.</p>
<p><strong>Flux en n8n</strong>
1. <strong>Webhook</strong> (POST) amb cos:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;q&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Universitat de València&quot;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
2. <strong>HTTP Request</strong>:
   - Method: <code>GET</code>
   - URL: <code>https://nominatim.openstreetmap.org/search</code>
   - Query:
     - <code>q</code> = <code>{{$json.q}}</code>
     - <code>format</code> = <code>json</code>
     - <code>limit</code> = <code>1</code>
   - Headers:
     - <code>User-Agent</code>: <code>dwes-mashup-class</code>
3. <strong>Set</strong> (netejar resposta):
   - <code>name</code> = <code>{{$json[0].display_name}}</code>
   - <code>lat</code> = <code>{{$json[0].lat}}</code>
   - <code>lon</code> = <code>{{$json[0].lon}}</code>
4. <strong>Respond to Webhook</strong> amb:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div></p>
<p><strong>Consum des de Laravel</strong></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">use Illuminate\Support\Facades\Http;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="x">$response = Http::post(env(&#39;N8N_WEBHOOK_URL&#39;), [</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    &#39;q&#39; =&gt; &#39;Universitat de València&#39;,</span>
<span class="linenos" data-linenos="5 "></span><span class="x">]);</span>
<span class="linenos" data-linenos="6 "></span>
<span class="linenos" data-linenos="7 "></span><span class="x">$coords = $response-&gt;json();</span>
</code></pre></div>
<h3 id="exemple-de-crida-des-de-laravel">Exemple de crida des de Laravel<a class="headerlink" href="#exemple-de-crida-des-de-laravel" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">use Illuminate\Support\Facades\Http;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="x">$response = Http::post(env(&#39;N8N_WEBHOOK_URL&#39;), [</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    &#39;city&#39; =&gt; &#39;València&#39;,</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    &#39;date&#39; =&gt; &#39;2026-01-27&#39;,</span>
<span class="linenos" data-linenos="6 "></span><span class="x">]);</span>
<span class="linenos" data-linenos="7 "></span>
<span class="linenos" data-linenos="8 "></span><span class="x">$data = $response-&gt;json();</span>
</code></pre></div>
<h3 id="seguretat-basica">Seguretat bàsica<a class="headerlink" href="#seguretat-basica" title="Permanent link">&para;</a></h3>
<ul>
<li>Usa URLs de webhook amb token o afegeix un header secret.</li>
<li>Limita i valida els paràmetres que accepts.</li>
<li>Registra errors i temps de resposta per a depurar.</li>
</ul>
<h2 id="exemple-de-reutilitzacio-de-codi">Exemple de reutilització de codi<a class="headerlink" href="#exemple-de-reutilitzacio-de-codi" title="Permanent link">&para;</a></h2>
<h3 id="autenticacio-amb-google-integrada">Autenticació amb Google (integrada)<a class="headerlink" href="#autenticacio-amb-google-integrada" title="Permanent link">&para;</a></h3>
<p>Per evitar duplicats, usa com a referència la secció principal:
<code>## Autenticació amb Google</code> (instal·lació, <code>.env</code>, <code>config/services.php</code>, rutes i controlador web).</p>
<h4 id="configuracio-del-compte-a-google-cloud-resum">Configuració del compte a Google Cloud (resum)<a class="headerlink" href="#configuracio-del-compte-a-google-cloud-resum" title="Permanent link">&para;</a></h4>
<ol>
<li>Entra a <a href="https://console.cloud.google.com/">Google Cloud Console</a>.</li>
<li>Crea (o selecciona) un projecte.</li>
<li>Ves a <code>APIs &amp; Services</code> -&gt; <code>OAuth consent screen</code> i configura la pantalla de consentiment.</li>
<li>Ves a <code>APIs &amp; Services</code> -&gt; <code>Credentials</code> -&gt; <code>Create Credentials</code> -&gt; <code>OAuth client ID</code>.</li>
<li>Tria tipus <strong>Web application</strong>.</li>
<li>Afegeix l'URI de redirecció autoritzat:
   - <code>http://localhost/auth/google/callback</code></li>
<li>Guarda i copia <code>Client ID</code> i <code>Client Secret</code> al <code>.env</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>GOOGLE_CLIENT_ID=your-client-id
<span class="linenos" data-linenos="2 "></span>GOOGLE_CLIENT_SECRET=your-client-secret
<span class="linenos" data-linenos="3 "></span>GOOGLE_REDIRECT=http://localhost/auth/google/callback
</code></pre></div>
<blockquote>
<p>Si treballes amb Sail i URL diferent de <code>localhost</code>, usa exactament la mateixa URL al <code>.env</code> i a la credencial d'OAuth.</p>
</blockquote>
<p>Si necessites una variant per a API:</p>
<ol>
<li>Després de validar el callback de Google, pots generar un token de Sanctum.</li>
<li>Retorna JSON o una vista específica segons el teu flux.</li>
</ol>
<p>Exemple mínim (variant API):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$token = $user-&gt;createToken(&#39;Personal Access Token&#39;)-&gt;plainTextToken;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">return response()-&gt;json([&#39;token&#39; =&gt; $token]);</span>
</code></pre></div>
<h3 id="exemple-dintegracio-amb-ia-gemini-o-chatgpt">Exemple d'integració amb IA (Gemini o ChatGPT)<a class="headerlink" href="#exemple-dintegracio-amb-ia-gemini-o-chatgpt" title="Permanent link">&para;</a></h3>
<p>Utilitza el servei en el teu controlador per obtenir una descripció (equip o estadi):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">public function show(Equip $equip) {</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">    $descripcio = OpenAIService::getResponse(</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">        &#39;Dona una descripció del &#39;.$equip-&gt;nom.&#39; de Futbol Femení&#39;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">    );</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    // o bé</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    // $descripcio = GeminiService::getResponse(</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    //     &#39;Dona una descripció de l\&#39;estadi &#39;.$equip-&gt;estadi-&gt;nom</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    // );</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="x">    return view(&#39;equips.show&#39;, compact(&#39;equip&#39;,&#39;descripcio&#39;));</span>
<span class="linenos" data-linenos="11 "></span><span class="x">}</span>
</code></pre></div>
<p>Modifica la vista per a mostrar la descripció:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">@extends(&#39;layouts.futbolFemeni&#39;)</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">@section(&#39;title&#39;, &quot;Pàgina equip Femení&quot; )</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">@section(&#39;content&#39;)</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">&lt;x-equip</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">   :nom=&quot;$equip-&gt;nom&quot;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">   :estadi=&quot;$equip-&gt;estadi-&gt;nom&quot;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">   :titols=&quot;$equip-&gt;titols&quot;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">   :escut=&quot;$equip-&gt;escut&quot;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">   :jugadores=&quot;$equip-&gt;jugadores&quot;</span>
<span class="linenos" data-linenos="10 "></span><span class="x">   :descripcio=&quot;$descripcio&quot;</span>
<span class="linenos" data-linenos="11 "></span><span class="x">/&gt;</span>
<span class="linenos" data-linenos="12 "></span><span class="x">@endsection</span>
</code></pre></div>
<p>Modifica el component de la vista ...</p>
<h3 id="activitats">Activitats<a class="headerlink" href="#activitats" title="Permanent link">&para;</a></h3>
<h4 id="tria-2-destes-o-implementa-2-diferentes">Tria 2 d'estes o implementa 2 diferentes<a class="headerlink" href="#tria-2-destes-o-implementa-2-diferentes" title="Permanent link">&para;</a></h4>
<ol>
<li>Autenticació amb Google per a Futbol-femeni: crea el rol [convidat], sense permisos en BD i sense password; només pot entrar amb Google. La resta d'usuaris no poden autenticar-se amb Google.</li>
<li>IA al projecte de Futbol-femeni: genera una descripció d'equip o estadi amb Gemini o ChatGPT i mostra-la a la vista (cache simple opcional).</li>
<li>Mashup amb dades obertes (crides directes): <strong>meteorologia</strong>. Propostes:
   - <strong>Open‑Meteo</strong> (sense API key, forecast global).
   - <strong>AEMET OpenData</strong> (API oficial d’Espanya amb clau gratuïta).
   Agrega la predicció del dia o el risc de pluja i mostra-ho en la fitxa d’equip/estadi.</li>
<li>Opcional (si teniu classificació): quan canvia la classificació, mostra una alerta i canvia el color de l'equip a roig si baixa o a verd si puja.</li>
</ol>









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2021-2026 Aitor Medrano, Luis Alemañ, Ignasi Gomis - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/aitormedrano" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.2 4.2 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.52 8.52 0 0 1-5.33 1.84q-.51 0-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<a.medrano@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 12.13c-.15.01-.29.06-.39.17l-1 1 2.05 2 1-1c.22-.21.22-.56 0-.77l-1.24-1.23a.56.56 0 0 0-.38-.17m-2 1.75L13 19.94V22h2.06l6.06-6.07M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h7v-.89l8.24-8.22c.47-.49 1.12-.76 1.8-.76.34 0 .68.06 1 .19V6c0-1.12-.92-2-2.04-2m0 4-8 5-8-5V6l8 5 8-5"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["header.autohide", "toc.integrate", "content.tabs.link"], "search": "assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiat al porta-retalls", "clipboard.copy": "C\u00f2pia al porta-retalls", "search.result.more.one": "1 m\u00e9s en aquesta p\u00e0gina", "search.result.more.other": "# m\u00e9s en aquesta p\u00e0gina", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.term.missing": "Desaparegut", "select.version": "Selecciona la versi\u00f3"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>