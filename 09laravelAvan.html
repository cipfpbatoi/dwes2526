
<!doctype html>
<html lang="ca" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://cipfpbatoi.github.io/dwes2526/09laravelAvan.html">
      
      
      
      
        
      
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Laravel Avançat - Desenvolupament web en entorn de Servidor</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-X6D0LR7TC8"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-X6D0LR7TC8",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-X6D0LR7TC8",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#laravel-avancat" class="md-skip">
          Salta el contingut
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Capçalera">
    <a href="index.html" title="Desenvolupament web en entorn de Servidor" class="md-header__button md-logo" aria-label="Desenvolupament web en entorn de Servidor" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Desenvolupament web en entorn de Servidor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Laravel Avançat
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Canviar a mode nit"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Canviar a mode nit" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Canviar a mode dia"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Canviar a mode dia" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Cerca">
        
        <button type="reset" class="md-search__icon md-icon" title="Neteja" aria-label="Neteja" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicialitzant cerca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegació" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Desenvolupament web en entorn de Servidor" class="md-nav__button md-logo" aria-label="Desenvolupament web en entorn de Servidor" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    Desenvolupament web en entorn de Servidor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inicio
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="01arquitecturas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.- Arquitectures Web
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="02php.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.- Programació web amb PHP
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="03MVC_Laravel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3.- Arquitectura MVC amb Laravel
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="04dades_Laravel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4.- Accés segur i estructurat a bases de dades amb Laravel
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="05seguretat_Laravel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5.- Aplicacions segures i reactives en Laravel
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="06Rest_Laravel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6a.- Desenvolupament d'APIs REST amb Laravel
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="06Nodejs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6b.- Desenvolupament d'APIs REST amb Node.js
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="07webs_hibrides.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7.- Webs hibrides
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="laravel-avancat">Laravel Avançat<a class="headerlink" href="#laravel-avancat" title="Permanent link">&para;</a></h1>
<h2 id="autenticacio-i-autoritzacio-amb-laravel">Autenticació i Autorització amb Laravel<a class="headerlink" href="#autenticacio-i-autoritzacio-amb-laravel" title="Permanent link">&para;</a></h2>
<h3 id="1-autenticacio">1. Autenticació<a class="headerlink" href="#1-autenticacio" title="Permanent link">&para;</a></h3>
<h4 id="11-configuracio-inicial">1.1 Configuració inicial<a class="headerlink" href="#11-configuracio-inicial" title="Permanent link">&para;</a></h4>
<p>Laravel ofereix dos paquets principals per implementar l’autenticació:</p>
<ol>
<li><strong>Laravel Breeze</strong>: Simple i lleuger, ideal per a projectes educatius i senzills.</li>
<li><strong>Laravel Jetstream</strong>: Robust i complet, inclou funcionalitats avançades com equips, autenticació de dos factors i gestió d'API.</li>
</ol>
<p><strong>Instal·lació de Laravel Breeze</strong>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer<span class="w"> </span>require<span class="w"> </span>laravel/breeze<span class="w"> </span>--dev
<span class="linenos" data-linenos="2 "></span>php<span class="w"> </span>artisan<span class="w"> </span>breeze:install
<span class="linenos" data-linenos="3 "></span>npm<span class="w"> </span>install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>dev
<span class="linenos" data-linenos="4 "></span>php<span class="w"> </span>artisan<span class="w"> </span>migrate
</code></pre></div></p>
<p>Aquestes ordres configuren:</p>
<ul>
<li>Rutes per login, registre, restabliment de contrasenya, etc.</li>
<li>Plantilles Blade predefinides amb Tailwind CSS.</li>
</ul>
<h4 id="12-recuperacio-de-lusuari-autenticat">1.2 Recuperació de l'usuari autenticat<a class="headerlink" href="#12-recuperacio-de-lusuari-autenticat" title="Permanent link">&para;</a></h4>
<p>Un cop l'usuari ha fet login, podem accedir a les seues dades:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">use Illuminate\Support\Facades\Auth;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="x">// Usuari autenticat</span>
<span class="linenos" data-linenos="4 "></span><span class="x">$user = Auth::user();</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="x">// ID de l&#39;usuari autenticat</span>
<span class="linenos" data-linenos="7 "></span><span class="x">$id = Auth::id();</span>
</code></pre></div></p>
<p>També podem obtenir l’usuari des d'una petició injectada al controlador:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function dashboard(Request $request)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $user = $request-&gt;user(); // Equivalent a Auth::user()</span>
<span class="linenos" data-linenos="4 "></span><span class="x">}</span>
</code></pre></div></p>
<h4 id="13-protegir-rutes-amb-middleware">1.3 Protegir rutes amb middleware<a class="headerlink" href="#13-protegir-rutes-amb-middleware" title="Permanent link">&para;</a></h4>
<p>El middleware <code>auth</code> assegura que només els usuaris autenticats poden accedir a una ruta:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Route::get(&#39;/dashboard&#39;, function () {</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    return view(&#39;dashboard&#39;);</span>
<span class="linenos" data-linenos="3 "></span><span class="x">})-&gt;middleware(&#39;auth&#39;);</span>
</code></pre></div></p>
<h4 id="14-logout">1.4 Logout<a class="headerlink" href="#14-logout" title="Permanent link">&para;</a></h4>
<p>Laravel Breeze inclou logout preconfigurat:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&lt;form method=&quot;POST&quot; action=&quot;{{ route(&#39;logout&#39;) }}&quot;&gt;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    @csrf</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &lt;button type=&quot;submit&quot;&gt;Logout&lt;/button&gt;</span>
<span class="linenos" data-linenos="4 "></span><span class="x">&lt;/form&gt;</span>
</code></pre></div></p>
<h4 id="15-restabliment-de-contrasenya">1.5 Restabliment de contrasenya<a class="headerlink" href="#15-restabliment-de-contrasenya" title="Permanent link">&para;</a></h4>
<p>Per habilitar el restabliment de contrasenya:</p>
<ol>
<li>Configura el correu SMTP al fitxer <code>.env</code>.</li>
<li>Laravel Breeze genera automàticament els formularis i la lògica necessària.</li>
</ol>
<h3 id="2-autoritzacio">2. Autorització<a class="headerlink" href="#2-autoritzacio" title="Permanent link">&para;</a></h3>
<h4 id="21-rols-i-permisos">2.1 Rols i permisos<a class="headerlink" href="#21-rols-i-permisos" title="Permanent link">&para;</a></h4>
<p><strong>Afegir un camp <code>role</code> a la taula <code>users</code></strong><br />
Per implementar rols:
1. Crear una migració:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:migration<span class="w"> </span>add_role_to_users_table<span class="w"> </span>--table<span class="o">=</span>users
</code></pre></div>
2. Afegir el camp <code>role</code>:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Schema::table(&#39;users&#39;, function (Blueprint $table) {</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    $table-&gt;string(&#39;role&#39;)-&gt;default(&#39;user&#39;); // Opcions: &#39;user&#39;, &#39;admin&#39;, etc.</span>
<span class="linenos" data-linenos="3 "></span><span class="x">});</span>
</code></pre></div>
3. Actualitzar el model <code>User</code>:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">class User extends Authenticatable</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    protected $fillable = [&#39;name&#39;, &#39;email&#39;, &#39;password&#39;, &#39;role&#39;];</span>
<span class="linenos" data-linenos="4 "></span><span class="x">}</span>
</code></pre></div></p>
<p><strong>Middleware per a rols</strong>
1. Crear un middleware:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:middleware<span class="w"> </span>RoleMiddleware
</code></pre></div>
2. Definir el rol al middleware:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function handle($request, Closure $next, $role)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    if (Auth::check() &amp;&amp; Auth::user()-&gt;role === $role) {</span>
<span class="linenos" data-linenos="4 "></span><span class="x">        return $next($request);</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    return redirect(&#39;/&#39;);</span>
<span class="linenos" data-linenos="7 "></span><span class="x">}</span>
</code></pre></div>
3. Registrar-lo a <code>Kernel.php</code>:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">protected $routeMiddleware = [</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    &#39;role&#39; =&gt; \App\Http\Middleware\RoleMiddleware::class,</span>
<span class="linenos" data-linenos="3 "></span><span class="x">];</span>
</code></pre></div>
4. Aplicar-lo a una ruta:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Route::get(&#39;/admin&#39;, function () {</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    return view(&#39;admin.dashboard&#39;);</span>
<span class="linenos" data-linenos="3 "></span><span class="x">})-&gt;middleware(&#39;role:admin&#39;);</span>
</code></pre></div></p>
<h4 id="que-es-un-middleware">Què és un Middleware?<a class="headerlink" href="#que-es-un-middleware" title="Permanent link">&para;</a></h4>
<p>Un <strong>middleware</strong> és una classe que actua com a intermediari entre una sol·licitud HTTP i la seua resposta. En Laravel, els middleware s'utilitzen per executar codi abans o després que una sol·licitud arribe al controlador, permetent així gestionar tasques com:
- Autenticació d'usuaris.
- Validació de permisos o rols.
- Filtratge de dades de la petició.
- Modificació de respostes.</p>
<p>Els middleware són ideals per encapsular lògica comuna que cal aplicar a diverses rutes, com per exemple assegurar que només usuaris autenticats poden accedir a certes àrees de l'aplicació.</p>
<p>Exemple d'ús:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function handle($request, Closure $next)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    if (Auth::check()) {</span>
<span class="linenos" data-linenos="4 "></span><span class="x">        return $next($request); // Continua amb la sol·licitud</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    return redirect(&#39;login&#39;); // Redirigeix si no està autenticat</span>
<span class="linenos" data-linenos="7 "></span><span class="x">}</span>
</code></pre></div></p>
<p>Els middleware es registren al fitxer <code>Kernel.php</code>, i poden aplicar-se a rutes específiques o a tot l'aplicatiu.</p>
<h4 id="22-policies-per-a-acces-granular">2.2 Policies per a accés granular<a class="headerlink" href="#22-policies-per-a-acces-granular" title="Permanent link">&para;</a></h4>
<p><strong>Creació d'una Policy</strong>  </p>
<p>Les policies permeten definir regles d'autorització específiques:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:policy<span class="w"> </span>PostPolicy<span class="w"> </span>--model<span class="o">=</span>Post
</code></pre></div>
<p>Exemple per permetre que un usuari només puga editar els seus posts:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function update(User $user, Post $post)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    return $user-&gt;id === $post-&gt;user_id;</span>
<span class="linenos" data-linenos="4 "></span><span class="x">}</span>
</code></pre></div>
Registrar la política a <code>AuthServiceProvider</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">protected $policies = [</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    Post::class =&gt; PostPolicy::class,</span>
<span class="linenos" data-linenos="3 "></span><span class="x">];</span>
</code></pre></div></p>
<p>Ús de la política en un controlador:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function edit(Post $post)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $this-&gt;authorize(&#39;update&#39;, $post);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    return view(&#39;posts.edit&#39;, compact(&#39;post&#39;));</span>
<span class="linenos" data-linenos="5 "></span><span class="x">}</span>
</code></pre></div></p>
<h3 id="3utilitzar-form-requests-per-a-validacions-mes-complexes">3.Utilitzar Form Requests per a Validacions més Complexes<a class="headerlink" href="#3utilitzar-form-requests-per-a-validacions-mes-complexes" title="Permanent link">&para;</a></h3>
<p>Els <strong>Form Requests</strong> són classes dedicades que encapsulen la lògica de validació d'una sol·licitud HTTP. Aquestes classes permeten organitzar millor el codi, especialment en formularis amb moltes regles de validació.</p>
<h4 id="1-crear-un-form-request">1. Crear un Form Request<a class="headerlink" href="#1-crear-un-form-request" title="Permanent link">&para;</a></h4>
<p>Per crear un <strong>Form Request</strong>, utilitzem l'eina Artisan:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:request<span class="w"> </span>MoviePost
</code></pre></div>
Això genera una nova classe a la carpeta <code>app/Http/Requests</code>. Aquesta classe conté dos mètodes principals:</p>
<ol>
<li>
<p><strong>authorize()</strong><br />
   Retorna <code>true</code> o <code>false</code> segons si l'usuari està autoritzat a fer la sol·licitud. Per defecte, podem retornar <code>true</code> per permetre totes les sol·licituds:
    <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function authorize()</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    return true;</span>
<span class="linenos" data-linenos="4 "></span><span class="x">}</span>
</code></pre></div></p>
</li>
<li>
<p><strong>rules()</strong><br />
   Retorna un array amb les regles de validació:
    <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function rules()</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    return [</span>
<span class="linenos" data-linenos="4 "></span><span class="x">        &#39;title&#39; =&gt; &#39;required|min:3&#39;,</span>
<span class="linenos" data-linenos="5 "></span><span class="x">        &#39;director&#39; =&gt; &#39;required&#39;,</span>
<span class="linenos" data-linenos="6 "></span><span class="x">        &#39;year&#39; =&gt; &#39;required|numeric|min:1900&#39;,</span>
<span class="linenos" data-linenos="7 "></span><span class="x">    ];</span>
<span class="linenos" data-linenos="8 "></span><span class="x">}</span>
</code></pre></div></p>
</li>
</ol>
<h4 id="2-utilitzar-el-form-request-en-un-controlador">2. Utilitzar el Form Request en un Controlador<a class="headerlink" href="#2-utilitzar-el-form-request-en-un-controlador" title="Permanent link">&para;</a></h4>
<p>En lloc d'especificar les regles de validació directament al controlador, podem injectar el <strong>Form Request</strong> al mètode del controlador:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">public function store(MoviePost $request)</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">    // Si arribem aquí, les dades són vàlides.</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">    // Accedim a les dades validades:</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    $validated = $request-&gt;validated();</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    // Crear una nova pel·lícula</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    $movie = new Movie($validated);</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    $movie-&gt;save();</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="x">    return redirect()-&gt;route(&#39;movies.index&#39;);</span>
<span class="linenos" data-linenos="12 "></span><span class="x">}</span>
</code></pre></div>
El mètode <code>validated()</code> retorna només les dades que han passat les regles de validació.</p>
<h4 id="3-personalitzar-missatges-derror">3. Personalitzar Missatges d'Error<a class="headerlink" href="#3-personalitzar-missatges-derror" title="Permanent link">&para;</a></h4>
<p>Podem personalitzar els missatges d'error sobreescrivint el mètode <strong>messages()</strong> dins del Form Request:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function messages()</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    return [</span>
<span class="linenos" data-linenos="4 "></span><span class="x">        &#39;title.required&#39; =&gt; &#39;El camp títol és obligatori.&#39;,</span>
<span class="linenos" data-linenos="5 "></span><span class="x">        &#39;title.min&#39; =&gt; &#39;El camp títol ha de tindre almenys 3 caràcters.&#39;,</span>
<span class="linenos" data-linenos="6 "></span><span class="x">        &#39;year.required&#39; =&gt; &#39;El camp any és obligatori.&#39;,</span>
<span class="linenos" data-linenos="7 "></span><span class="x">    ];</span>
<span class="linenos" data-linenos="8 "></span><span class="x">}</span>
</code></pre></div></p>
<h4 id="4-mostrar-errors-de-validacio-a-la-vista">4. Mostrar Errors de Validació a la Vista<a class="headerlink" href="#4-mostrar-errors-de-validacio-a-la-vista" title="Permanent link">&para;</a></h4>
<p>Quan es produeixen errors de validació, Laravel redirigeix automàticament a la vista anterior amb la variable global <code>$errors</code>, que conté els errors de validació.</p>
<p>Exemple de com mostrar un llistat d'errors al començament del formulari:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">@if ($errors-&gt;any())</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    &lt;ul&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="x">        @foreach($errors-&gt;all() as $error)</span>
<span class="linenos" data-linenos="4 "></span><span class="x">            &lt;li&gt;{{ $error }}&lt;/li&gt;</span>
<span class="linenos" data-linenos="5 "></span><span class="x">        @endforeach</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    &lt;/ul&gt;</span>
<span class="linenos" data-linenos="7 "></span><span class="x">@endif</span>
</code></pre></div></p>
<p>Per mostrar errors específics sota un camp:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&lt;div class=&quot;form-group&quot;&gt;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    &lt;label for=&quot;title&quot;&gt;Títol:&lt;/label&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &lt;input type=&quot;text&quot; name=&quot;title&quot; id=&quot;title&quot; class=&quot;form-control&quot; value=&quot;{{ old(&#39;title&#39;) }}&quot;&gt;</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    @if ($errors-&gt;has(&#39;title&#39;))</span>
<span class="linenos" data-linenos="5 "></span><span class="x">        &lt;div class=&quot;text-danger&quot;&gt;{{ $errors-&gt;first(&#39;title&#39;) }}&lt;/div&gt;</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    @endif</span>
<span class="linenos" data-linenos="7 "></span><span class="x">&lt;/div&gt;</span>
</code></pre></div></p>
<h2 id="us-didiomes-en-laravel">Ús d'idiomes en Laravel<a class="headerlink" href="#us-didiomes-en-laravel" title="Permanent link">&para;</a></h2>
<p>Laravel proporciona eines senzilles i potents per a la <strong>localització d'aplicacions</strong>, permetent suportar múltiples idiomes. Aquesta funcionalitat és ideal per a desenvolupar aplicacions accessibles a usuaris de diferents regions i llengües.</p>
<h3 id="1-configuracio-inicial">1. Configuració Inicial<a class="headerlink" href="#1-configuracio-inicial" title="Permanent link">&para;</a></h3>
<h4 id="11-idioma-predeterminat">1.1 Idioma Predeterminat<a class="headerlink" href="#11-idioma-predeterminat" title="Permanent link">&para;</a></h4>
<p>L'idioma predeterminat s'estableix al fitxer <code>config/app.php</code> mitjançant el paràmetre <code>locale</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&#39;locale&#39; =&gt; &#39;en&#39;, // Idioma predeterminat</span>
</code></pre></div></p>
<h4 id="12-idioma-alternatiu">1.2 Idioma Alternatiu<a class="headerlink" href="#12-idioma-alternatiu" title="Permanent link">&para;</a></h4>
<p>Es pot definir un idioma "alternatiu" que s'utilitzarà quan no es troben traduccions en l'idioma actiu:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&#39;fallback_locale&#39; =&gt; &#39;en&#39;, // Idioma alternatiu</span>
</code></pre></div></p>
<h3 id="2-treballant-amb-fitxers-de-traduccio">2. Treballant amb Fitxers de Traducció<a class="headerlink" href="#2-treballant-amb-fitxers-de-traduccio" title="Permanent link">&para;</a></h3>
<h4 id="21-organitzacio-dels-fitxers">2.1 Organització dels Fitxers<a class="headerlink" href="#21-organitzacio-dels-fitxers" title="Permanent link">&para;</a></h4>
<p>Els fitxers de traducció es guarden al directori <code>lang</code>. Cada idioma té la seua pròpia carpeta, amb fitxers <code>.php</code> que contenen arrays clau-valor per a les traduccions:</p>
<p><strong>Exemple d'estructura:</strong>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>/lang
<span class="linenos" data-linenos="2 "></span>    /en
<span class="linenos" data-linenos="3 "></span>        messages.php
<span class="linenos" data-linenos="4 "></span>    /es
<span class="linenos" data-linenos="5 "></span>        messages.php
</code></pre></div></p>
<h4 id="22-crear-un-fitxer-de-traduccio">2.2 Crear un Fitxer de Traducció<a class="headerlink" href="#22-crear-un-fitxer-de-traduccio" title="Permanent link">&para;</a></h4>
<p>Un fitxer de traducció típic conté un array de cadenes:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// lang/en/messages.php</span>
<span class="linenos" data-linenos="2 "></span><span class="x">return [</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &#39;welcome&#39; =&gt; &#39;Welcome to our application!&#39;,</span>
<span class="linenos" data-linenos="4 "></span><span class="x">];</span>
</code></pre></div></p>
<p>Per a altres idiomes:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// lang/es/messages.php</span>
<span class="linenos" data-linenos="2 "></span><span class="x">return [</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &#39;welcome&#39; =&gt; &#39;¡Bienvenido a nuestra aplicación!&#39;,</span>
<span class="linenos" data-linenos="4 "></span><span class="x">];</span>
</code></pre></div></p>
<hr />
<h3 id="3-us-de-traduccions-en-el-codi">3. Ús de Traduccions en el Codi<a class="headerlink" href="#3-us-de-traduccions-en-el-codi" title="Permanent link">&para;</a></h3>
<h4 id="31-recuperar-traduccions">3.1 Recuperar Traduccions<a class="headerlink" href="#31-recuperar-traduccions" title="Permanent link">&para;</a></h4>
<p>Utilitza la funció auxiliar <code>__()</code> per obtenir les traduccions:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">echo __(&#39;messages.welcome&#39;); // Welcome to our application!</span>
</code></pre></div></p>
<p>Si la traducció no existeix, es retorna la clau proporcionada:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">echo __(&#39;messages.unknown&#39;); // messages.unknown</span>
</code></pre></div></p>
<h4 id="32-traduccions-amb-parametres">3.2 Traduccions amb Paràmetres<a class="headerlink" href="#32-traduccions-amb-parametres" title="Permanent link">&para;</a></h4>
<p>És possible definir paràmetres dins de les traduccions utilitzant el símbol <code>:</code>, que es substitueix quan es crida a la funció:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// lang/en/messages.php</span>
<span class="linenos" data-linenos="2 "></span><span class="x">return [</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &#39;greeting&#39; =&gt; &#39;Hello, :name!&#39;,</span>
<span class="linenos" data-linenos="4 "></span><span class="x">];</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">echo __(&#39;messages.greeting&#39;, [&#39;name&#39; =&gt; &#39;John&#39;]); // Hello, John!</span>
</code></pre></div></p>
<hr />
<h3 id="4-localitzacio-en-temps-dexecucio">4. Localització en Temps d'Execució<a class="headerlink" href="#4-localitzacio-en-temps-dexecucio" title="Permanent link">&para;</a></h3>
<h4 id="41-canviar-lidioma-actiu">4.1 Canviar l'Idioma Actiu<a class="headerlink" href="#41-canviar-lidioma-actiu" title="Permanent link">&para;</a></h4>
<p>Per canviar l'idioma de l'aplicació en temps d'execució, utilitza el mètode <code>App::setLocale()</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">use Illuminate\Support\Facades\App;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="x">App::setLocale(&#39;es&#39;); // Canvia a espanyol</span>
</code></pre></div></p>
<p>Aquesta configuració només afecta la petició actual.</p>
<h3 id="5-traduccions-amb-fitxers-json">5. Traduccions amb Fitxers JSON<a class="headerlink" href="#5-traduccions-amb-fitxers-json" title="Permanent link">&para;</a></h3>
<p>Laravel permet utilitzar fitxers JSON per a traduccions simples. Aquest enfocament és útil per a aplicacions amb cadenes de traducció úniques i desordenades.</p>
<p><strong>Exemple de Fitxer JSON:</strong>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">// lang/es.json</span>
<span class="linenos" data-linenos="2 "></span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="nt">&quot;I love programming.&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Me encanta programar.&quot;</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
</code></pre></div></p>
<p>Per accedir a aquestes cadenes:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">echo __(&#39;I love programming.&#39;);</span>
</code></pre></div></p>
<h2 id="enviament-de-correus-en-laravel">Enviament de Correus en Laravel<a class="headerlink" href="#enviament-de-correus-en-laravel" title="Permanent link">&para;</a></h2>
<p>Laravel ofereix una API senzilla i flexible per gestionar l'enviament de correus electrònics. Aquesta funcionalitat és útil per a notificacions, restabliment de contrasenyes i altres comunicacions amb els usuaris.</p>
<hr />
<h3 id="1-configuracio-inicial_1">1. Configuració Inicial<a class="headerlink" href="#1-configuracio-inicial_1" title="Permanent link">&para;</a></h3>
<h4 id="11-configurar-el-servei-de-correu">1.1 Configurar el Servei de Correu<a class="headerlink" href="#11-configurar-el-servei-de-correu" title="Permanent link">&para;</a></h4>
<p>Laravel suporta múltiples serveis d'enviament de correu com SMTP, Mailgun, Postmark, Amazon SES, entre altres. La configuració es defineix al fitxer <code>.env</code>:</p>
<p><strong>Exemple de configuració SMTP per Gmail:</strong>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>MAIL_MAILER=smtp
<span class="linenos" data-linenos="2 "></span>MAIL_HOST=smtp.gmail.com
<span class="linenos" data-linenos="3 "></span>MAIL_PORT=587
<span class="linenos" data-linenos="4 "></span>MAIL_USERNAME=el_teu_email@gmail.com
<span class="linenos" data-linenos="5 "></span>MAIL_PASSWORD=la_teua_contrasenya
<span class="linenos" data-linenos="6 "></span>MAIL_ENCRYPTION=tls
<span class="linenos" data-linenos="7 "></span>MAIL_FROM_ADDRESS=el_teu_email@gmail.com
<span class="linenos" data-linenos="8 "></span>MAIL_FROM_NAME=&quot;Nom del Projecte&quot;
</code></pre></div></p>
<h4 id="12-configurar-el-fitxer-configmailphp">1.2 Configurar el Fitxer <code>config/mail.php</code><a class="headerlink" href="#12-configurar-el-fitxer-configmailphp" title="Permanent link">&para;</a></h4>
<p>Aquest fitxer conté la configuració global per al sistema de correu. Normalment, no és necessari modificar-lo si es configura correctament el <code>.env</code>.</p>
<hr />
<h3 id="2-crear-correus">2. Crear Correus<a class="headerlink" href="#2-crear-correus" title="Permanent link">&para;</a></h3>
<h4 id="21-crear-una-classe-de-correu">2.1 Crear una Classe de Correu<a class="headerlink" href="#21-crear-una-classe-de-correu" title="Permanent link">&para;</a></h4>
<p>Les classes de correu es generen amb Artisan:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:mail<span class="w"> </span>WelcomeMail
</code></pre></div></p>
<p>Aquest comandament crea una classe al directori <code>App\Mail</code>. Aquesta classe és on es defineix el contingut i el disseny del correu.</p>
<h4 id="22-exemple-duna-classe-de-correu">2.2 Exemple d'una Classe de Correu<a class="headerlink" href="#22-exemple-duna-classe-de-correu" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Mail;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Illuminate\Bus\Queueable;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Illuminate\Mail\Mailable;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">use Illuminate\Queue\SerializesModels;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">class WelcomeMail extends Mailable</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    use Queueable, SerializesModels;</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="x">    public $user;</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="x">    public function __construct($user)</span>
<span class="linenos" data-linenos="14 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="15 "></span><span class="x">        $this-&gt;user = $user;</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="x">    public function build()</span>
<span class="linenos" data-linenos="19 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="20 "></span><span class="x">        return $this-&gt;view(&#39;emails.welcome&#39;)</span>
<span class="linenos" data-linenos="21 "></span><span class="x">                    -&gt;subject(&#39;Benvingut a la nostra aplicació&#39;);</span>
<span class="linenos" data-linenos="22 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="23 "></span><span class="x">}</span>
</code></pre></div>
<h3 id="3-enviar-correus">3. Enviar Correus<a class="headerlink" href="#3-enviar-correus" title="Permanent link">&para;</a></h3>
<h4 id="31-enviar-un-correu-des-dun-controlador">3.1 Enviar un Correu des d'un Controlador<a class="headerlink" href="#31-enviar-un-correu-des-dun-controlador" title="Permanent link">&para;</a></h4>
<p>Utilitza la façana <code>Mail</code> per enviar correus:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">use App\Mail\WelcomeMail;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">use Illuminate\Support\Facades\Mail;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="x">Mail::to(&#39;usuari@example.com&#39;)-&gt;send(new WelcomeMail($user));</span>
</code></pre></div></p>
<h4 id="32-enviar-a-multiples-receptors">3.2 Enviar a Múltiples Receptors<a class="headerlink" href="#32-enviar-a-multiples-receptors" title="Permanent link">&para;</a></h4>
<p>Laravel permet enviar correus a múltiples destinataris:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Mail::to([&#39;user1@example.com&#39;, &#39;user2@example.com&#39;])-&gt;send(new WelcomeMail($user));</span>
</code></pre></div></p>
<h3 id="4-plantilles-de-correus">4. Plantilles de Correus<a class="headerlink" href="#4-plantilles-de-correus" title="Permanent link">&para;</a></h3>
<h4 id="41-crear-una-vista-per-al-correu">4.1 Crear una Vista per al Correu<a class="headerlink" href="#41-crear-una-vista-per-al-correu" title="Permanent link">&para;</a></h4>
<p>Les vistes per a correus es guarden al directori <code>resources/views/emails</code>. Exemple de plantilla Blade:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Benvingut<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hola, {{ $user-&gt;name }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Gràcies per registrar-te a la nostra aplicació!<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="10 "></span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></p>
<h4 id="42-utilitzar-components-i-markdown">4.2 Utilitzar Components i Markdown<a class="headerlink" href="#42-utilitzar-components-i-markdown" title="Permanent link">&para;</a></h4>
<p>Laravel permet crear correus amb components de Markdown. Generem un correu amb components:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:mail<span class="w"> </span>WelcomeMail<span class="w"> </span>--markdown<span class="o">=</span>emails.welcome
</code></pre></div></p>
<p>Aquest comandament crea una plantilla Markdown a <code>resources/views/emails</code>.</p>
<p>Exemple de plantilla Markdown:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="gh"># Benvingut, {{ $user-&gt;name }}</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>Gràcies per unir-te a la nostra aplicació.
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="ni">@component</span>(&#39;mail::button&#39;, [&#39;url&#39; =&gt; &#39;https://example.com&#39;])
<span class="linenos" data-linenos=" 6 "></span>Visita el nostre lloc web
<span class="linenos" data-linenos=" 7 "></span><span class="ni">@endcomponent</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>Gràcies,&lt;br&gt;
<span class="linenos" data-linenos="10 "></span>{{ config(&#39;app.name&#39;) }}
</code></pre></div></p>
<h3 id="5-correu-en-cua">5. Correu en Cua<a class="headerlink" href="#5-correu-en-cua" title="Permanent link">&para;</a></h3>
<p>Per enviar correus de manera asíncrona i millorar el rendiment de l'aplicació, podem utilitzar cues:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Mail::to(&#39;usuari@example.com&#39;)-&gt;queue(new WelcomeMail($user));</span>
</code></pre></div></p>
<p>Assegura't que el sistema de cues estiga configurat al fitxer <code>.env</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>QUEUE_CONNECTION=database
</code></pre></div></p>
<h2 id="sistema-de-fitxers-en-laravel">Sistema de Fitxers en Laravel<a class="headerlink" href="#sistema-de-fitxers-en-laravel" title="Permanent link">&para;</a></h2>
<p>Laravel proporciona una API unificada per treballar amb diferents sistemes de fitxers com el sistema local, Amazon S3, FTP, i altres. Aquesta funcionalitat permet gestionar l'emmagatzematge de fitxers d'una manera senzilla i flexible.</p>
<h3 id="1-configuracio-inicial_2">1. Configuració Inicial<a class="headerlink" href="#1-configuracio-inicial_2" title="Permanent link">&para;</a></h3>
<h4 id="11-configurar-els-discs-demmagatzematge">1.1 Configurar els Discs d'Emmagatzematge<a class="headerlink" href="#11-configurar-els-discs-demmagatzematge" title="Permanent link">&para;</a></h4>
<p>Els discos d'emmagatzematge es defineixen al fitxer <code>config/filesystems.php</code>. Per defecte, Laravel inclou els següents discos:
- <strong>local</strong>: Emmagatzematge en el sistema local.
- <strong>public</strong>: Per fitxers públics accessibles des d'un navegador.
- <strong>s3</strong>: Per emmagatzematge a Amazon S3.</p>
<h4 id="12-configuracio-del-env">1.2 Configuració del <code>.env</code><a class="headerlink" href="#12-configuracio-del-env" title="Permanent link">&para;</a></h4>
<p>Exemple de configuració:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>FILESYSTEM_DISK=local
<span class="linenos" data-linenos="2 "></span>AWS_ACCESS_KEY_ID=el_teu_access_key
<span class="linenos" data-linenos="3 "></span>AWS_SECRET_ACCESS_KEY=el_teu_secret_key
<span class="linenos" data-linenos="4 "></span>AWS_DEFAULT_REGION=us-east-1
<span class="linenos" data-linenos="5 "></span>AWS_BUCKET=el_teu_bucket
</code></pre></div></p>
<h3 id="2-treballar-amb-el-sistema-de-fitxers">2. Treballar amb el Sistema de Fitxers<a class="headerlink" href="#2-treballar-amb-el-sistema-de-fitxers" title="Permanent link">&para;</a></h3>
<h4 id="21-accedir-a-un-disc">2.1 Accedir a un Disc<a class="headerlink" href="#21-accedir-a-un-disc" title="Permanent link">&para;</a></h4>
<p>Utilitza la façana <code>Storage</code> per accedir al sistema de fitxers:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">use Illuminate\Support\Facades\Storage;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="x">$disk = Storage::disk(&#39;local&#39;); // Accedir al disc local</span>
</code></pre></div></p>
<p>Si no especifiques cap disc, Laravel utilitza el disc predeterminat (<code>FILESYSTEM_DISK</code> al <code>.env</code>).</p>
<h3 id="3-operacions-basiques-amb-fitxers">3. Operacions Bàsiques amb Fitxers<a class="headerlink" href="#3-operacions-basiques-amb-fitxers" title="Permanent link">&para;</a></h3>
<h4 id="31-guardar-fitxers">3.1 Guardar Fitxers<a class="headerlink" href="#31-guardar-fitxers" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">use Illuminate\Support\Facades\Storage;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">// Guardar un fitxer amb contingut</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">Storage::put(&#39;documents/file.txt&#39;, &#39;Contingut del fitxer&#39;);</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">// Guardar un fitxer pujat</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">$file = $request-&gt;file(&#39;document&#39;);</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">Storage::putFile(&#39;uploads&#39;, $file);</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="x">// Guardar amb un nom personalitzat</span>
<span class="linenos" data-linenos="11 "></span><span class="x">Storage::putFileAs(&#39;uploads&#39;, $file, &#39;custom_name.txt&#39;);</span>
</code></pre></div>
<h4 id="32-obtenir-fitxers">3.2 Obtenir Fitxers<a class="headerlink" href="#32-obtenir-fitxers" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// Obtenir el contingut d&#39;un fitxer</span>
<span class="linenos" data-linenos="2 "></span><span class="x">$content = Storage::get(&#39;documents/file.txt&#39;);</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="x">// Verificar si un fitxer existeix</span>
<span class="linenos" data-linenos="5 "></span><span class="x">if (Storage::exists(&#39;documents/file.txt&#39;)) {</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    // Fitxer existeix</span>
<span class="linenos" data-linenos="7 "></span><span class="x">}</span>
</code></pre></div>
<h4 id="33-eliminar-fitxers">3.3 Eliminar Fitxers<a class="headerlink" href="#33-eliminar-fitxers" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// Eliminar un fitxer</span>
<span class="linenos" data-linenos="2 "></span><span class="x">Storage::delete(&#39;documents/file.txt&#39;);</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="x">// Eliminar múltiples fitxers</span>
<span class="linenos" data-linenos="5 "></span><span class="x">Storage::delete([&#39;file1.txt&#39;, &#39;file2.txt&#39;]);</span>
</code></pre></div>
<h4 id="34-llistar-fitxers">3.4 Llistar Fitxers<a class="headerlink" href="#34-llistar-fitxers" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">// Llistar tots els fitxers d&#39;un directori</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">$files = Storage::files(&#39;documents&#39;);</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">// Llistar fitxers recursivament</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">$allFiles = Storage::allFiles(&#39;documents&#39;);</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">// Llistar carpetes</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">$directories = Storage::directories(&#39;documents&#39;);</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="x">// Llistar carpetes recursivament</span>
<span class="linenos" data-linenos="11 "></span><span class="x">$allDirectories = Storage::allDirectories(&#39;documents&#39;);</span>
</code></pre></div>
<h3 id="4-fitxers-publics">4. Fitxers Públics<a class="headerlink" href="#4-fitxers-publics" title="Permanent link">&para;</a></h3>
<h4 id="41-publicar-fitxers">4.1 Publicar Fitxers<a class="headerlink" href="#41-publicar-fitxers" title="Permanent link">&para;</a></h4>
<p>Per fer fitxers accessibles públicament, utilitza el disc <code>public</code>. Assegura't de crear un enllaç simbòlic per al directori <code>storage/app/public</code> al directori <code>public/storage</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>storage:link
</code></pre></div></p>
<h4 id="42-obtenir-una-url-publica">4.2 Obtenir una URL Pública<a class="headerlink" href="#42-obtenir-una-url-publica" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$url = Storage::url(&#39;documents/file.txt&#39;); // Genera una URL pública</span>
</code></pre></div>
<h3 id="5-treballar-amb-amazon-s3">5. Treballar amb Amazon S3<a class="headerlink" href="#5-treballar-amb-amazon-s3" title="Permanent link">&para;</a></h3>
<h4 id="51-configuracio">5.1 Configuració<a class="headerlink" href="#51-configuracio" title="Permanent link">&para;</a></h4>
<p>Inclou les credencials d'Amazon S3 al fitxer <code>.env</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>AWS_ACCESS_KEY_ID=el_teu_access_key
<span class="linenos" data-linenos="2 "></span>AWS_SECRET_ACCESS_KEY=el_teu_secret_key
<span class="linenos" data-linenos="3 "></span>AWS_DEFAULT_REGION=us-east-1
<span class="linenos" data-linenos="4 "></span>AWS_BUCKET=el_teu_bucket
</code></pre></div></p>
<h4 id="52-exemple">5.2 Exemple<a class="headerlink" href="#52-exemple" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">use Illuminate\Support\Facades\Storage;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="x">// Guardar un fitxer a S3</span>
<span class="linenos" data-linenos="4 "></span><span class="x">Storage::disk(&#39;s3&#39;)-&gt;put(&#39;documents/file.txt&#39;, &#39;Contingut&#39;);</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="x">// Obtenir una URL</span>
<span class="linenos" data-linenos="7 "></span><span class="x">$url = Storage::disk(&#39;s3&#39;)-&gt;url(&#39;documents/file.txt&#39;);</span>
</code></pre></div>
<h2 id="gestio-de-sessions-en-laravel">Gestió de Sessions en Laravel<a class="headerlink" href="#gestio-de-sessions-en-laravel" title="Permanent link">&para;</a></h2>
<p>Laravel ofereix una API senzilla i segura per gestionar sessions d'usuari. Les sessions permeten emmagatzemar dades temporals associades a cada usuari mentre interactua amb l'aplicació.</p>
<h3 id="1-tipus-de-controladors-de-sessio">1. Tipus de Controladors de Sessió<a class="headerlink" href="#1-tipus-de-controladors-de-sessio" title="Permanent link">&para;</a></h3>
<p>Laravel suporta diversos tipus de controladors per gestionar sessions. Es defineixen al fitxer <code>config/session.php</code> amb el paràmetre <code>SESSION_DRIVER</code>.</p>
<h4 id="tipus-de-controladors">Tipus de Controladors<a class="headerlink" href="#tipus-de-controladors" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>file</strong>: Emmagatzema les dades en fitxers al servidor (predeterminat).</li>
<li><strong>cookie</strong>: Desa les dades en cookies xifrades al navegador.</li>
<li><strong>database</strong>: Desa les dades en una taula de base de dades.</li>
<li><strong>redis</strong>: Utilitza Redis per a una gestió ràpida i distribuïda.</li>
<li><strong>array</strong>: Desa les dades en memòria, només per a proves.</li>
</ul>
<p><strong>Configuració en el fitxer <code>.env</code>:</strong>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>SESSION_DRIVER=file
</code></pre></div></p>
<h3 id="2-configuracio-de-les-sessions">2. Configuració de les Sessions<a class="headerlink" href="#2-configuracio-de-les-sessions" title="Permanent link">&para;</a></h3>
<h4 id="opcions-clau-al-fitxer-configsessionphp">Opcions Clau al Fitxer <code>config/session.php</code><a class="headerlink" href="#opcions-clau-al-fitxer-configsessionphp" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>lifetime</strong>: Temps d'expiració de la sessió en minuts:
  <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&#39;lifetime&#39; =&gt; 120,</span>
</code></pre></div></li>
<li><strong>expire_on_close</strong>: Expira quan es tanca el navegador:
  <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&#39;expire_on_close&#39; =&gt; false,</span>
</code></pre></div></li>
<li><strong>encrypt</strong>: Si es volen xifrar les dades de sessió:
  <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&#39;encrypt&#39; =&gt; false,</span>
</code></pre></div></li>
</ul>
<hr />
<h3 id="3-us-de-sessions">3. Ús de Sessions<a class="headerlink" href="#3-us-de-sessions" title="Permanent link">&para;</a></h3>
<h4 id="31-afegir-dades-a-la-sessio">3.1 Afegir Dades a la Sessió<a class="headerlink" href="#31-afegir-dades-a-la-sessio" title="Permanent link">&para;</a></h4>
<p>Utilitza el mètode <code>put</code> per guardar dades:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">session([&#39;key&#39; =&gt; &#39;value&#39;]);</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="x">// Alternativa amb l&#39;helper:</span>
<span class="linenos" data-linenos="4 "></span><span class="x">Session::put(&#39;key&#39;, &#39;value&#39;);</span>
</code></pre></div></p>
<h4 id="32-obtenir-dades-de-la-sessio">3.2 Obtenir Dades de la Sessió<a class="headerlink" href="#32-obtenir-dades-de-la-sessio" title="Permanent link">&para;</a></h4>
<p>Utilitza el mètode <code>get</code> per recuperar dades:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$value = session(&#39;key&#39;, &#39;valor_per_defecte&#39;); // Helper</span>
<span class="linenos" data-linenos="2 "></span><span class="x">$value = Session::get(&#39;key&#39;, &#39;valor_per_defecte&#39;); // Façana</span>
</code></pre></div></p>
<h4 id="33-eliminar-dades-de-la-sessio">3.3 Eliminar Dades de la Sessió<a class="headerlink" href="#33-eliminar-dades-de-la-sessio" title="Permanent link">&para;</a></h4>
<p>Elimina una clau específica:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Session::forget(&#39;key&#39;);</span>
</code></pre></div></p>
<p>Elimina totes les dades de la sessió:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Session::flush();</span>
</code></pre></div></p>
<h3 id="4-sessio-flash">4. Sessió Flash<a class="headerlink" href="#4-sessio-flash" title="Permanent link">&para;</a></h3>
<p>Les dades flash només existeixen per a la següent petició HTTP. Són útils per missatges temporals com alertes d'èxit o errors.</p>
<h4 id="41-afegir-dades-flash">4.1 Afegir Dades Flash<a class="headerlink" href="#41-afegir-dades-flash" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Session::flash(&#39;status&#39;, &#39;La tasca s&#39;ha completat!&#39;);</span>
</code></pre></div>
<h4 id="42-recuperar-dades-flash">4.2 Recuperar Dades Flash<a class="headerlink" href="#42-recuperar-dades-flash" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$value = Session::get(&#39;status&#39;);</span>
</code></pre></div>
<h3 id="5-sessio-basada-en-base-de-dades">5. Sessió Basada en Base de Dades<a class="headerlink" href="#5-sessio-basada-en-base-de-dades" title="Permanent link">&para;</a></h3>
<h4 id="51-crear-la-taula-de-sessio">5.1 Crear la Taula de Sessió<a class="headerlink" href="#51-crear-la-taula-de-sessio" title="Permanent link">&para;</a></h4>
<p>Per utilitzar el controlador <code>database</code>, primer cal crear una taula de base de dades amb el comandament Artisan:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>session:table
<span class="linenos" data-linenos="2 "></span>php<span class="w"> </span>artisan<span class="w"> </span>migrate
</code></pre></div></p>
<p>Això crea una taula anomenada <code>sessions</code> amb els camps necessaris.</p>
<h4 id="52-configurar-el-driver">5.2 Configurar el Driver<a class="headerlink" href="#52-configurar-el-driver" title="Permanent link">&para;</a></h4>
<p>Al fitxer <code>.env</code>, estableix:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>SESSION_DRIVER=database
</code></pre></div></p>
<h2 id="testing-en-laravel">Testing en Laravel<a class="headerlink" href="#testing-en-laravel" title="Permanent link">&para;</a></h2>
<p>Laravel proporciona un ecosistema complet per realitzar proves en les aplicacions. Les proves són essencials per assegurar que el codi funciona correctament i evitar regressions.</p>
<hr />
<h3 id="1-tipus-de-proves-en-laravel">1. Tipus de Proves en Laravel<a class="headerlink" href="#1-tipus-de-proves-en-laravel" title="Permanent link">&para;</a></h3>
<h4 id="11-proves-unitaries">1.1 Proves Unitàries<a class="headerlink" href="#11-proves-unitaries" title="Permanent link">&para;</a></h4>
<p>Les proves unitàries validen la funcionalitat de components individuals del codi, com models o serveis.</p>
<h4 id="12-proves-dintegracio">1.2 Proves d'Integració<a class="headerlink" href="#12-proves-dintegracio" title="Permanent link">&para;</a></h4>
<p>Verifiquen la interacció entre múltiples components de l'aplicació.</p>
<h4 id="13-proves-http">1.3 Proves HTTP<a class="headerlink" href="#13-proves-http" title="Permanent link">&para;</a></h4>
<p>Validen rutes, controladors i respostes HTTP.</p>
<h4 id="14-proves-de-base-de-dades">1.4 Proves de Base de Dades<a class="headerlink" href="#14-proves-de-base-de-dades" title="Permanent link">&para;</a></h4>
<p>Asseguren que les dades es processen i emmagatzemen correctament.</p>
<h4 id="15-proves-dinterficie-amb-dusk">1.5 Proves d'Interfície amb Dusk<a class="headerlink" href="#15-proves-dinterficie-amb-dusk" title="Permanent link">&para;</a></h4>
<p>Simulen la interacció amb el navegador per provar la interfície d'usuari.</p>
<hr />
<h3 id="2-configuracio">2. Configuració<a class="headerlink" href="#2-configuracio" title="Permanent link">&para;</a></h3>
<h4 id="21-configurar-lambient-de-proves">2.1 Configurar l'Ambient de Proves<a class="headerlink" href="#21-configurar-lambient-de-proves" title="Permanent link">&para;</a></h4>
<p>Laravel utilitza el fitxer <code>.env.testing</code> per definir la configuració de les proves. Per exemple:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>APP_ENV=testing
<span class="linenos" data-linenos="2 "></span>DB_CONNECTION=sqlite
<span class="linenos" data-linenos="3 "></span>DB_DATABASE=:memory:
</code></pre></div></p>
<h4 id="22-executar-proves">2.2 Executar Proves<a class="headerlink" href="#22-executar-proves" title="Permanent link">&para;</a></h4>
<p>Utilitza PHPUnit per executar les proves:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span><span class="nb">test</span>
</code></pre></div></p>
<hr />
<h3 id="3-proves-http">3. Proves HTTP<a class="headerlink" href="#3-proves-http" title="Permanent link">&para;</a></h3>
<h4 id="31-crear-proves">3.1 Crear Proves<a class="headerlink" href="#31-crear-proves" title="Permanent link">&para;</a></h4>
<p>Genera una prova amb Artisan:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:test<span class="w"> </span>ExampleTest
</code></pre></div></p>
<h4 id="32-exemple-de-prova-http">3.2 Exemple de Prova HTTP<a class="headerlink" href="#32-exemple-de-prova-http" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace Tests\Feature;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Tests\TestCase;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">class ExampleTest extends TestCase</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    public function test_homepage_loads_correctly()</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    {</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        $response = $this-&gt;get(&#39;/&#39;);</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="x">        $response-&gt;assertStatus(200);</span>
<span class="linenos" data-linenos="12 "></span><span class="x">        $response-&gt;assertSee(&#39;Benvingut&#39;);</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="14 "></span><span class="x">}</span>
</code></pre></div>
<h3 id="4-proves-de-base-de-dades">4. Proves de Base de Dades<a class="headerlink" href="#4-proves-de-base-de-dades" title="Permanent link">&para;</a></h3>
<h4 id="41-migracions-en-proves">4.1 Migracions en Proves<a class="headerlink" href="#41-migracions-en-proves" title="Permanent link">&para;</a></h4>
<p>Utilitza el trait <code>RefreshDatabase</code> per executar les migracions abans de cada prova:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">use Illuminate\Foundation\Testing\RefreshDatabase;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">class ExampleTest extends TestCase</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    use RefreshDatabase;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    public function test_database_interaction()</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    {</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        $user = User::factory()-&gt;create();</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="x">        $this-&gt;assertDatabaseHas(&#39;users&#39;, [</span>
<span class="linenos" data-linenos="12 "></span><span class="x">            &#39;email&#39; =&gt; $user-&gt;email,</span>
<span class="linenos" data-linenos="13 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="14 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="15 "></span><span class="x">}</span>
</code></pre></div></p>
<h4 id="42-factories">4.2 Factories<a class="headerlink" href="#42-factories" title="Permanent link">&para;</a></h4>
<p>Utilitza factories per generar dades de prova:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$user = User::factory()-&gt;create();</span>
</code></pre></div></p>
<h2 id="laravel-livewire-introduccio">Laravel Livewire: Introducció<a class="headerlink" href="#laravel-livewire-introduccio" title="Permanent link">&para;</a></h2>
<p><strong>Laravel Livewire</strong> és un framework que permet construir components d'interfície d'usuari dinàmics sense haver d'escriure JavaScript. Amb Livewire, pots utilitzar PHP per gestionar la lògica del client, mentre que Livewire s'encarrega de la comunicació asincrònica amb el servidor.</p>
<h3 id="1-installacio">1. Instal·lació<a class="headerlink" href="#1-installacio" title="Permanent link">&para;</a></h3>
<h4 id="11-requisits">1.1 Requisits<a class="headerlink" href="#11-requisits" title="Permanent link">&para;</a></h4>
<p>Laravel Livewire funciona amb aplicacions Laravel. Assegura't de tenir Laravel instal·lat.</p>
<h4 id="12-installar-livewire">1.2 Instal·lar Livewire<a class="headerlink" href="#12-installar-livewire" title="Permanent link">&para;</a></h4>
<p>Utilitza Composer per instal·lar el paquet:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer<span class="w"> </span>require<span class="w"> </span>livewire/livewire
</code></pre></div></p>
<p>Publica els actius de Livewire:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>livewire:publish
</code></pre></div></p>
<p>Inclou els scripts de Livewire en les teues vistes Blade:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>@livewireStyles
<span class="linenos" data-linenos="2 "></span>@livewireScripts
</code></pre></div></p>
<h3 id="2-crear-components-livewire">2. Crear Components Livewire<a class="headerlink" href="#2-crear-components-livewire" title="Permanent link">&para;</a></h3>
<h4 id="21-generar-un-component">2.1 Generar un Component<a class="headerlink" href="#21-generar-un-component" title="Permanent link">&para;</a></h4>
<p>Utilitza Artisan per crear un component:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:livewire<span class="w"> </span>HelloWorld
</code></pre></div></p>
<p>Això genera:
- Un fitxer de classe PHP: <code>app/Http/Livewire/HelloWorld.php</code>
- Una plantilla Blade: <code>resources/views/livewire/hello-world.blade.php</code></p>
<h4 id="22-exemple-de-component">2.2 Exemple de Component<a class="headerlink" href="#22-exemple-de-component" title="Permanent link">&para;</a></h4>
<p><strong>Classe del Component:</strong>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Http\Livewire;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Livewire\Component;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">class HelloWorld extends Component</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    public $message = &quot;Hola, món!&quot;;</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    public function render()</span>
<span class="linenos" data-linenos="10 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="11 "></span><span class="x">        return view(&#39;livewire.hello-world&#39;);</span>
<span class="linenos" data-linenos="12 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="13 "></span><span class="x">}</span>
</code></pre></div></p>
<p><strong>Plantilla Blade:</strong>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="2 "></span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ $message }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div></p>
<p>Inclou el component en una vista:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">livewire:hello-world</span> <span class="p">/&gt;</span>
</code></pre></div></p>
<h3 id="3-interactivitat-amb-livewire">3. Interactivitat amb Livewire<a class="headerlink" href="#3-interactivitat-amb-livewire" title="Permanent link">&para;</a></h3>
<h4 id="31-propietats-dinamiques">3.1 Propietats Dinàmiques<a class="headerlink" href="#31-propietats-dinamiques" title="Permanent link">&para;</a></h4>
<p>Les propietats de la classe PHP es poden vincular directament als camps d'un formulari HTML:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">class Counter extends Component</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">    public $count = 0;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    public function increment()</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    {</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">        $this-&gt;count++;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    }</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="x">    public function render()</span>
<span class="linenos" data-linenos="11 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="12 "></span><span class="x">        return view(&#39;livewire.counter&#39;);</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="14 "></span><span class="x">}</span>
</code></pre></div></p>
<p><strong>Plantilla Blade:</strong>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="2 "></span>    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">wire:click</span><span class="o">=</span><span class="s">&quot;increment&quot;</span><span class="p">&gt;</span>Incrementar<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ $count }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="4 "></span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div></p>
<h4 id="32-validacio-en-temps-real">3.2 Validació en Temps Real<a class="headerlink" href="#32-validacio-en-temps-real" title="Permanent link">&para;</a></h4>
<p>Livewire permet validar dades a mesura que l'usuari interactua amb el formulari:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">class Form extends Component</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">    public $name;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">    public $email;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    protected $rules = [</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">        &#39;name&#39; =&gt; &#39;required|min:3&#39;,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">        &#39;email&#39; =&gt; &#39;required|email&#39;,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    ];</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="x">    public function submit()</span>
<span class="linenos" data-linenos="12 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="13 "></span><span class="x">        $this-&gt;validate();</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">        // Processar les dades</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="x">    public function render()</span>
<span class="linenos" data-linenos="19 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="20 "></span><span class="x">        return view(&#39;livewire.form&#39;);</span>
<span class="linenos" data-linenos="21 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="22 "></span><span class="x">}</span>
</code></pre></div></p>
<p><strong>Plantilla Blade:</strong>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 2 "></span>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">wire:submit</span><span class="err">.</span><span class="na">prevent</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 3 "></span>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">wire:model</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 4 "></span>        @error(&#39;name&#39;) <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-danger&quot;</span><span class="p">&gt;</span>{{ $message }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> @enderror
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;email&quot;</span> <span class="na">wire:model</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 7 "></span>        @error(&#39;email&#39;) <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-danger&quot;</span><span class="p">&gt;</span>{{ $message }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> @enderror
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Enviar<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="11 "></span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div></p>
<h3 id="4-avantatges-de-livewire">4. Avantatges de Livewire<a class="headerlink" href="#4-avantatges-de-livewire" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Simplicitat</strong>: Evita la necessitat de gestionar JavaScript per funcionalitats comunes.</li>
<li><strong>Reactivitat</strong>: Actualitza la interfície automàticament en resposta a canvis de dades.</li>
<li><strong>Integració</strong>: Es combina perfectament amb Blade i Laravel.</li>
</ul>
<h2 id="exercici-practic-guia-dequips-de-futbol-femeni-amb-base-de-dades">Exercici Pràctic: Guia d'Equips de Futbol Femení amb Base de Dades<a class="headerlink" href="#exercici-practic-guia-dequips-de-futbol-femeni-amb-base-de-dades" title="Permanent link">&para;</a></h2>
<p>L'objectiu d'aquest exercici és estendre la Guia d'Equips de Futbol Femení amb les funcionalitats tractades en este tema. </p>
<h3 id="pas-1-configurar-lautenticacio-amb-laravel-breeze">Pas 1: Configurar l'autenticació amb Laravel Breeze<a class="headerlink" href="#pas-1-configurar-lautenticacio-amb-laravel-breeze" title="Permanent link">&para;</a></h3>
<ol>
<li>Copia el fitxer app.blade.php de la carpeta resources/views/layouts a equips.blade.php.</li>
<li>Guarda les rutes de la Guia d'Equips de Futbol Femení en algun fitxer per utilitzar després.  </li>
<li>Instal·la Laravel Breeze:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer<span class="w"> </span>require<span class="w"> </span>laravel/breeze<span class="w"> </span>--dev
<span class="linenos" data-linenos="2 "></span>php<span class="w"> </span>artisan<span class="w"> </span>breeze:install
<span class="linenos" data-linenos="3 "></span>npm<span class="w"> </span>install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>dev
<span class="linenos" data-linenos="4 "></span>php<span class="w"> </span>artisan<span class="w"> </span>migrate
</code></pre></div>
<h3 id="pas-2-afegir-els-rols-al-sistema">Pas 2: Afegir els rols al sistema<a class="headerlink" href="#pas-2-afegir-els-rols-al-sistema" title="Permanent link">&para;</a></h3>
<h4 id="migracio-per-al-camp-role-als-usuaris">Migració per al camp <code>role</code> als usuaris<a class="headerlink" href="#migracio-per-al-camp-role-als-usuaris" title="Permanent link">&para;</a></h4>
<ol>
<li>Crea una nova migració per afegir el camp <code>role</code> a usuaris:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:migration<span class="w"> </span>add_role_to_users_table<span class="w"> </span>--table<span class="o">=</span>users
</code></pre></div>
   Afegeix el camp:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Schema::table(&#39;users&#39;, function (Blueprint $table) {</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    $table-&gt;string(&#39;role&#39;)-&gt;default(&#39;arbitre&#39;);</span>
<span class="linenos" data-linenos="3 "></span><span class="x">});</span>
</code></pre></div>
   Aplica la migració:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>migrate
</code></pre></div></li>
</ol>
<h4 id="crea-el-seeders-dusuaris-i-crea-un-usuari-administrador">Crea el seeders d'usuaris i crea un usuari administrador<a class="headerlink" href="#crea-el-seeders-dusuaris-i-crea-un-usuari-administrador" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">User::create([</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    &#39;name&#39; =&gt; &#39;Admin&#39;,</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &#39;email&#39; =&gt; &#39;admin@example.com&#39;,</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    &#39;password&#39; =&gt; Hash::make(&#39;password&#39;),</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    &#39;role&#39; =&gt; &#39;administrador&#39;,</span>
<span class="linenos" data-linenos="6 "></span><span class="x">]);</span>
</code></pre></div>
<h3 id="pas-3-middleware-per-a-permisos-de-rol-i-manager">Pas 3: Middleware per a permisos de rol i manager<a class="headerlink" href="#pas-3-middleware-per-a-permisos-de-rol-i-manager" title="Permanent link">&para;</a></h3>
<h4 id="crear-middleware-per-a-gestionar-els-rols">Crear Middleware per a gestionar els rols<a class="headerlink" href="#crear-middleware-per-a-gestionar-els-rols" title="Permanent link">&para;</a></h4>
<ol>
<li>Genera el middleware:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:middleware<span class="w"> </span>RoleMiddleware
</code></pre></div></li>
<li>Defineix el control dels rols:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function handle($request, Closure $next, $role)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    if (auth()-&gt;user()-&gt;role !== $role) {</span>
<span class="linenos" data-linenos="4 "></span><span class="x">        return redirect(&#39;/&#39;)-&gt;with(&#39;error&#39;, &#39;No tens permís per accedir a aquesta pàgina.&#39;);</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    return $next($request);</span>
<span class="linenos" data-linenos="7 "></span><span class="x">}</span>
</code></pre></div></li>
</ol>
<h4 id="aplicar-middleware-a-rutes">Aplicar Middleware a rutes<a class="headerlink" href="#aplicar-middleware-a-rutes" title="Permanent link">&para;</a></h4>
<ul>
<li>Protegeix les rutes per tal que els equips,estadis soles puguen modificar-los els administradors:
  <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">  Route::middleware([&#39;auth&#39;, RoleMiddleware::class.&#39;:administrador&#39; ])-&gt;group(function (){</span>
<span class="linenos" data-linenos="2 "></span><span class="x">      Route::resource(&#39;/equips&#39;, EquipController::class)-&gt;except([&#39;index&#39;, &#39;show&#39;]);</span>
<span class="linenos" data-linenos="3 "></span><span class="x">      Route::resource(&#39;/estadis&#39;, EstadisController::class)-&gt;except([&#39;index&#39;, &#39;show&#39;]);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">  });</span>
<span class="linenos" data-linenos="5 "></span><span class="x">  Route::resource(&#39;/equips&#39;, EquipController::class)-&gt;only([&#39;index&#39;, &#39;show&#39;]);</span>
<span class="linenos" data-linenos="6 "></span><span class="x">  Route::resource(&#39;/estadis&#39;, EstadisController::class)-&gt;only([&#39;index&#39;, &#39;show&#39;]);</span>
</code></pre></div></li>
</ul>
<h3 id="pas-4-associar-managers-a-equips">Pas 4: Associar managers a equips<a class="headerlink" href="#pas-4-associar-managers-a-equips" title="Permanent link">&para;</a></h3>
<h4 id="migracio-per-a-lassociacio-entre-usuaris-i-equips">Migració per a l’associació entre usuaris i equips<a class="headerlink" href="#migracio-per-a-lassociacio-entre-usuaris-i-equips" title="Permanent link">&para;</a></h4>
<ol>
<li>Crea una migració nova:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:migration<span class="w"> </span>add_team_id_to_users_table<span class="w"> </span>--table<span class="o">=</span>users
</code></pre></div></li>
<li>Afegeix el camp <code>team_id</code>:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Schema::table(&#39;users&#39;, function (Blueprint $table) {</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    $table-&gt;unsignedBigInteger(&#39;equip_id&#39;)-&gt;nullable();</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $table-&gt;foreign(&#39;equip_id&#39;)-&gt;references(&#39;id&#39;)-&gt;on(&#39;equips&#39;)-&gt;onDelete(&#39;set null&#39;);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">});</span>
</code></pre></div></li>
<li>Aplica la migració:
   <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>migrate
</code></pre></div></li>
</ol>
<h4 id="assignar-equips-als-managers">Assignar equips als managers<a class="headerlink" href="#assignar-equips-als-managers" title="Permanent link">&para;</a></h4>
<ul>
<li>Crea un manager per equip i assigna-li  :
  <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">foreach (Equip::all() as $equip){</span>
<span class="linenos" data-linenos="2 "></span><span class="x">          User::create([</span>
<span class="linenos" data-linenos="3 "></span><span class="x">              &#39;name&#39; =&gt; &#39;Manager  &#39;.$equip-&gt;nom,</span>
<span class="linenos" data-linenos="4 "></span><span class="x">              &#39;email&#39; =&gt; $equip-&gt;nom.&#39;@manager.com&#39;,</span>
<span class="linenos" data-linenos="5 "></span><span class="x">              &#39;password&#39; =&gt; Hash::make(&#39;1234&#39;),</span>
<span class="linenos" data-linenos="6 "></span><span class="x">              &#39;role&#39; =&gt; &#39;manager&#39;,</span>
<span class="linenos" data-linenos="7 "></span><span class="x">              &#39;equip_id&#39; =&gt; $equip-&gt;id,</span>
<span class="linenos" data-linenos="8 "></span><span class="x">          ]);</span>
<span class="linenos" data-linenos="9 "></span><span class="x">      }</span>
</code></pre></div></li>
</ul>
<h3 id="relacio-entre-models">Relació entre models<a class="headerlink" href="#relacio-entre-models" title="Permanent link">&para;</a></h3>
<ul>
<li>Defineix la relació al model <code>User</code>:
  <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function equip()</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    return $this-&gt;belongsTo(Equip::class );</span>
<span class="linenos" data-linenos="4 "></span><span class="x">}</span>
</code></pre></div></li>
<li>Defineix la relació inversa al model <code>Equip</code>:
  <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function manager()</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    return $this-&gt;hasOne(User::class );</span>
<span class="linenos" data-linenos="4 "></span><span class="x">}</span>
</code></pre></div></li>
</ul>
<h3 id="pas-5-adaptar-les-vistes-al-component-layout-de-breeze">Pas 5: Adaptar les vistes al component layout de Breeze<a class="headerlink" href="#pas-5-adaptar-les-vistes-al-component-layout-de-breeze" title="Permanent link">&para;</a></h3>
<ol>
<li>Modificar equips.blade.php per a utilitzar el layout de Breeze.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">&lt;x-app-layout&gt;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">    &lt;x-slot name=&quot;header&quot;&gt;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">        &lt;h2 class=&quot;font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&quot;&gt;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">            @yield(&#39;title&#39;,&#39;Guia de futbol femení&#39;)</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">        &lt;/h2&gt;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    &lt;/x-slot&gt;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    &lt;div class=&quot;py-12&quot;&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        &lt;div class=&quot;max-w-7xl mx-auto sm:px-6 lg:px-8&quot;&gt;</span>
<span class="linenos" data-linenos="10 "></span><span class="x">            &lt;div class=&quot;bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg&quot;&gt;</span>
<span class="linenos" data-linenos="11 "></span><span class="x">                &lt;div class=&quot;p-6 text-gray-900 dark:text-gray-100&quot;&gt;</span>
<span class="linenos" data-linenos="12 "></span><span class="x">                    @yield(&#39;content&#39;)</span>
<span class="linenos" data-linenos="13 "></span><span class="x">                &lt;/div&gt;</span>
<span class="linenos" data-linenos="14 "></span><span class="x">            &lt;/div&gt;</span>
<span class="linenos" data-linenos="15 "></span><span class="x">        &lt;/div&gt;</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    &lt;/div&gt;</span>
<span class="linenos" data-linenos="17 "></span><span class="x">    &lt;footer&gt;</span>
<span class="linenos" data-linenos="18 "></span><span class="x">        &lt;p&gt;&amp;copy; 2024 Guia de Futbol Femení&lt;/p&gt;</span>
<span class="linenos" data-linenos="19 "></span><span class="x">    &lt;/footer&gt;</span>
<span class="linenos" data-linenos="20 "></span><span class="x">&lt;/x-app-layout&gt;</span>
</code></pre></div>
<ol start="2">
<li>Modificar la vista de l'equip per a utilitzar el layout de Breeze.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">@extends(&#39;layouts.equips&#39;)</span>
</code></pre></div>
<ol start="3">
<li>Modificar el layout de Breeze per a incloure el menú de navegació .</li>
</ol>
<p>En navigation.blade.php:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">    ...</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    &lt;!-- Navigation Links --&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    &lt;div class=&quot;hidden space-x-8 sm:-my-px sm:ms-10 sm:flex&quot;&gt;</span>
<span class="linenos" data-linenos="4 "></span><span class="x">        &lt;x-nav-link :href=&quot;route(&#39;dashboard&#39;)&quot; :active=&quot;request()-&gt;routeIs(&#39;dashboard&#39;)&quot;&gt;</span>
<span class="linenos" data-linenos="5 "></span><span class="x">            {{ __(&#39;Dashboard&#39;) }}</span>
<span class="linenos" data-linenos="6 "></span><span class="x">        &lt;/x-nav-link&gt;</span>
<span class="linenos" data-linenos="7 "></span><span class="x">    &lt;/div&gt;</span>
<span class="linenos" data-linenos="8 "></span><span class="x">    @include(&#39;partials.menu&#39;)</span>
<span class="linenos" data-linenos="9 "></span><span class="x">    ...</span>
</code></pre></div></p>
<ol start="4">
<li>En partials/menu.blade.php:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">    ...</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">    &lt;div class=&quot;hidden space-x-8 sm:-my-px sm:ms-10 sm:flex&quot;&gt;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">        &lt;x-nav-link :href=&quot;route(&#39;equips.index&#39;)&quot; :active=&quot;request()-&gt;routeIs(&#39;dashboard&#39;)&quot;&gt;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">            {{ __(&#39;Guia Equips&#39;) }}</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">        &lt;/x-nav-link&gt;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    &lt;/div&gt;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    &lt;div class=&quot;hidden space-x-8 sm:-my-px sm:ms-10 sm:flex&quot;&gt;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">        &lt;x-nav-link :href=&quot;route(&#39;estadis.index&#39;)&quot; :active=&quot;request()-&gt;routeIs(&#39;dashboard&#39;)&quot;&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">            {{ __(&#39;Estadis&#39;) }}</span>
<span class="linenos" data-linenos="10 "></span><span class="x">        &lt;/x-nav-link&gt;</span>
<span class="linenos" data-linenos="11 "></span><span class="x">    &lt;/div&gt;</span>
<span class="linenos" data-linenos="12 "></span><span class="x">    ...</span>
</code></pre></div></li>
</ol>
<h3 id="pas-6-el-manager-soles-puga-editar-el-seu-equip">Pas 6: El manager soles puga editar el seu equip<a class="headerlink" href="#pas-6-el-manager-soles-puga-editar-el-seu-equip" title="Permanent link">&para;</a></h3>
<h4 id="1-crear-la-politica">1. Crear la Política<a class="headerlink" href="#1-crear-la-politica" title="Permanent link">&para;</a></h4>
<p>Executa el següent comandament per generar la política associada al model <code>Equip</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:policy<span class="w"> </span>EquipPolicy<span class="w"> </span>--model<span class="o">=</span>Equip
</code></pre></div></p>
<h4 id="2-definir-la-logica-a-la-politica">2. Definir la Lògica a la Política<a class="headerlink" href="#2-definir-la-logica-a-la-politica" title="Permanent link">&para;</a></h4>
<p>Edita el fitxer generat <code>app/Policies/EquipPolicy.php</code> i afegeix les regles de permisos.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Policies;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use App\Models\User;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use App\Models\Equip;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">class EquipPolicy</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    /**</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">     * Determine whether the user can create models.</span>
<span class="linenos" data-linenos="10 "></span><span class="x">     */</span>
<span class="linenos" data-linenos="11 "></span><span class="x">    public function create(User $user): bool</span>
<span class="linenos" data-linenos="12 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="13 "></span><span class="x">        // Només els administradors poden crear equips</span>
<span class="linenos" data-linenos="14 "></span><span class="x">        return $user-&gt;role === &#39;administrador&#39;;</span>
<span class="linenos" data-linenos="15 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="x">    /**</span>
<span class="linenos" data-linenos="18 "></span><span class="x">     * Determine whether the user can update the model.</span>
<span class="linenos" data-linenos="19 "></span><span class="x">     */</span>
<span class="linenos" data-linenos="20 "></span><span class="x">    public function update(User $user, Equip $equip)</span>
<span class="linenos" data-linenos="21 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="22 "></span><span class="x">        // Permetre si l&#39;usuari és un administrador o un manager i està assignat a aquest equip</span>
<span class="linenos" data-linenos="23 "></span><span class="x">        return $user-&gt;role === &#39;administrador&#39; || ($user-&gt;role === &#39;manager&#39; &amp;&amp; $user-&gt;equip_id === $equip-&gt;id);</span>
<span class="linenos" data-linenos="24 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="25 "></span>
<span class="linenos" data-linenos="26 "></span><span class="x">    /**</span>
<span class="linenos" data-linenos="27 "></span><span class="x">     * Determina si l&#39;usuari pot eliminar l&#39;equip.</span>
<span class="linenos" data-linenos="28 "></span><span class="x">     *</span>
<span class="linenos" data-linenos="29 "></span><span class="x">     * @param  \App\Models\User  $user</span>
<span class="linenos" data-linenos="30 "></span><span class="x">     * @param  \App\Models\Equip $equip</span>
<span class="linenos" data-linenos="31 "></span><span class="x">     * @return bool</span>
<span class="linenos" data-linenos="32 "></span><span class="x">     */</span>
<span class="linenos" data-linenos="33 "></span><span class="x">    public function delete(User $user, Equip $equip)</span>
<span class="linenos" data-linenos="34 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="35 "></span><span class="x">        // Només els administradors poden eliminar equips</span>
<span class="linenos" data-linenos="36 "></span><span class="x">        return $user-&gt;role === &#39;administrador&#39;;</span>
<span class="linenos" data-linenos="37 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="38 "></span><span class="x">}</span>
</code></pre></div>
<h4 id="3-utilitzar-la-politica-al-controlador">3. Utilitzar la Política al Controlador<a class="headerlink" href="#3-utilitzar-la-politica-al-controlador" title="Permanent link">&para;</a></h4>
<p>Al controlador <code>EquipController</code>, utilitza el mètode <code>authorize</code> per aplicar la política abans de permetre accions.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">class EquipController extends Controller</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">    use AuthorizesRequests;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    public function index() {</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">        $equips = Equip::all();</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">        return view(&#39;equips.index&#39;, compact(&#39;equips&#39;));</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="x">    public function show(Equip $equip) {</span>
<span class="linenos" data-linenos="12 "></span><span class="x">        return view(&#39;equips.show&#39;, compact(&#39;equip&#39;));</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">    public function create() {</span>
<span class="linenos" data-linenos="16 "></span><span class="x">        $this-&gt;authorize(&#39;create&#39;);</span>
<span class="linenos" data-linenos="17 "></span><span class="x">        $estadis = Estadi::all();</span>
<span class="linenos" data-linenos="18 "></span><span class="x">        return view(&#39;equips.create&#39;,compact(&#39;estadis&#39;));</span>
<span class="linenos" data-linenos="19 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span><span class="x">    public function edit(Equip $equip) {</span>
<span class="linenos" data-linenos="22 "></span><span class="x">        $this-&gt;authorize(&#39;update&#39;, $equip);</span>
<span class="linenos" data-linenos="23 "></span><span class="x">        $estadis = Estadi::all();</span>
<span class="linenos" data-linenos="24 "></span><span class="x">        return view(&#39;equips.edit&#39;, compact(&#39;equip&#39;,&#39;estadis&#39;));</span>
<span class="linenos" data-linenos="25 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span><span class="x">    public function store(Request $request)</span>
<span class="linenos" data-linenos="29 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="30 "></span><span class="x">        $this-&gt;authorize(&#39;create&#39;);</span>
<span class="linenos" data-linenos="31 "></span><span class="x">        $validated = $request-&gt;validate([</span>
<span class="linenos" data-linenos="32 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;required|unique:equips&#39;,</span>
<span class="linenos" data-linenos="33 "></span><span class="x">            &#39;titols&#39; =&gt; &#39;integer|min:0&#39;,</span>
<span class="linenos" data-linenos="34 "></span><span class="x">            &#39;estadi_id&#39; =&gt; &#39;required|exists:estadis,id&#39;,</span>
<span class="linenos" data-linenos="35 "></span><span class="x">            &#39;escut&#39; =&gt; &#39;nullable|image|mimes:jpeg,png,jpg|max:2048&#39;, // Validació del fitxer</span>
<span class="linenos" data-linenos="36 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="37 "></span>
<span class="linenos" data-linenos="38 "></span><span class="x">        if ($request-&gt;hasFile(&#39;escut&#39;)) {</span>
<span class="linenos" data-linenos="39 "></span><span class="x">            $path = $request-&gt;file(&#39;escut&#39;)-&gt;store(&#39;escuts&#39;, &#39;public&#39;);</span>
<span class="linenos" data-linenos="40 "></span><span class="x">            $validated[&#39;escut&#39;] = $path;</span>
<span class="linenos" data-linenos="41 "></span><span class="x">        }</span>
<span class="linenos" data-linenos="42 "></span>
<span class="linenos" data-linenos="43 "></span><span class="x">        Equip::create($validated);</span>
<span class="linenos" data-linenos="44 "></span>
<span class="linenos" data-linenos="45 "></span><span class="x">        return redirect()-&gt;route(&#39;equips.index&#39;)-&gt;with(&#39;success&#39;, &#39;Equip creat correctament!&#39;);</span>
<span class="linenos" data-linenos="46 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="47 "></span>
<span class="linenos" data-linenos="48 "></span>
<span class="linenos" data-linenos="49 "></span><span class="x">    public function update(Request $request, Equip $equip)</span>
<span class="linenos" data-linenos="50 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="51 "></span><span class="x">        $this-&gt;authorize(&#39;update&#39;, $equip);</span>
<span class="linenos" data-linenos="52 "></span><span class="x">        $validated = $request-&gt;validate([</span>
<span class="linenos" data-linenos="53 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;required|unique:equips,nom,&#39; . $equip-&gt;id,</span>
<span class="linenos" data-linenos="54 "></span><span class="x">            &#39;titols&#39; =&gt; &#39;integer|min:0&#39;,</span>
<span class="linenos" data-linenos="55 "></span><span class="x">            &#39;estadi_id&#39; =&gt; &#39;required|exists:estadis,id&#39;,</span>
<span class="linenos" data-linenos="56 "></span><span class="x">            &#39;escut&#39; =&gt; &#39;nullable|image|mimes:jpeg,png,jpg|max:2048&#39;,</span>
<span class="linenos" data-linenos="57 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="58 "></span>
<span class="linenos" data-linenos="59 "></span>
<span class="linenos" data-linenos="60 "></span><span class="x">        if ($request-&gt;hasFile(&#39;escut&#39;)) {</span>
<span class="linenos" data-linenos="61 "></span><span class="x">            if ($equip-&gt;escut) {</span>
<span class="linenos" data-linenos="62 "></span><span class="x">                Storage::disk(&#39;public&#39;)-&gt;delete($equip-&gt;escut); // Esborra l&#39;escut antic</span>
<span class="linenos" data-linenos="63 "></span><span class="x">            }</span>
<span class="linenos" data-linenos="64 "></span><span class="x">            $path = $request-&gt;file(&#39;escut&#39;)-&gt;store(&#39;escuts&#39;, &#39;public&#39;);</span>
<span class="linenos" data-linenos="65 "></span><span class="x">            $validated[&#39;escut&#39;] = $path;</span>
<span class="linenos" data-linenos="66 "></span><span class="x">        }</span>
<span class="linenos" data-linenos="67 "></span>
<span class="linenos" data-linenos="68 "></span><span class="x">        $equip-&gt;update($validated);</span>
<span class="linenos" data-linenos="69 "></span>
<span class="linenos" data-linenos="70 "></span><span class="x">        return redirect()-&gt;route(&#39;equips.index&#39;)-&gt;with(&#39;success&#39;, &#39;Equip actualitzat correctament!&#39;);</span>
<span class="linenos" data-linenos="71 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="72 "></span>
<span class="linenos" data-linenos="73 "></span><span class="x">    public function destroy(Equip $equip)</span>
<span class="linenos" data-linenos="74 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="75 "></span><span class="x">        $this-&gt;authorize(&#39;delete&#39;, $equip);</span>
<span class="linenos" data-linenos="76 "></span><span class="x">        if ($equip-&gt;escut) {</span>
<span class="linenos" data-linenos="77 "></span><span class="x">            Storage::disk(&#39;public&#39;)-&gt;delete($equip-&gt;escut);</span>
<span class="linenos" data-linenos="78 "></span><span class="x">        }</span>
<span class="linenos" data-linenos="79 "></span><span class="x">        $equip-&gt;delete();</span>
<span class="linenos" data-linenos="80 "></span><span class="x">        return redirect()-&gt;route(&#39;equips.index&#39;)-&gt;with(&#39;success&#39;, &#39;Equip esborrat correctament!&#39;);</span>
<span class="linenos" data-linenos="81 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="82 "></span>
<span class="linenos" data-linenos="83 "></span>
<span class="linenos" data-linenos="84 "></span><span class="x">}</span>
</code></pre></div>
<h4 id="4-utilitzar-la-politica-a-les-vistes">4. Utilitzar la Política a les Vistes<a class="headerlink" href="#4-utilitzar-la-politica-a-les-vistes" title="Permanent link">&para;</a></h4>
<p>A les vistes Blade, pots utilitzar les directives <code>@can</code> per verificar els permisos.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>@can(&#39;update&#39;, $equip)
<span class="linenos" data-linenos="2 "></span>    &lt;a href=&quot;{{ route(&#39;equips.edit&#39;, $equip-&gt;id) }}&quot; class=&quot;text-yellow-600 hover:underline&quot;&gt;Editar&lt;/a&gt;
<span class="linenos" data-linenos="3 "></span>@endcan
</code></pre></div>
<h3 id="pas-7-afegir-formrequest-per-a-la-validacio">Pas 7. Afegir FormRequest per a la validació<a class="headerlink" href="#pas-7-afegir-formrequest-per-a-la-validacio" title="Permanent link">&para;</a></h3>
<h4 id="1-generar-el-form-request">1. Generar el Form Request<a class="headerlink" href="#1-generar-el-form-request" title="Permanent link">&para;</a></h4>
<p>Executa el següent comandament per crear un Form Request:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:request<span class="w"> </span>StoreEquipRequest
<span class="linenos" data-linenos="2 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:request<span class="w"> </span>UpdateEquipRequest
</code></pre></div>
<p>Aquest comandament crearà una classe <code>StoreEquipRequest</code> i altra <code>UpdateEquipRequest  al directori</code>app/Http/Requests`.</p>
<hr />
<h4 id="2-definir-les-regles-de-validacio">2. Definir les regles de validació<a class="headerlink" href="#2-definir-les-regles-de-validacio" title="Permanent link">&para;</a></h4>
<p>Obre el fitxer <code>StoreEquipRequest.php</code> i defineix les regles de validació al mètode <code>rules</code>.</p>
<h5 id="exemple-de-validacio">Exemple de validació:<a class="headerlink" href="#exemple-de-validacio" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Http\Requests;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Illuminate\Foundation\Http\FormRequest;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">class StoreEquipRequest extends FormRequest</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    /**</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">     * Determina si l&#39;usuari està autoritzat a fer aquesta petició.</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">     *</span>
<span class="linenos" data-linenos="10 "></span><span class="x">     * @return bool</span>
<span class="linenos" data-linenos="11 "></span><span class="x">     */</span>
<span class="linenos" data-linenos="12 "></span><span class="x">    public function authorize(): bool</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="14 "></span><span class="x">         return $this-&gt;user()-&gt;can(&#39;create&#39;, Equip::class);</span>
<span class="linenos" data-linenos="15 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="x">    /**</span>
<span class="linenos" data-linenos="18 "></span><span class="x">     * Get the validation rules that apply to the request.</span>
<span class="linenos" data-linenos="19 "></span><span class="x">     *</span>
<span class="linenos" data-linenos="20 "></span><span class="x">     * @return array&lt;string, \Illuminate\Contracts\Validation\ValidationRule|array&lt;mixed&gt;|string&gt;</span>
<span class="linenos" data-linenos="21 "></span><span class="x">     */</span>
<span class="linenos" data-linenos="22 "></span><span class="x">    public function rules(): array</span>
<span class="linenos" data-linenos="23 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="24 "></span><span class="x">        return [</span>
<span class="linenos" data-linenos="25 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;required|unique:equips&#39;,</span>
<span class="linenos" data-linenos="26 "></span><span class="x">            &#39;titols&#39; =&gt; &#39;integer|min:0&#39;,</span>
<span class="linenos" data-linenos="27 "></span><span class="x">            &#39;estadi_id&#39; =&gt; &#39;required|exists:estadis,id&#39;,</span>
<span class="linenos" data-linenos="28 "></span><span class="x">            &#39;escut&#39; =&gt; &#39;nullable|image|mimes:jpeg,png,jpg|max:2048&#39;, // Validació del fitxer</span>
<span class="linenos" data-linenos="29 "></span><span class="x">        ];</span>
<span class="linenos" data-linenos="30 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="x">    public function messages()</span>
<span class="linenos" data-linenos="33 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="34 "></span><span class="x">        return [</span>
<span class="linenos" data-linenos="35 "></span><span class="x">            &#39;nom.required&#39; =&gt; &#39;El camp &quot;Nom&quot; és obligatori.&#39;,</span>
<span class="linenos" data-linenos="36 "></span><span class="x">            &#39;nom.unique&#39; =&gt; &#39;Aquest nom ja està en ús. Si us plau, tria un altre.&#39;,</span>
<span class="linenos" data-linenos="37 "></span><span class="x">            &#39;titols.integer&#39; =&gt; &#39;El camp &quot;Títols&quot; ha de ser un número enter.&#39;,</span>
<span class="linenos" data-linenos="38 "></span><span class="x">            &#39;titols.min&#39; =&gt; &#39;El nombre de títols no pot ser inferior a zero.&#39;,</span>
<span class="linenos" data-linenos="39 "></span><span class="x">            &#39;estadi_id.required&#39; =&gt; &#39;El camp &quot;Estadi&quot; és obligatori.&#39;,</span>
<span class="linenos" data-linenos="40 "></span><span class="x">            &#39;estadi_id.exists&#39; =&gt; &#39;L\&#39;estadi seleccionat no és vàlid.&#39;,</span>
<span class="linenos" data-linenos="41 "></span><span class="x">            &#39;escut.image&#39; =&gt; &#39;El camp &quot;Escut&quot; ha de ser una imatge.&#39;,</span>
<span class="linenos" data-linenos="42 "></span><span class="x">            &#39;escut.mimes&#39; =&gt; &#39;El camp &quot;Escut&quot; només accepta formats: jpeg, png, jpg.&#39;,</span>
<span class="linenos" data-linenos="43 "></span><span class="x">            &#39;escut.max&#39; =&gt; &#39;La mida de l\&#39;escut no pot superar els 2 MB.&#39;,</span>
<span class="linenos" data-linenos="44 "></span><span class="x">        ];</span>
<span class="linenos" data-linenos="45 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="46 "></span><span class="x">}</span>
</code></pre></div>
<h4 id="3-modificar-el-controlador-per-utilitzar-el-form-request">3. Modificar el Controlador per Utilitzar el Form Request<a class="headerlink" href="#3-modificar-el-controlador-per-utilitzar-el-form-request" title="Permanent link">&para;</a></h4>
<p>Substitueix la injecció de <code>Request</code> pel nou <code>StoreEquipRequest</code> al mètode <code>store</code> del controlador <code>EquipController</code>.</p>
<h5 id="exemple">Exemple:<a class="headerlink" href="#exemple" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">use App\Http\Requests\StoreEquipRequest;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">public function store(StoreEquipRequest $request)</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    $validated = $request-&gt;validated(); // Obté les dades validades</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    if ($request-&gt;hasFile(&#39;escut&#39;)) {</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        $path = $request-&gt;file(&#39;escut&#39;)-&gt;store(&#39;escuts&#39;, &#39;public&#39;);</span>
<span class="linenos" data-linenos="10 "></span><span class="x">        $validated[&#39;escut&#39;] = $path;</span>
<span class="linenos" data-linenos="11 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="x">    Equip::create($validated);</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">    return redirect()-&gt;route(&#39;equips.index&#39;)-&gt;with(&#39;success&#39;, &#39;Equip creat correctament!&#39;);</span>
<span class="linenos" data-linenos="16 "></span><span class="x">}</span>
</code></pre></div>
<h4 id="4-fes-el-mateix-per-al-metode-update">4. Fes el mateix per al Mètode <code>update</code><a class="headerlink" href="#4-fes-el-mateix-per-al-metode-update" title="Permanent link">&para;</a></h4>
<p>Defineix les regles al mètode <code>rules</code>, incloent l'excepció per al camp únic (en aquest cas, el <code>nom</code>):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">use App\Http\Requests\StoreEquipRequest;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">public function authorize()</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    $equip = $this-&gt;route(&#39;equip&#39;); // Obté l&#39;equip de la ruta</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    return $this-&gt;user()-&gt;can(&#39;update&#39;, $equip);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">public function rules()</span>
<span class="linenos" data-linenos="10 "></span><span class="x">{</span>
<span class="linenos" data-linenos="11 "></span><span class="x">    $equipId = $this-&gt;route(&#39;equip&#39;)-&gt;id; // Obté l&#39;ID de l&#39;equip actual</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="x">    return [</span>
<span class="linenos" data-linenos="14 "></span><span class="x">        &#39;nom&#39; =&gt; &#39;required|unique:equips,nom,&#39; . $equipId,</span>
<span class="linenos" data-linenos="15 "></span><span class="x">        &#39;titols&#39; =&gt; &#39;integer|min:0&#39;,</span>
<span class="linenos" data-linenos="16 "></span><span class="x">        &#39;estadi_id&#39; =&gt; &#39;required|exists:estadis,id&#39;,</span>
<span class="linenos" data-linenos="17 "></span><span class="x">        &#39;escut&#39; =&gt; &#39;nullable|image|mimes:jpeg,png,jpg|max:2048&#39;,</span>
<span class="linenos" data-linenos="18 "></span><span class="x">    ];</span>
<span class="linenos" data-linenos="19 "></span><span class="x">} </span>
</code></pre></div>
<h2 id="pas-8-idiomes-al-projecte">Pas 8. Idiomes al projecte<a class="headerlink" href="#pas-8-idiomes-al-projecte" title="Permanent link">&para;</a></h2>
<h4 id="1-publicar-els-fitxers-de-llenguatge">1. Publicar els Fitxers de Llenguatge<a class="headerlink" href="#1-publicar-els-fitxers-de-llenguatge" title="Permanent link">&para;</a></h4>
<p>Per defecte, Laravel no inclou el directori <code>lang</code>. Per personalitzar els fitxers de llenguatge o crear-ne de nous, executa:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>lang:publish
</code></pre></div>
<p>Aquesta comanda crearà el directori <code>lang</code> i publicarà els fitxers de llenguatge predeterminats de Laravel.</p>
<h4 id="2-configurar-lidioma-predeterminat">2. Configurar l'Idioma Predeterminat<a class="headerlink" href="#2-configurar-lidioma-predeterminat" title="Permanent link">&para;</a></h4>
<p>Al fitxer <code>.env</code>, ajusta l'opcions <code>locale</code> per establir l'idioma predeterminat:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">APP_LOCALE=ca</span>
<span class="linenos" data-linenos="2 "></span><span class="x">APP_FALLBACK_LOCALE=en</span>
</code></pre></div>
<h4 id="3-definir-les-traduccions">3. Definir les Traduccions<a class="headerlink" href="#3-definir-les-traduccions" title="Permanent link">&para;</a></h4>
<p>Les cadenes de traducció es poden emmagatzemar en fitxers PHP o JSON dins del directori <code>lang</code>.</p>
<h5 id="utilitzant-fitxers-php">Utilitzant Fitxers PHP<a class="headerlink" href="#utilitzant-fitxers-php" title="Permanent link">&para;</a></h5>
<p>Crea subdirectoris per a cada idioma dins de <code>lang</code> i afegeix els fitxers de traducció corresponents. Per exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>/lang
<span class="linenos" data-linenos="2 "></span>     ca.json
<span class="linenos" data-linenos="3 "></span>     es.json 
<span class="linenos" data-linenos="4 "></span>     en.json
</code></pre></div>
<p>Cada fitxer ha de retornar un array de cadenes traduïdes:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">  </span><span class="nt">&quot;Creació d&#39;Equip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Creació d&#39;Equip&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="nt">&quot;Guia d&#39;Equips&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Guia d&#39;Equips&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">  </span><span class="nt">&quot;Modificació d&#39;Equip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Modificació d&#39;Equip&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">  </span><span class="nt">&quot;Escut actual&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Escut actual&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">  </span><span class="nt">&quot;Escut&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Escut&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">  </span><span class="nt">&quot;Estadi&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Estadi&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">  </span><span class="nt">&quot;Nom&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Nom&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">  </span><span class="nt">&quot;Títols&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Títols&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">  </span><span class="nt">&quot;Guardar&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Guardar&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span><span class="w">  </span><span class="nt">&quot;Actualitzar&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Actualitzar&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span><span class="w">  </span><span class="nt">&quot;Esborrar&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Esborrar&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span><span class="w">  </span><span class="nt">&quot;Crear Equip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Crear Equip&quot;</span><span class="w">  </span>
<span class="linenos" data-linenos="14 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">  </span><span class="nt">&quot;Creació d&#39;Equip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Creación de Equipo&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="nt">&quot;Guia d&#39;Equips&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Guía de Equipos&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">  </span><span class="nt">&quot;Modificació d&#39;Equip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Modificación de Equipo&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">  </span><span class="nt">&quot;Escut actual&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Escudo actual&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">  </span><span class="nt">&quot;Escut&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Escudo&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">  </span><span class="nt">&quot;Estadi&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Estadio&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">  </span><span class="nt">&quot;Nom&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Nombre&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">  </span><span class="nt">&quot;Títols&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Títulos&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">  </span><span class="nt">&quot;Guardar&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Guardar&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span><span class="w">  </span><span class="nt">&quot;Actualitzar&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Actualizar&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span><span class="w">  </span><span class="nt">&quot;Esborrar&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Borrar&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span><span class="w">  </span><span class="nt">&quot;Crear Equip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Crear Equipo&quot;</span>
<span class="linenos" data-linenos="14 "></span><span class="p">}</span><span class="w"> </span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">  </span><span class="nt">&quot;Creació d&#39;Equip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Team Creation&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="nt">&quot;Guia d&#39;Equips&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Team Guide&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">  </span><span class="nt">&quot;Modificació d&#39;Equip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Team Modification&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">  </span><span class="nt">&quot;Escut actual&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Current Shield&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">  </span><span class="nt">&quot;Escut&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Shield&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">  </span><span class="nt">&quot;Estadi&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Stadium&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">  </span><span class="nt">&quot;Nom&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">  </span><span class="nt">&quot;Títols&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Titles&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">  </span><span class="nt">&quot;Guardar&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Save&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span><span class="w">  </span><span class="nt">&quot;Actualitzar&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Update&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span><span class="w">  </span><span class="nt">&quot;Esborrar&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Delete&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span><span class="w">  </span><span class="nt">&quot;Crear Equip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Create Team&quot;</span>
<span class="linenos" data-linenos="14 "></span><span class="p">}</span>
</code></pre></div></p>
<h4 id="4-recuperar-cadenes-de-traduccio">4. Recuperar Cadenes de Traducció<a class="headerlink" href="#4-recuperar-cadenes-de-traduccio" title="Permanent link">&para;</a></h4>
<p>Utilitza la funció <code>__</code> per obtenir les cadenes traduïdes:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x"> @extends(&#39;layouts.equips&#39;)</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">@section(&#39;title&#39;, __(&quot;Creació d&#39;Equips&quot;))</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">@section(&#39;content&#39;)</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    &lt;form action=&quot;{{ route(&#39;equips.store&#39;) }}&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot; class=&quot;bg-white p-6 rounded-lg shadow-md max-w-md mx-auto&quot;&gt;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">        @csrf</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">        &lt;div class=&quot;mb-4&quot;&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">            &lt;label for=&quot;nom&quot; class=&quot;block text-sm font-medium text-gray-700 mb-1&quot;&gt;{{ __(&#39;Nom&#39;)}}:&lt;/label&gt;</span>
<span class="linenos" data-linenos="10 "></span><span class="x">            &lt;input type=&quot;text&quot; name=&quot;nom&quot; id=&quot;nom&quot; required</span>
<span class="linenos" data-linenos="11 "></span><span class="x">                   class=&quot;w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500&quot;&gt;</span>
<span class="linenos" data-linenos="12 "></span><span class="x">        &lt;/div&gt;</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="x">        &lt;div class=&quot;mb-4&quot;&gt;</span>
<span class="linenos" data-linenos="15 "></span><span class="x">            &lt;label for=&quot;titols&quot; class=&quot;block text-sm font-medium text-gray-700 mb-1&quot;&gt;{{__(&#39;Títols&#39;)}}:&lt;/label&gt;</span>
<span class="linenos" data-linenos="16 "></span><span class="x">            &lt;input type=&quot;number&quot; name=&quot;titols&quot; id=&quot;titols&quot; required</span>
<span class="linenos" data-linenos="17 "></span><span class="x">                   class=&quot;w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500&quot;&gt;</span>
<span class="linenos" data-linenos="18 "></span><span class="x">        &lt;/div&gt;</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="x">        &lt;div class=&quot;mb-4&quot;&gt;</span>
<span class="linenos" data-linenos="21 "></span><span class="x">            &lt;label for=&quot;estadi_id&quot; class=&quot;block text-sm font-medium text-gray-700 mb-1&quot;&gt;{{__(&#39;Estadi&#39;)}}:&lt;/label&gt;</span>
<span class="linenos" data-linenos="22 "></span><span class="x">            &lt;select name=&quot;estadi_id&quot; id=&quot;estadi_id&quot; required</span>
<span class="linenos" data-linenos="23 "></span><span class="x">                    class=&quot;w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500&quot;&gt;</span>
<span class="linenos" data-linenos="24 "></span><span class="x">                @foreach ($estadis as $estadi)</span>
<span class="linenos" data-linenos="25 "></span><span class="x">                    &lt;option value=&quot;{{ $estadi-&gt;id }}&quot;&gt;{{ $estadi-&gt;nom }}&lt;/option&gt;</span>
<span class="linenos" data-linenos="26 "></span><span class="x">                @endforeach</span>
<span class="linenos" data-linenos="27 "></span><span class="x">            &lt;/select&gt;</span>
<span class="linenos" data-linenos="28 "></span><span class="x">        &lt;/div&gt;</span>
<span class="linenos" data-linenos="29 "></span>
<span class="linenos" data-linenos="30 "></span><span class="x">        &lt;div class=&quot;mb-4&quot;&gt;</span>
<span class="linenos" data-linenos="31 "></span><span class="x">            &lt;label for=&quot;escut&quot; class=&quot;block text-sm font-medium text-gray-700 mb-1&quot;&gt;{{__(&#39;Escut&#39;)}}:&lt;/label&gt;</span>
<span class="linenos" data-linenos="32 "></span><span class="x">            &lt;input type=&quot;file&quot; name=&quot;escut&quot; id=&quot;escut&quot;</span>
<span class="linenos" data-linenos="33 "></span><span class="x">                   class=&quot;w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500&quot;&gt;</span>
<span class="linenos" data-linenos="34 "></span><span class="x">        &lt;/div&gt;</span>
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span><span class="x">        &lt;button type=&quot;submit&quot;</span>
<span class="linenos" data-linenos="37 "></span><span class="x">                class=&quot;w-full bg-blue-500 text-white font-medium py-2 px-4 rounded-lg shadow hover:bg-blue-600 focus:ring focus:ring-blue-300&quot;&gt;</span>
<span class="linenos" data-linenos="38 "></span><span class="x">            {{__(&#39;Crear Equip&#39;)}}</span>
<span class="linenos" data-linenos="39 "></span><span class="x">        &lt;/button&gt;</span>
<span class="linenos" data-linenos="40 "></span><span class="x">    &lt;/form&gt;</span>
<span class="linenos" data-linenos="41 "></span><span class="x">@endsection</span>
</code></pre></div>
<h4 id="5-canviar-lidioma-dinamicament">5. Canviar l'Idioma Dinàmicament<a class="headerlink" href="#5-canviar-lidioma-dinamicament" title="Permanent link">&para;</a></h4>
<p>Per canviar l'idioma durant l'execució, utilitza el mètode <code>setLocale</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">App::setLocale(&#39;es&#39;);</span>
</code></pre></div>
<p>Per facilitar als usuaris la selecció de l'idioma, pots crear rutes o enllaços que estableixin l'idioma desitjat.</p>
<hr />
<h4 id="7-traduir-missatges-de-validacio">7. Traduir Missatges de Validació<a class="headerlink" href="#7-traduir-missatges-de-validacio" title="Permanent link">&para;</a></h4>
<p>Els missatges de validació es poden personalitzar als fitxers de llenguatge corresponents. Per exemple, al fitxer <code>resources/lang/ca/validation.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="  1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="  2 "></span>
<span class="linenos" data-linenos="  3 "></span><span class="k">return</span> <span class="p">[</span>
<span class="linenos" data-linenos="  4 "></span>    <span class="cm">/*</span>
<span class="linenos" data-linenos="  5 "></span><span class="cm">    |--------------------------------------------------------------------------</span>
<span class="linenos" data-linenos="  6 "></span><span class="cm">    | Missatges de validació</span>
<span class="linenos" data-linenos="  7 "></span><span class="cm">    |--------------------------------------------------------------------------</span>
<span class="linenos" data-linenos="  8 "></span><span class="cm">    |</span>
<span class="linenos" data-linenos="  9 "></span><span class="cm">    | Les següents línies contenen els missatges d&#39;error per a les diferents</span>
<span class="linenos" data-linenos=" 10 "></span><span class="cm">    | regles de validació. Pots ajustar aquests missatges segons les</span>
<span class="linenos" data-linenos=" 11 "></span><span class="cm">    | necessitats de la teva aplicació.</span>
<span class="linenos" data-linenos=" 12 "></span><span class="cm">    |</span>
<span class="linenos" data-linenos=" 13 "></span><span class="cm">    */</span>
<span class="linenos" data-linenos=" 14 "></span>
<span class="linenos" data-linenos=" 15 "></span>    <span class="s1">&#39;accepted&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser acceptat.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 16 "></span>    <span class="s1">&#39;active_url&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute no és una URL vàlida.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 17 "></span>    <span class="s1">&#39;after&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una data posterior a :date.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 18 "></span>    <span class="s1">&#39;after_or_equal&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una data igual o posterior a :date.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 19 "></span>    <span class="s1">&#39;alpha&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute només pot contenir lletres.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 20 "></span>    <span class="s1">&#39;alpha_dash&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute només pot contenir lletres, números, guions i guions baixos.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 21 "></span>    <span class="s1">&#39;alpha_num&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute només pot contenir lletres i números.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 22 "></span>    <span class="s1">&#39;array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser un array.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 23 "></span>    <span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una data anterior a :date.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 24 "></span>    <span class="s1">&#39;before_or_equal&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una data igual o anterior a :date.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 25 "></span>    <span class="s1">&#39;between&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<span class="linenos" data-linenos=" 26 "></span>        <span class="s1">&#39;numeric&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha d\&#39;estar entre :min i :max.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 27 "></span>        <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir entre :min i :max kilobytes.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 28 "></span>        <span class="s1">&#39;string&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir entre :min i :max caràcters.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 29 "></span>        <span class="s1">&#39;array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir entre :min i :max elements.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 30 "></span>    <span class="p">],</span>
<span class="linenos" data-linenos=" 31 "></span>    <span class="s1">&#39;boolean&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser verdader o fals.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 32 "></span>    <span class="s1">&#39;confirmed&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;La confirmació del camp :attribute no coincideix.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 33 "></span>    <span class="s1">&#39;date&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute no és una data vàlida.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 34 "></span>    <span class="s1">&#39;date_format&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute no coincideix amb el format :format.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 35 "></span>    <span class="s1">&#39;different&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Els camps :attribute i :other han de ser diferents.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 36 "></span>    <span class="s1">&#39;digits&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir :digits dígits.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 37 "></span>    <span class="s1">&#39;digits_between&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir entre :min i :max dígits.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 38 "></span>    <span class="s1">&#39;dimensions&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute té dimensions d\&#39;imatge no vàlides.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 39 "></span>    <span class="s1">&#39;distinct&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute té un valor duplicat.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 40 "></span>    <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una adreça de correu electrònic vàlida.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 41 "></span>    <span class="s1">&#39;exists&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute seleccionat no és vàlid.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 42 "></span>    <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser un fitxer.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 43 "></span>    <span class="s1">&#39;filled&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir un valor.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 44 "></span>    <span class="s1">&#39;gt&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<span class="linenos" data-linenos=" 45 "></span>        <span class="s1">&#39;numeric&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser més gran que :value.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 46 "></span>        <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir més de :value kilobytes.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 47 "></span>        <span class="s1">&#39;string&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir més de :value caràcters.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 48 "></span>        <span class="s1">&#39;array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir més de :value elements.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 49 "></span>    <span class="p">],</span>
<span class="linenos" data-linenos=" 50 "></span>    <span class="s1">&#39;gte&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<span class="linenos" data-linenos=" 51 "></span>        <span class="s1">&#39;numeric&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser més gran o igual a :value.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 52 "></span>        <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir com a mínim :value kilobytes.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 53 "></span>        <span class="s1">&#39;string&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir com a mínim :value caràcters.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 54 "></span>        <span class="s1">&#39;array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir com a mínim :value elements.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 55 "></span>    <span class="p">],</span>
<span class="linenos" data-linenos=" 56 "></span>    <span class="s1">&#39;image&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una imatge.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 57 "></span>    <span class="s1">&#39;in&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute seleccionat no és vàlid.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 58 "></span>    <span class="s1">&#39;in_array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute no existeix a :other.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 59 "></span>    <span class="s1">&#39;integer&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser un nombre enter.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 60 "></span>    <span class="s1">&#39;ip&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una adreça IP vàlida.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 61 "></span>    <span class="s1">&#39;ipv4&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una adreça IPv4 vàlida.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 62 "></span>    <span class="s1">&#39;ipv6&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una adreça IPv6 vàlida.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 63 "></span>    <span class="s1">&#39;json&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una cadena JSON vàlida.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 64 "></span>    <span class="s1">&#39;lt&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<span class="linenos" data-linenos=" 65 "></span>        <span class="s1">&#39;numeric&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser més petit que :value.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 66 "></span>        <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir menys de :value kilobytes.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 67 "></span>        <span class="s1">&#39;string&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir menys de :value caràcters.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 68 "></span>        <span class="s1">&#39;array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir menys de :value elements.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 69 "></span>    <span class="p">],</span>
<span class="linenos" data-linenos=" 70 "></span>    <span class="s1">&#39;lte&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<span class="linenos" data-linenos=" 71 "></span>        <span class="s1">&#39;numeric&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser més petit o igual a :value.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 72 "></span>        <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir com a màxim :value kilobytes.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 73 "></span>        <span class="s1">&#39;string&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir com a màxim :value caràcters.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 74 "></span>        <span class="s1">&#39;array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute no ha de tenir més de :value elements.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 75 "></span>    <span class="p">],</span>
<span class="linenos" data-linenos=" 76 "></span>    <span class="s1">&#39;max&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<span class="linenos" data-linenos=" 77 "></span>        <span class="s1">&#39;numeric&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute no pot ser més gran que :max.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 78 "></span>        <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute no pot tenir més de :max kilobytes.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 79 "></span>        <span class="s1">&#39;string&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute no pot tenir més de :max caràcters.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 80 "></span>        <span class="s1">&#39;array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute no pot tenir més de :max elements.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 81 "></span>    <span class="p">],</span>
<span class="linenos" data-linenos=" 82 "></span>    <span class="s1">&#39;mimes&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser un fitxer de tipus: :values.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 83 "></span>    <span class="s1">&#39;mimetypes&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser un fitxer de tipus: :values.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 84 "></span>    <span class="s1">&#39;min&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<span class="linenos" data-linenos=" 85 "></span>        <span class="s1">&#39;numeric&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser com a mínim :min.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 86 "></span>        <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir com a mínim :min kilobytes.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 87 "></span>        <span class="s1">&#39;string&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir com a mínim :min caràcters.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 88 "></span>        <span class="s1">&#39;array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir com a mínim :min elements.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 89 "></span>    <span class="p">],</span>
<span class="linenos" data-linenos=" 90 "></span>    <span class="s1">&#39;not_in&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute seleccionat no és vàlid.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 91 "></span>    <span class="s1">&#39;not_regex&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El format del camp :attribute no és vàlid.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 92 "></span>    <span class="s1">&#39;numeric&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser un nombre.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 93 "></span>    <span class="s1">&#39;present&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser present.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 94 "></span>    <span class="s1">&#39;regex&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El format del camp :attribute no és vàlid.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 95 "></span>    <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute és obligatori.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 96 "></span>    <span class="s1">&#39;required_if&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute és obligatori quan :other és :value.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 97 "></span>    <span class="s1">&#39;required_unless&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute és obligatori excepte si :other és a :values.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 98 "></span>    <span class="s1">&#39;required_with&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute és obligatori quan :values és present.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 99 "></span>    <span class="s1">&#39;required_with_all&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute és obligatori quan :values són presents.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="100 "></span>    <span class="s1">&#39;required_without&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute és obligatori quan :values no és present.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="101 "></span>    <span class="s1">&#39;required_without_all&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute és obligatori quan cap de :values són presents.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="102 "></span>    <span class="s1">&#39;same&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Els camps :attribute i :other han de coincidir.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="103 "></span>    <span class="s1">&#39;size&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<span class="linenos" data-linenos="104 "></span>        <span class="s1">&#39;numeric&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir la mida :size.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="105 "></span>        <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir :size kilobytes.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="106 "></span>        <span class="s1">&#39;string&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de tenir :size caràcters.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="107 "></span>        <span class="s1">&#39;array&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de contenir :size elements.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="108 "></span>    <span class="p">],</span>
<span class="linenos" data-linenos="109 "></span>    <span class="s1">&#39;starts_with&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de començar amb un dels valors següents: :values.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="110 "></span>    <span class="s1">&#39;string&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una cadena de text.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="111 "></span>    <span class="s1">&#39;timezone&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser una zona horària vàlida.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="112 "></span>    <span class="s1">&#39;unique&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ja està en ús.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="113 "></span>    <span class="s1">&#39;uploaded&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha fallat en pujar.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="114 "></span>    <span class="s1">&#39;url&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El format del camp :attribute no és vàlid.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="115 "></span>    <span class="s1">&#39;uuid&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El camp :attribute ha de ser un identificador UUID vàlid.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="116 "></span>
<span class="linenos" data-linenos="117 "></span>    <span class="cm">/*</span>
<span class="linenos" data-linenos="118 "></span><span class="cm">    |--------------------------------------------------------------------------</span>
<span class="linenos" data-linenos="119 "></span><span class="cm">    | Missatges personalitzats per a atributs</span>
<span class="linenos" data-linenos="120 "></span><span class="cm">    |--------------------------------------------------------------------------</span>
<span class="linenos" data-linenos="121 "></span><span class="cm">    |</span>
<span class="linenos" data-linenos="122 "></span><span class="cm">    | Pots utilitzar aquesta secció per personalitzar els noms dels atributs.</span>
<span class="linenos" data-linenos="123 "></span><span class="cm">    |</span>
<span class="linenos" data-linenos="124 "></span><span class="cm">    */</span>
<span class="linenos" data-linenos="125 "></span>
<span class="linenos" data-linenos="126 "></span>    <span class="s1">&#39;attributes&#39;</span> <span class="o">=&gt;</span> <span class="p">[],</span>
<span class="linenos" data-linenos="127 "></span><span class="p">];</span>
</code></pre></div>
<p>Això assegura que els missatges de validació es mostren en l'idioma seleccionat.</p>
<h3 id="pas-9-crear-proves">Pas 9. Crear proves<a class="headerlink" href="#pas-9-crear-proves" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Crea un fitxer de proves per al CRUD d'equips:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:test<span class="w"> </span>EquipCRUDTest
</code></pre></div></p>
</li>
<li>
<p>Modifica el fitxer de proves <code>tests/Feature/EquipCRUDTest.php</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace Tests\Feature;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use App\Models\Estadi;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Illuminate\Foundation\Testing\RefreshDatabase;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">use Tests\TestCase;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">use App\Models\Equip;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">class EquipCrudTest extends TestCase</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">{</span>
<span class="linenos" data-linenos="10 "></span><span class="x">    use RefreshDatabase;</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="x">    /** @test */</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    public function es_pot_crear_un_equip_correctament()</span>
<span class="linenos" data-linenos="14 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="15 "></span><span class="x">        // Actuar: Crear un equip</span>
<span class="linenos" data-linenos="16 "></span><span class="x">        $estadi = Estadi::create([</span>
<span class="linenos" data-linenos="17 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;Camp Nou&#39;,</span>
<span class="linenos" data-linenos="18 "></span><span class="x">            &#39;ciutat&#39; =&gt; &#39;Barcelona&#39;,</span>
<span class="linenos" data-linenos="19 "></span><span class="x">            &#39;capacitat&#39; =&gt; 99354,</span>
<span class="linenos" data-linenos="20 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="21 "></span><span class="x">        $equip = Equip::create([</span>
<span class="linenos" data-linenos="22 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;FC Barcelona&#39;,</span>
<span class="linenos" data-linenos="23 "></span><span class="x">             &#39;titols&#39; =&gt;30,</span>
<span class="linenos" data-linenos="24 "></span><span class="x">             &#39;estadi_id&#39; =&gt; 1,</span>
<span class="linenos" data-linenos="25 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="x">        // Comprovar que l’equip es guarda a la base de dades</span>
<span class="linenos" data-linenos="28 "></span><span class="x">        $this-&gt;assertDatabaseHas(&#39;equips&#39;, [</span>
<span class="linenos" data-linenos="29 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;FC Barcelona&#39;,</span>
<span class="linenos" data-linenos="30 "></span><span class="x">            &#39;titols&#39; =&gt; 30,</span>
<span class="linenos" data-linenos="31 "></span><span class="x">            &#39;estadi_id&#39; =&gt; 1,</span>
<span class="linenos" data-linenos="32 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="33 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="34 "></span>
<span class="linenos" data-linenos="35 "></span><span class="x">    public function es_poden_llistar_els_equips()</span>
<span class="linenos" data-linenos="36 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="37 "></span><span class="x">        // Arrange: Crear equips</span>
<span class="linenos" data-linenos="38 "></span><span class="x">        Equip::factory()-&gt;create([&#39;nom&#39; =&gt; &#39;FC Barcelona&#39;]);</span>
<span class="linenos" data-linenos="39 "></span><span class="x">        Equip::factory()-&gt;create([&#39;nom&#39; =&gt; &#39;Real Madrid&#39;]);</span>
<span class="linenos" data-linenos="40 "></span>
<span class="linenos" data-linenos="41 "></span><span class="x">        // Actuar: Obtenir la llista d’equips</span>
<span class="linenos" data-linenos="42 "></span><span class="x">        $equips = Equip::all();</span>
<span class="linenos" data-linenos="43 "></span>
<span class="linenos" data-linenos="44 "></span><span class="x">        // Comprovar que la llista conté els equips creats</span>
<span class="linenos" data-linenos="45 "></span><span class="x">        $this-&gt;assertCount(2, $equips);</span>
<span class="linenos" data-linenos="46 "></span><span class="x">        $this-&gt;assertEquals(&#39;FC Barcelona&#39;, $equips[0]-&gt;nom);</span>
<span class="linenos" data-linenos="47 "></span><span class="x">        $this-&gt;assertEquals(&#39;Real Madrid&#39;, $equips[1]-&gt;nom);</span>
<span class="linenos" data-linenos="48 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="49 "></span>
<span class="linenos" data-linenos="50 "></span><span class="x">    public function es_pot_actualitzar_un_equip()</span>
<span class="linenos" data-linenos="51 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="52 "></span><span class="x">        // Arrange: Crear un equip</span>
<span class="linenos" data-linenos="53 "></span><span class="x">        $equip = Equip::create([</span>
<span class="linenos" data-linenos="54 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;FC Barcelona&#39;,</span>
<span class="linenos" data-linenos="55 "></span><span class="x">            &#39;ciutat&#39; =&gt; &#39;Barcelona&#39;,</span>
<span class="linenos" data-linenos="56 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="57 "></span>
<span class="linenos" data-linenos="58 "></span><span class="x">        // Actuar: Actualitzar l’equip</span>
<span class="linenos" data-linenos="59 "></span><span class="x">        $equip-&gt;update([</span>
<span class="linenos" data-linenos="60 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;Barça&#39;,</span>
<span class="linenos" data-linenos="61 "></span><span class="x">            &#39;ciutat&#39; =&gt; &#39;Catalunya&#39;,</span>
<span class="linenos" data-linenos="62 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="63 "></span>
<span class="linenos" data-linenos="64 "></span><span class="x">        // Comprovar que els canvis es reflecteixen a la base de dades</span>
<span class="linenos" data-linenos="65 "></span><span class="x">        $this-&gt;assertDatabaseHas(&#39;equips&#39;, [</span>
<span class="linenos" data-linenos="66 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;Barça&#39;,</span>
<span class="linenos" data-linenos="67 "></span><span class="x">            &#39;ciutat&#39; =&gt; &#39;Catalunya&#39;,</span>
<span class="linenos" data-linenos="68 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="69 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="70 "></span>
<span class="linenos" data-linenos="71 "></span><span class="x">    public function es_pot_esborrar_un_equip()</span>
<span class="linenos" data-linenos="72 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="73 "></span><span class="x">        // Arrange: Crear un equip</span>
<span class="linenos" data-linenos="74 "></span><span class="x">        $equip = Equip::create([</span>
<span class="linenos" data-linenos="75 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;FC Barcelona&#39;,</span>
<span class="linenos" data-linenos="76 "></span><span class="x">            &#39;ciutat&#39; =&gt; &#39;Barcelona&#39;,</span>
<span class="linenos" data-linenos="77 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="78 "></span>
<span class="linenos" data-linenos="79 "></span><span class="x">        // Actuar: Esborrar l’equip</span>
<span class="linenos" data-linenos="80 "></span><span class="x">        $equip-&gt;delete();</span>
<span class="linenos" data-linenos="81 "></span>
<span class="linenos" data-linenos="82 "></span><span class="x">        // Comprovar que l’equip ja no existeix a la base de dades</span>
<span class="linenos" data-linenos="83 "></span><span class="x">        $this-&gt;assertDatabaseMissing(&#39;equips&#39;, [</span>
<span class="linenos" data-linenos="84 "></span><span class="x">            &#39;nom&#39; =&gt; &#39;FC Barcelona&#39;,</span>
<span class="linenos" data-linenos="85 "></span><span class="x">            &#39;ciutat&#39; =&gt; &#39;Barcelona&#39;,</span>
<span class="linenos" data-linenos="86 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="87 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="88 "></span>
<span class="linenos" data-linenos="89 "></span><span class="x">    public function no_es_pot_crear_un_equip_sense_nom()</span>
<span class="linenos" data-linenos="90 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="91 "></span><span class="x">        $this-&gt;expectException(\Illuminate\Database\QueryException::class);</span>
<span class="linenos" data-linenos="92 "></span>
<span class="linenos" data-linenos="93 "></span><span class="x">        // Intentar crear un equip sense nom</span>
<span class="linenos" data-linenos="94 "></span><span class="x">        Equip::create([</span>
<span class="linenos" data-linenos="95 "></span><span class="x">            &#39;ciutat&#39; =&gt; &#39;Barcelona&#39;,</span>
<span class="linenos" data-linenos="96 "></span><span class="x">        ]);</span>
<span class="linenos" data-linenos="97 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="98 "></span><span class="x">}</span>
</code></pre></div></p>
</li>
<li>Copia el .env en .env.testing i modifica'l per a executar les proves en una BBDD de testing</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">DB_CONNECTION</span><span class="o">=</span>mysql
<span class="linenos" data-linenos="2 "></span><span class="nv">DB_HOST</span><span class="o">=</span>mysql
<span class="linenos" data-linenos="3 "></span><span class="nv">DB_PORT</span><span class="o">=</span><span class="m">3306</span>
<span class="linenos" data-linenos="4 "></span><span class="nv">DB_DATABASE</span><span class="o">=</span>testing
<span class="linenos" data-linenos="5 "></span><span class="nv">DB_USERNAME</span><span class="o">=</span>sail
<span class="linenos" data-linenos="6 "></span><span class="nv">DB_PASSWORD</span><span class="o">=</span>password
</code></pre></div>
<ol start="4">
<li>Executa les proves:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span><span class="nb">test</span>
</code></pre></div></li>
</ol>
<h3 id="pas-10-generar-un-correu-electronic-amb-la-jornada-actual-partits-programats-i-enviar-lo-als-managers-dels-equips">Pas 10. Generar un correu electrònic amb la jornada actual (partits programats) i enviar-lo als managers dels equips.<a class="headerlink" href="#pas-10-generar-un-correu-electronic-amb-la-jornada-actual-partits-programats-i-enviar-lo-als-managers-dels-equips" title="Permanent link">&para;</a></h3>
<h4 id="1-crear-una-comanda-artisan"><strong>1. Crear una Comanda Artisan</strong><a class="headerlink" href="#1-crear-una-comanda-artisan" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>make:command<span class="w"> </span>EnviarJornadaManagers
</code></pre></div>
<p>Al fitxer <code>app/Console/Commands/EnviarJornadaManagers.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Console\Commands;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use App\Models\User;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Carbon\Carbon;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">use Illuminate\Console\Command;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">use Illuminate\Support\Facades\Mail;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">use App\Models\Partit;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">use App\Mail\JornadaMail;</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="x">class EnviarJornadaManagers extends Command</span>
<span class="linenos" data-linenos="11 "></span><span class="x">{</span>
<span class="linenos" data-linenos="12 "></span><span class="x">    protected $signature = &#39;jornada:enviar&#39;;</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    protected $description = &#39;Envia la jornada actual als managers&#39;;</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">    public function handle()</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="17 "></span><span class="x">        $partit = Partit::whereDate(&#39;data&#39;, &#39;&gt;&#39;, Carbon::now()) // Filtra partits posteriors a avui</span>
<span class="linenos" data-linenos="18 "></span><span class="x">            -&gt;orderBy(&#39;data&#39;, &#39;asc&#39;) // Ordena per la data més propera</span>
<span class="linenos" data-linenos="19 "></span><span class="x">            -&gt;first();</span>
<span class="linenos" data-linenos="20 "></span><span class="x">        $partits = Partit::with([&#39;equipLocal&#39;, &#39;equipVisitant&#39;])-&gt;where(&#39;jornada&#39;,$partit-&gt;jornada)-&gt;get();</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="x">        // Lògica per obtenir els correus dels managers</span>
<span class="linenos" data-linenos="23 "></span><span class="x">        $managers = User::where(&#39;role&#39;,&#39;manager&#39;)-&gt;get();</span>
<span class="linenos" data-linenos="24 "></span>
<span class="linenos" data-linenos="25 "></span>
<span class="linenos" data-linenos="26 "></span><span class="x">        foreach ($managers as $manager) {</span>
<span class="linenos" data-linenos="27 "></span><span class="x">            Mail::to($manager-&gt;email)-&gt;send(new JornadaMail($partits));</span>
<span class="linenos" data-linenos="28 "></span><span class="x">            $this-&gt;info($manager-&gt;name . &#39; ha rebut la jornada.&#39;);</span>
<span class="linenos" data-linenos="29 "></span>
<span class="linenos" data-linenos="30 "></span><span class="x">        }</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="x">        $this-&gt;info(&#39;La jornada s\&#39;ha enviat correctament als managers.&#39;);</span>
<span class="linenos" data-linenos="33 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="34 "></span><span class="x">}</span>
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span><span class="x">#### **2. Crear el Mail**</span>
<span class="linenos" data-linenos="37 "></span><span class="x">```bash</span>
<span class="linenos" data-linenos="38 "></span><span class="x">php artisan make:mail JornadaMail --markdown=emails.jornada</span>
</code></pre></div>
<p>Al fitxer <code>app/Mail/JornadaMail.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Mail;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Illuminate\Bus\Queueable;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Illuminate\Contracts\Queue\ShouldQueue;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">use Illuminate\Mail\Mailable;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">use Illuminate\Mail\Mailables\Content;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">use Illuminate\Queue\SerializesModels;</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">class JornadaMail extends Mailable</span>
<span class="linenos" data-linenos="10 "></span><span class="x">{</span>
<span class="linenos" data-linenos="11 "></span><span class="x">    use Queueable, SerializesModels;</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="x">    public $partits;</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">    public function __construct($partits)</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="17 "></span><span class="x">        $this-&gt;partits = $partits;</span>
<span class="linenos" data-linenos="18 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="x">    public function content(): Content</span>
<span class="linenos" data-linenos="23 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="24 "></span><span class="x">        return new Content(</span>
<span class="linenos" data-linenos="25 "></span><span class="x">            markdown: &#39;emails.jornada&#39;,</span>
<span class="linenos" data-linenos="26 "></span><span class="x">            with: [</span>
<span class="linenos" data-linenos="27 "></span><span class="x">                &#39;partits&#39; =&gt; $this-&gt;partits,</span>
<span class="linenos" data-linenos="28 "></span><span class="x">            ],</span>
<span class="linenos" data-linenos="29 "></span><span class="x">        );</span>
<span class="linenos" data-linenos="30 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="31 "></span><span class="x">}</span>
</code></pre></div>
<h4 id="3-crear-la-vista-del-correu"><strong>3. Crear la Vista del Correu</strong><a class="headerlink" href="#3-crear-la-vista-del-correu" title="Permanent link">&para;</a></h4>
<p>Al fitxer <code>resources/views/emails/jornada.blade.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>&lt;x-mail::message&gt;
<span class="linenos" data-linenos=" 2 "></span>    # Jornada {{ $partits-&gt;first()-&gt;jornada }}
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span>    ## Partits Programats:
<span class="linenos" data-linenos=" 5 "></span>    <span class="ni">@foreach</span>($partits as $partit)
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">-</span><span class="w"> </span><span class="gs">**{{ $partit-&gt;equipLocal-&gt;nom }}**</span> vs <span class="gs">**{{ $partit-&gt;equipVisitant-&gt;nom }}**</span> ({{ $partit-&gt;data }})
<span class="linenos" data-linenos=" 7 "></span>    <span class="ni">@endforeach</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    Gràcies,
<span class="linenos" data-linenos="10 "></span>    <span class="gs">**{{ config(&#39;app.name&#39;) }}**</span>
<span class="linenos" data-linenos="11 "></span>&lt;/x-mail::message&gt;
</code></pre></div>
<h4 id="4-efectuar-lenviament"><strong>4. Efectuar l'Enviament</strong><a class="headerlink" href="#4-efectuar-lenviament" title="Permanent link">&para;</a></h4>
<p>Pots enviar els correus manualment executant la comanda:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php<span class="w"> </span>artisan<span class="w"> </span>jornada:enviar
</code></pre></div>
<p>Pots programar la comanda al <code>Kernel.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">protected function schedule(Schedule $schedule)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $schedule-&gt;command(&#39;jornada:enviar&#39;)-&gt;weeklyOn(1, &#39;8:00&#39;);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">}</span>
</code></pre></div>
<h3 id="pas-11-crear-un-component-livewire-per-a-mostrar-un-historic-de-partits">Pas 11. Crear un component livewire per a mostrar un històric de partits<a class="headerlink" href="#pas-11-crear-un-component-livewire-per-a-mostrar-un-historic-de-partits" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Instal·la Livewire:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer<span class="w"> </span>require<span class="w"> </span>livewire/livewire
<span class="linenos" data-linenos="2 "></span>php<span class="w"> </span>artisan<span class="w"> </span>livewire:publish
</code></pre></div></p>
</li>
<li>
<p>Afegeix els scripts de Livewire a la plantilla Blade:</p>
</li>
</ol>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;{{ str_replace(&#39;_&#39;, &#39;-&#39;, app()-&gt;getLocale()) }}&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;csrf-token&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;{{ csrf_token() }}&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{{ config(&#39;app.name&#39;, &#39;Laravel&#39;) }}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="cm">&lt;!-- Fonts --&gt;</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;preconnect&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://fonts.bunny.net&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://fonts.bunny.net/css?family=figtree:400,500,600&amp;display=swap&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="cm">&lt;!-- Scripts --&gt;</span>
<span class="linenos" data-linenos="15 "></span>    @vite([&#39;resources/css/app.css&#39;, &#39;resources/js/app.js&#39;])
<span class="linenos" data-linenos="16 "></span>    @livewireStyles
<span class="linenos" data-linenos="17 "></span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="18 "></span><span class="p">&lt;</span><span class="nt">body</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;font-sans antialiased&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="19 "></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;min-h-screen bg-gray-100 dark:bg-gray-900&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="20 "></span>    @include(&#39;layouts.navigation&#39;)
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    <span class="cm">&lt;!-- Page Heading --&gt;</span>
<span class="linenos" data-linenos="23 "></span>    @isset($header)
<span class="linenos" data-linenos="24 "></span>    <span class="p">&lt;</span><span class="nt">header</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;bg-white dark:bg-gray-800 shadow&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="25 "></span>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="26 "></span>            {{ $header }}
<span class="linenos" data-linenos="27 "></span>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="28 "></span>    <span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="29 "></span>    @endisset
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span>    <span class="cm">&lt;!-- Page Content --&gt;</span>
<span class="linenos" data-linenos="32 "></span>    <span class="p">&lt;</span><span class="nt">main</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="33 "></span>        {{ $slot }}
<span class="linenos" data-linenos="34 "></span>    <span class="p">&lt;/</span><span class="nt">main</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="35 "></span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="36 "></span>@livewireScripts
<span class="linenos" data-linenos="37 "></span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="38 "></span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
3. Genera el component Livewire:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="w"> </span>php<span class="w"> </span>artisan<span class="w"> </span>make:livewire<span class="w"> </span>HistorialPartits
</code></pre></div></p>
<ol start="4">
<li>Modifica el component Livewire <code>app/Livewire/HistorialPartits.php</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Livewire;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use App\Models\Partit;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">use Livewire\Component;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">class HistorialPartits extends Component</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    public $partits;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    public $equip = &#39;&#39;;</span>
<span class="linenos" data-linenos="10 "></span><span class="x">    public $data = &#39;&#39;;</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="x">    public function mount()</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="14 "></span><span class="x">        $this-&gt;partits = Partit::with([&#39;equipLocal&#39;, &#39;equipVisitant&#39;, &#39;estadi&#39;, &#39;arbitre&#39;])-&gt;get();</span>
<span class="linenos" data-linenos="15 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="x">    public function filtrar()</span>
<span class="linenos" data-linenos="19 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="20 "></span><span class="x">        $this-&gt;partits = Partit::with([&#39;equipLocal&#39;, &#39;equipVisitant&#39;, &#39;estadi&#39;, &#39;arbitre&#39;])</span>
<span class="linenos" data-linenos="21 "></span><span class="x">            -&gt;when($this-&gt;equip, function ($query) {</span>
<span class="linenos" data-linenos="22 "></span><span class="x">                $query-&gt;whereHas(&#39;equipLocal&#39;, fn($q) =&gt; $q-&gt;where(&#39;nom&#39;, &#39;like&#39;, &quot;%{$this-&gt;equip}%&quot;))</span>
<span class="linenos" data-linenos="23 "></span><span class="x">                    -&gt;orWhereHas(&#39;equipVisitant&#39;, fn($q) =&gt; $q-&gt;where(&#39;nom&#39;, &#39;like&#39;, &quot;%{$this-&gt;equip}%&quot;));</span>
<span class="linenos" data-linenos="24 "></span><span class="x">            })</span>
<span class="linenos" data-linenos="25 "></span><span class="x">            -&gt;when($this-&gt;data, function ($query) {</span>
<span class="linenos" data-linenos="26 "></span><span class="x">                $query-&gt;whereDate(&#39;data&#39;, $this-&gt;data);</span>
<span class="linenos" data-linenos="27 "></span><span class="x">            })</span>
<span class="linenos" data-linenos="28 "></span><span class="x">            -&gt;get();</span>
<span class="linenos" data-linenos="29 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span><span class="x">    public function render()</span>
<span class="linenos" data-linenos="32 "></span><span class="x">    {</span>
<span class="linenos" data-linenos="33 "></span><span class="x">        return view(&#39;livewire.historial-partits&#39;, [&#39;partits&#39; =&gt; $this-&gt;partits]);</span>
<span class="linenos" data-linenos="34 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="35 "></span><span class="x">}</span>
</code></pre></div></li>
<li>Modifica la vista del component Livewire <code>resources/views/livewire/historial-partits.blade.php</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">&lt;div&gt;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">    &lt;div class=&quot;flex space-x-4&quot;&gt;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">        &lt;input wire:model=&quot;equip&quot; type=&quot;text&quot; placeholder=&quot;Cerca equip&quot; class=&quot;border px-4 py-2&quot;&gt;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">        &lt;input wire:model=&quot;data&quot; type=&quot;date&quot; class=&quot;border px-4 py-2&quot;&gt;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">        &lt;button wire:click=&quot;filtrar&quot; class=&quot;bg-blue-500 text-white px-4 py-2&quot;&gt;Filtrar&lt;/button&gt;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    &lt;/div&gt;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    &lt;table class=&quot;table-auto w-full mt-4&quot;&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        &lt;thead&gt;</span>
<span class="linenos" data-linenos="10 "></span><span class="x">        &lt;tr&gt;</span>
<span class="linenos" data-linenos="11 "></span><span class="x">            &lt;th&gt;Data&lt;/th&gt;</span>
<span class="linenos" data-linenos="12 "></span><span class="x">            &lt;th&gt;Equip Local&lt;/th&gt;</span>
<span class="linenos" data-linenos="13 "></span><span class="x">            &lt;th&gt;Equip Visitant&lt;/th&gt;</span>
<span class="linenos" data-linenos="14 "></span><span class="x">            &lt;th&gt;Resultat&lt;/th&gt;</span>
<span class="linenos" data-linenos="15 "></span><span class="x">            &lt;th&gt;Estadi&lt;/th&gt;</span>
<span class="linenos" data-linenos="16 "></span><span class="x">            &lt;th&gt;Àrbitre&lt;/th&gt;</span>
<span class="linenos" data-linenos="17 "></span><span class="x">        &lt;/tr&gt;</span>
<span class="linenos" data-linenos="18 "></span><span class="x">        &lt;/thead&gt;</span>
<span class="linenos" data-linenos="19 "></span><span class="x">        &lt;tbody&gt;</span>
<span class="linenos" data-linenos="20 "></span><span class="x">        @foreach($partits as $partit)</span>
<span class="linenos" data-linenos="21 "></span><span class="x">            &lt;tr&gt;</span>
<span class="linenos" data-linenos="22 "></span><span class="x">                &lt;td&gt;{{ $partit-&gt;data }}&lt;/td&gt;</span>
<span class="linenos" data-linenos="23 "></span><span class="x">                &lt;td&gt;{{ $partit-&gt;equipLocal-&gt;nom }}&lt;/td&gt;</span>
<span class="linenos" data-linenos="24 "></span><span class="x">                &lt;td&gt;{{ $partit-&gt;equipVisitant-&gt;nom }}&lt;/td&gt;</span>
<span class="linenos" data-linenos="25 "></span><span class="x">                &lt;td&gt;{{ $partit-&gt;resultat }}&lt;/td&gt;</span>
<span class="linenos" data-linenos="26 "></span><span class="x">                &lt;td&gt;{{ $partit-&gt;estadi-&gt;nom }}&lt;/td&gt;</span>
<span class="linenos" data-linenos="27 "></span><span class="x">                &lt;td&gt;{{ $partit-&gt;arbitre-&gt;name }}&lt;/td&gt;</span>
<span class="linenos" data-linenos="28 "></span><span class="x">            &lt;/tr&gt;</span>
<span class="linenos" data-linenos="29 "></span><span class="x">        @endforeach</span>
<span class="linenos" data-linenos="30 "></span><span class="x">        &lt;/tbody&gt;</span>
<span class="linenos" data-linenos="31 "></span><span class="x">    &lt;/table&gt;</span>
<span class="linenos" data-linenos="32 "></span><span class="x">&lt;/div&gt;</span>
</code></pre></div></li>
<li>Crea la vista <code>resources/views/partits/historic.blade.php</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">@extends(&#39;layouts.futbolFemeni&#39;)</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">@section(&#39;title&#39;, __(&#39;Històric de partits&#39; ))</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">@section(&#39;content&#39;)</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    &lt;!-- Afegim el component Livewire aquí --&gt;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    &lt;div class=&quot;mt-8&quot;&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        @livewire(&#39;historial-partits&#39;)</span>
<span class="linenos" data-linenos="10 "></span><span class="x">    &lt;/div&gt;</span>
<span class="linenos" data-linenos="11 "></span><span class="x">@endsection</span>
</code></pre></div></li>
<li>Modifica la ruta <code>routes/web.php</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">Route::get(&#39;/historic&#39;, [PartitController::class, &#39;historic&#39;])-&gt;name(&#39;partits.historic&#39;);</span>
</code></pre></div></li>
<li>Modifica el controlador <code>app/Http/Controllers/PartitController.php</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function historic()</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    return view(&#39;partits.historic&#39;);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">}</span>
</code></pre></div></li>
<li>Afegix entrada en el menú <code>resources/views/layouts/navigation.blade.php</code>:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&lt;div class=&quot;hidden space-x-8 sm:-my-px sm:ms-10 sm:flex&quot;&gt;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    &lt;x-nav-link :href=&quot;route(&#39;partits.historic&#39;)&quot; :active=&quot;request()-&gt;routeIs(&#39;partits.historic&#39;)&quot;&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="x">        {{ __(&#39;Històric Partits&#39;) }}</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    &lt;/x-nav-link&gt;</span>
<span class="linenos" data-linenos="5 "></span><span class="x">&lt;/div&gt;</span>
</code></pre></div></li>
</ol>
<h2 id="exercicis">Exercicis<a class="headerlink" href="#exercicis" title="Permanent link">&para;</a></h2>
<h3 id="1-ordenacio-de-la-bbdd-seeders-i-factories">1. Ordenació de la BBDD, seeders i factories<a class="headerlink" href="#1-ordenacio-de-la-bbdd-seeders-i-factories" title="Permanent link">&para;</a></h3>
<ul>
<li>Anem a afegir els següents camps a la BBDD</li>
<li>Afegir el camp <code>data_naixement</code> a la taula <code>jugadores</code> de tipus <code>date</code>.</li>
<li>Afegir el camp <code>estadi_id</code> a la taula <code>partits</code> clau forània</li>
<li>Afegir el camp <code>arbitre_id</code> a la taula <code>partits</code> clau forània.</li>
<li>Afegir el camp <code>data</code> a la taula partits de tipus date.</li>
<li>Afegir el camp <code>dorsal</code> a la taula jugadores de tipus integer.</li>
<li>Afegir el camp <code>jornada</code> a la taula partits de tipus integer.</li>
<li>Fes que el seeder de usuaris cree 30 amb el rol <code>arbitre</code>.</li>
<li>Fes que el seeder de equips només en cree 18.</li>
<li>Anem a crear el calendari utilitzant el chatgpt.  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">namespace</span> <span class="nx">Database\Seeders</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Seeder</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">use</span> <span class="nx">App\Models\Equip</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">use</span> <span class="nx">App\Models\Partit</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">use</span> <span class="nx">App\Models\User</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">use</span> <span class="nx">Carbon\Carbon</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="k">use</span> <span class="nx">Exception</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="k">class</span> <span class="nc">PartitsSeeder</span> <span class="k">extends</span> <span class="nx">Seeder</span>
<span class="linenos" data-linenos="13 "></span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span>    <span class="sd">/**</span>
<span class="linenos" data-linenos="15 "></span><span class="sd">     * Run the database seeds.</span>
<span class="linenos" data-linenos="16 "></span><span class="sd">     */</span>
<span class="linenos" data-linenos="17 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
<span class="linenos" data-linenos="18 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="19 "></span>        <span class="nv">$arbitres</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">,</span> <span class="s1">&#39;arbitre&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$arbitres</span><span class="o">-&gt;</span><span class="na">isEmpty</span><span class="p">())</span> <span class="p">{</span>
<span class="linenos" data-linenos="22 "></span>            <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s1">&#39;No hi ha cap àrbitre disponible.&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="23 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="24 "></span>
<span class="linenos" data-linenos="25 "></span>        <span class="nv">$equips</span> <span class="o">=</span> <span class="nx">Equip</span><span class="o">::</span><span class="na">all</span><span class="p">();</span>
<span class="linenos" data-linenos="26 "></span>        <span class="nv">$numEquips</span> <span class="o">=</span> <span class="nv">$equips</span><span class="o">-&gt;</span><span class="na">count</span><span class="p">();</span>
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$numEquips</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nv">$numEquips</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="29 "></span>            <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s1">&#39;El nombre d\&#39;equips ha de ser parell i almenys 2.&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="30 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span>        <span class="nv">$numJornades</span> <span class="o">=</span> <span class="nv">$numEquips</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// Nombre de jornades per anada</span>
<span class="linenos" data-linenos="33 "></span>        <span class="nv">$partitsPerJornada</span> <span class="o">=</span> <span class="nv">$numEquips</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="linenos" data-linenos="34 "></span>        <span class="nv">$dataInicial</span> <span class="o">=</span> <span class="nx">Carbon</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span> <span class="c1">// Comença el 7 de setembre</span>
<span class="linenos" data-linenos="35 "></span>        <span class="nv">$dataLimitResultats</span> <span class="o">=</span> <span class="nx">Carbon</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span> <span class="c1">// Fins al 15 de desembre</span>
<span class="linenos" data-linenos="36 "></span>        <span class="nv">$arbitres</span> <span class="o">=</span> <span class="nv">$arbitres</span><span class="o">-&gt;</span><span class="na">shuffle</span><span class="p">();</span>
<span class="linenos" data-linenos="37 "></span>
<span class="linenos" data-linenos="38 "></span>        <span class="c1">// Generem el calendari d&#39;anada</span>
<span class="linenos" data-linenos="39 "></span>        <span class="nv">$jornades</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos" data-linenos="40 "></span>        <span class="k">for</span> <span class="p">(</span><span class="nv">$jornada</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nv">$jornada</span> <span class="o">&lt;=</span> <span class="nv">$numJornades</span><span class="p">;</span> <span class="nv">$jornada</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="41 "></span>            <span class="nv">$dataJornada</span> <span class="o">=</span> <span class="nv">$dataInicial</span><span class="o">-&gt;</span><span class="na">copy</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addWeeks</span><span class="p">(</span><span class="nv">$jornada</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Una jornada per setmana</span>
<span class="linenos" data-linenos="42 "></span>            <span class="nv">$jornades</span><span class="p">[</span><span class="nv">$jornada</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span> <span class="c1">// Guardem els partits d&#39;aquesta jornada</span>
<span class="linenos" data-linenos="43 "></span>
<span class="linenos" data-linenos="44 "></span>            <span class="c1">// Distribuïm els equips</span>
<span class="linenos" data-linenos="45 "></span>            <span class="nv">$equipsActuals</span> <span class="o">=</span> <span class="nv">$equips</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
<span class="linenos" data-linenos="46 "></span>            <span class="nv">$localEquips</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$equipsActuals</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$partitsPerJornada</span><span class="p">);</span>
<span class="linenos" data-linenos="47 "></span>            <span class="nv">$visitantEquips</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nb">array_slice</span><span class="p">(</span><span class="nv">$equipsActuals</span><span class="p">,</span> <span class="nv">$partitsPerJornada</span><span class="p">));</span>
<span class="linenos" data-linenos="48 "></span>
<span class="linenos" data-linenos="49 "></span>            <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$partitsPerJornada</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="50 "></span>                <span class="nv">$local</span> <span class="o">=</span> <span class="nv">$localEquips</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
<span class="linenos" data-linenos="51 "></span>                <span class="nv">$visitant</span> <span class="o">=</span> <span class="nv">$visitantEquips</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
<span class="linenos" data-linenos="52 "></span>
<span class="linenos" data-linenos="53 "></span>                <span class="c1">// Alternança casa i fora</span>
<span class="linenos" data-linenos="54 "></span>                <span class="k">if</span> <span class="p">(</span><span class="nv">$jornada</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Invertim en jornades parells</span>
<span class="linenos" data-linenos="55 "></span>                    <span class="nv">$temp</span> <span class="o">=</span> <span class="nv">$local</span><span class="p">;</span>
<span class="linenos" data-linenos="56 "></span>                    <span class="nv">$local</span> <span class="o">=</span> <span class="nv">$visitant</span><span class="p">;</span>
<span class="linenos" data-linenos="57 "></span>                    <span class="nv">$visitant</span> <span class="o">=</span> <span class="nv">$temp</span><span class="p">;</span>
<span class="linenos" data-linenos="58 "></span>                <span class="p">}</span>
<span class="linenos" data-linenos="59 "></span>
<span class="linenos" data-linenos="60 "></span>                <span class="nv">$dataAleatoria</span> <span class="o">=</span> <span class="nv">$dataJornada</span><span class="o">-&gt;</span><span class="na">copy</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addDays</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="c1">// Data aleatòria dins del rang [-2, 2]</span>
<span class="linenos" data-linenos="61 "></span>                <span class="nv">$partit</span> <span class="o">=</span> <span class="nx">Partit</span><span class="o">::</span><span class="na">create</span><span class="p">([</span>
<span class="linenos" data-linenos="62 "></span>                    <span class="s1">&#39;local_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$local</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
<span class="linenos" data-linenos="63 "></span>                    <span class="s1">&#39;visitant_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$visitant</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
<span class="linenos" data-linenos="64 "></span>                    <span class="s1">&#39;estadi_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$local</span><span class="p">[</span><span class="s1">&#39;estadi_id&#39;</span><span class="p">],</span>
<span class="linenos" data-linenos="65 "></span>                    <span class="s1">&#39;arbitre_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$arbitres</span><span class="o">-&gt;</span><span class="na">random</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">,</span>
<span class="linenos" data-linenos="66 "></span>                    <span class="s1">&#39;jornada&#39;</span> <span class="o">=&gt;</span> <span class="nv">$jornada</span><span class="p">,</span>
<span class="linenos" data-linenos="67 "></span>                    <span class="s1">&#39;data&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dataAleatoria</span><span class="p">,</span>
<span class="linenos" data-linenos="68 "></span>                    <span class="s1">&#39;gol_local&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dataAleatoria</span> <span class="o">&lt;</span> <span class="nv">$dataLimitResultats</span> <span class="o">?</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">:</span><span class="k">null</span><span class="p">,</span>
<span class="linenos" data-linenos="69 "></span>                    <span class="s1">&#39;gol_visitant&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dataAleatoria</span> <span class="o">&lt;</span> <span class="nv">$dataLimitResultats</span> <span class="o">?</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">:</span><span class="k">null</span><span class="p">,</span>
<span class="linenos" data-linenos="70 "></span>                <span class="p">]);</span>
<span class="linenos" data-linenos="71 "></span>                <span class="nv">$jornades</span><span class="p">[</span><span class="nv">$jornada</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$partit</span><span class="p">;</span>
<span class="linenos" data-linenos="72 "></span>            <span class="p">}</span>
<span class="linenos" data-linenos="73 "></span>
<span class="linenos" data-linenos="74 "></span>            <span class="c1">// Rotació dels equips (round-robin)</span>
<span class="linenos" data-linenos="75 "></span>            <span class="nv">$equips</span><span class="o">-&gt;</span><span class="na">push</span><span class="p">(</span><span class="nv">$equips</span><span class="o">-&gt;</span><span class="na">splice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span>
<span class="linenos" data-linenos="76 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="77 "></span>
<span class="linenos" data-linenos="78 "></span>        <span class="c1">// Generem el calendari de tornada</span>
<span class="linenos" data-linenos="79 "></span>        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$jornades</span> <span class="k">as</span> <span class="nv">$jornada</span> <span class="o">=&gt;</span> <span class="nv">$partits</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="80 "></span>            <span class="nv">$dataJornadaTornada</span> <span class="o">=</span> <span class="nv">$dataInicial</span><span class="o">-&gt;</span><span class="na">copy</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addWeeks</span><span class="p">(</span><span class="nv">$numJornades</span> <span class="o">+</span> <span class="nv">$jornada</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Jornades de tornada després de les d&#39;anada</span>
<span class="linenos" data-linenos="81 "></span>
<span class="linenos" data-linenos="82 "></span>            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$partits</span> <span class="k">as</span> <span class="nv">$partit</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="83 "></span>                <span class="nv">$dataAleatoria</span> <span class="o">=</span> <span class="nv">$dataJornadaTornada</span><span class="o">-&gt;</span><span class="na">copy</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addDays</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="c1">// Data aleatòria dins del rang [-2, 2]</span>
<span class="linenos" data-linenos="84 "></span>                <span class="nx">Partit</span><span class="o">::</span><span class="na">create</span><span class="p">([</span>
<span class="linenos" data-linenos="85 "></span>                    <span class="s1">&#39;local_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$partit</span><span class="o">-&gt;</span><span class="na">visitant_id</span><span class="p">,</span> <span class="c1">// Invertim local i visitant</span>
<span class="linenos" data-linenos="86 "></span>                    <span class="s1">&#39;visitant_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$partit</span><span class="o">-&gt;</span><span class="na">local_id</span><span class="p">,</span>
<span class="linenos" data-linenos="87 "></span>                    <span class="s1">&#39;estadi_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$partit</span><span class="o">-&gt;</span><span class="na">visitant_id</span> <span class="o">?</span> <span class="nx">Equip</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="nv">$partit</span><span class="o">-&gt;</span><span class="na">visitant_id</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">estadi_id</span> <span class="o">:</span> <span class="k">null</span><span class="p">,</span>
<span class="linenos" data-linenos="88 "></span>                    <span class="s1">&#39;arbitre_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$arbitres</span><span class="o">-&gt;</span><span class="na">random</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">,</span>
<span class="linenos" data-linenos="89 "></span>                    <span class="s1">&#39;jornada&#39;</span> <span class="o">=&gt;</span> <span class="nv">$jornada</span> <span class="o">+</span> <span class="nv">$numJornades</span><span class="p">,</span> <span class="c1">// Jornada de tornada</span>
<span class="linenos" data-linenos="90 "></span>                    <span class="s1">&#39;data&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dataAleatoria</span><span class="p">,</span>
<span class="linenos" data-linenos="91 "></span>                    <span class="s1">&#39;gol_local&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dataAleatoria</span> <span class="o">&lt;</span> <span class="nv">$dataLimitResultats</span> <span class="o">?</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">:</span> <span class="k">null</span><span class="p">,</span>
<span class="linenos" data-linenos="92 "></span>                    <span class="s1">&#39;gol_visitant&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dataAleatoria</span> <span class="o">&lt;</span> <span class="nv">$dataLimitResultats</span> <span class="o">?</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">:</span> <span class="k">null</span><span class="p">,</span>
<span class="linenos" data-linenos="93 "></span>                <span class="p">]);</span>
<span class="linenos" data-linenos="94 "></span>            <span class="p">}</span>
<span class="linenos" data-linenos="95 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="96 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="97 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="2-creacio-dels-form-requests">2. Creació dels Form Requests<a class="headerlink" href="#2-creacio-dels-form-requests" title="Permanent link">&para;</a></h3>
<ul>
<li>Genera els Form Requests per als models <code>Estadi</code>, <code>Jugadora</code> i <code>Partit</code> utilitzant Artisan.</li>
<li>
<p>Implementa les regles de validació següents:</p>
<ul>
<li><strong>Estadis</strong>:<ul>
<li><code>nom</code>: Obligatori, text amb un màxim de 255 caràcters.</li>
<li><code>capacitat</code>: Obligatori, número enter positiu.</li>
<li><code>ciutat</code>: Obligatori, text amb un màxim de 255 caràcters.</li>
</ul>
</li>
<li><strong>Jugadores</strong>  :<ul>
<li><code>nom</code>: Obligatori, text amb un màxim de 255 caràcters.</li>
<li><code>posició</code>: Obligatori, una de les opcions <code>defensa</code>, <code>migcampista</code>, <code>davantera</code> o <code>porter</code>.</li>
<li><code>equip_id</code>: Obligatori, identificador existent a la taula <code>equips</code>.</li>
<li><code>data_naixement</code>: Obligatori, data vàlida anterior a la data actual i de minim 16 anys.</li>
<li><code>foto</code>: Opcional, pero si està ha de ser una foto .png i amb un tamany màxim.</li>
</ul>
</li>
<li><strong>Partits</strong>  :<ul>
<li><code>goles_local</code>: Obligatori, igual o major que 0.</li>
<li><code>goles_visitant</code>: Obligatori, igual o major que 0.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Substitueix la validació manual al controlador pels Form Requests creats.</p>
</li>
<li>Personalitza els missatges d'error perquè siguen més clars per als usuaris.</li>
<li>Si algun camp no està dona'l d'alta a les migracions, seeders i factories.</li>
</ul>
<h3 id="3-restriccio-de-les-operaciones-per-als-usuaris-no-autenticants">3. Restricció de les operaciones per als usuaris no autenticants<a class="headerlink" href="#3-restriccio-de-les-operaciones-per-als-usuaris-no-autenticants" title="Permanent link">&para;</a></h3>
<ul>
<li>Sabent que @auth @endauth son les directives per a autenticació, modifica les vistes per a que els usuaris no autenticats no vegen les operacions, ni en la columna en la taula.</li>
</ul>
<h3 id="4-restriccio-de-permisos-per-als-partits">4. Restricció de permisos per als partits<a class="headerlink" href="#4-restriccio-de-permisos-per-als-partits" title="Permanent link">&para;</a></h3>
<p>Assegurar que només els usuaris amb rol d'<code>àrbitre</code> puguin modificar partits. Ningú pot crear-ne.</p>
<ul>
<li>Modifica el Form Request de <code>Partit</code> per incloure una validació que només permeta accedir als usuaris amb rol d'<code>àrbitre</code>.</li>
<li>Utilitza el mètode <code>authorize()</code> del Form Request per implementar aquesta restricció.</li>
<li>Verifica que el middleware de rol ja implementat també assegure que només els àrbitres poden accedir a les rutes de  <strong>modificació</strong> de partits.</li>
<li>Inhabilita les rutes de creació i esborrat de partits. </li>
</ul>
<h3 id="5-jugadores">5. Jugadores<a class="headerlink" href="#5-jugadores" title="Permanent link">&para;</a></h3>
<ul>
<li>Assegurat que soles els manager puguen crear, modificar o esborrar a les seues jugadores.</li>
<li>Així mateix quan un manager crea una jugadora aquesta ha de ser assignada al seu equip.</li>
<li>Modifica el component de jugadora per poder vore-la en els equips de forma semblant. </li>
</ul>
<figure style="align: center;">
    <img src="imagenes/09/equips.png" width="700">
    <figcaption>Exemple d'equip</figcaption>
</figure>

<h3 id="6-calendari">6. Calendari<a class="headerlink" href="#6-calendari" title="Permanent link">&para;</a></h3>
<ul>
<li>Crea una vista per a vore les jornades i el resultats dels partits.  </li>
<li>Si l'usuari és un arbitre aleshores soles vora els seus partits i podrà modificar-los.</li>
</ul>
<figure style="align: center;">
    <img src="imagenes/09/jornada.png" width="700">
    <figcaption>Exemple de jornada</figcaption>
</figure>

<h3 id="7-equips">7. Equips<a class="headerlink" href="#7-equips" title="Permanent link">&para;</a></h3>
<ul>
<li>Crea un camp calculat per a vore l'edat mitjana de les jugadores de l'equip. </li>
<li>Fes que baix de les jugadores isquen els ultims 5 resultats jugats per l'equip.</li>
</ul>
<h3 id="8-classificacio">8. Classificació<a class="headerlink" href="#8-classificacio" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Crea un component livewire per mostrar la classificació en temps real.</p>
</li>
<li>
<p>Genera una taula que mostre, per a cada equip:</p>
</li>
<li>Nom de l’equip.</li>
<li>Total de punts.</li>
<li>Partits jugats.</li>
<li>Partits guanyats, empatats i perduts.</li>
<li>Gols a favor i en contra.</li>
<li>
<p>Diferència de gols.</p>
</li>
<li>
<p>Ordena automàticament els equips per punts (i per diferència de gols en cas d’empat).</p>
</li>
</ul>
<h4 id="condicionants">Condicionants<a class="headerlink" href="#condicionants" title="Permanent link">&para;</a></h4>
<ol>
<li>Implementar la funcionalitat com a <strong>component Livewire</strong>.</li>
<li>Fer servir una combinació de <strong>Eloquent</strong> i càlculs personalitzats per generar la classificació.</li>
<li>Presentar el resultat en temps real.</li>
<li>Sense filtres ni opcions addicionals, simplement la taula de classificació actualitzada.</li>
</ol>
<h3 id="9-proves">9. Proves<a class="headerlink" href="#9-proves" title="Permanent link">&para;</a></h3>
<ol>
<li>Crea proves per jugadoresController, EstadiController i PartitController.</li>
</ol>
<h3 id="10-correu">10. Correu<a class="headerlink" href="#10-correu" title="Permanent link">&para;</a></h3>
<ol>
<li>Crea un correu per a enviar a tots els arbitres el seu calendari anual de partits.</li>
</ol>









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2021-2026 Aitor Medrano, Luis Alemañ, Ignasi Gomis - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/aitormedrano" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.2 4.2 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.52 8.52 0 0 1-5.33 1.84q-.51 0-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<a.medrano@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 12.13c-.15.01-.29.06-.39.17l-1 1 2.05 2 1-1c.22-.21.22-.56 0-.77l-1.24-1.23a.56.56 0 0 0-.38-.17m-2 1.75L13 19.94V22h2.06l6.06-6.07M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h7v-.89l8.24-8.22c.47-.49 1.12-.76 1.8-.76.34 0 .68.06 1 .19V6c0-1.12-.92-2-2.04-2m0 4-8 5-8-5V6l8 5 8-5"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["header.autohide", "toc.integrate", "content.tabs.link"], "search": "assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiat al porta-retalls", "clipboard.copy": "C\u00f2pia al porta-retalls", "search.result.more.one": "1 m\u00e9s en aquesta p\u00e0gina", "search.result.more.other": "# m\u00e9s en aquesta p\u00e0gina", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.term.missing": "Desaparegut", "select.version": "Selecciona la versi\u00f3"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>